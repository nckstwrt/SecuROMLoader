#pragma once
#include <windows.h>
#include <winioctl.h>
#include <map>
#include <string>
#include <ntddcdrm.h>
#include <ntddcdvd.h>
#include <ntdddisk.h>

static const std::map<DWORD, std::string> DeviceIoControlMap = {
    // --- CDROM IOCTLs ---
    { IOCTL_CDROM_CHECK_VERIFY,                 "IOCTL_CDROM_CHECK_VERIFY" },
    { IOCTL_CDROM_FIND_NEW_DEVICES,             "IOCTL_CDROM_FIND_NEW_DEVICES" },
    { IOCTL_CDROM_GET_CONFIGURATION,            "IOCTL_CDROM_GET_CONFIGURATION" },
    { OBSOLETE_IOCTL_CDROM_GET_CONTROL,                  "IOCTL_CDROM_GET_CONTROL" },
    { IOCTL_CDROM_GET_DRIVE_GEOMETRY,           "IOCTL_CDROM_GET_DRIVE_GEOMETRY" },
    { IOCTL_CDROM_GET_DRIVE_GEOMETRY_EX,        "IOCTL_CDROM_GET_DRIVE_GEOMETRY_EX" },
    { IOCTL_CDROM_GET_LAST_SESSION,             "IOCTL_CDROM_GET_LAST_SESSION" },
//    { IOCTL_CDROM_GET_VOLUME_PARTITION_INFO,    "IOCTL_CDROM_GET_VOLUME_PARTITION_INFO" },
    { IOCTL_CDROM_MEDIA_REMOVAL,                "IOCTL_CDROM_MEDIA_REMOVAL" },
    { IOCTL_CDROM_READ_Q_CHANNEL,               "IOCTL_CDROM_READ_Q_CHANNEL" },
    { IOCTL_CDROM_RAW_READ,                     "IOCTL_CDROM_RAW_READ" },
    { IOCTL_CDROM_READ_TOC,                     "IOCTL_CDROM_READ_TOC" },
    { IOCTL_CDROM_READ_TOC_EX,                  "IOCTL_CDROM_READ_TOC_EX" },
    { IOCTL_CDROM_RESERVE,                      "IOCTL_CDROM_RESERVE" },
    { IOCTL_CDROM_RELEASE,                      "IOCTL_CDROM_RELEASE" },
    { IOCTL_CDROM_SEND_OPC_INFORMATION,         "IOCTL_CDROM_SEND_OPC_INFORMATION" },
//    { IOCTL_CDROM_SET_VOLUME_PARTITION_INFO,    "IOCTL_CDROM_SET_VOLUME_PARTITION_INFO" },
    { IOCTL_CDROM_SET_SPEED,                    "IOCTL_CDROM_SET_SPEED" },
    { IOCTL_CDROM_SIMBAD,                       "IOCTL_CDROM_SIMBAD" },
    { IOCTL_CDROM_STOP_AUDIO,                   "IOCTL_CDROM_STOP_AUDIO" },
    { IOCTL_CDROM_TRACK_ISRC,                   "IOCTL_CDROM_TRACK_ISRC" },
    { IOCTL_CDROM_UNLOAD_DRIVER,                "IOCTL_CDROM_UNLOAD_DRIVER" },

    // --- DVD IOCTLs ---
    { IOCTL_DVD_START_SESSION,                  "IOCTL_DVD_START_SESSION" },
    { IOCTL_DVD_READ_KEY,                       "IOCTL_DVD_READ_KEY" },
    { IOCTL_DVD_SEND_KEY,                       "IOCTL_DVD_SEND_KEY" },
    { IOCTL_DVD_END_SESSION,                    "IOCTL_DVD_END_SESSION" },
    { IOCTL_DVD_READ_STRUCTURE,                 "IOCTL_DVD_READ_STRUCTURE" },
//    { IOCTL_DVD_SEND_STRUCTURE,                 "IOCTL_DVD_SEND_STRUCTURE" },
    { IOCTL_DVD_GET_REGION,                     "IOCTL_DVD_GET_REGION" },
    { IOCTL_DVD_SET_READ_AHEAD,                 "IOCTL_DVD_SET_READ_AHEAD" },
//    { IOCTL_DVD_GET_STATUS,                     "IOCTL_DVD_GET_STATUS" },
    { IOCTL_DVD_START_SESSION,                  "IOCTL_DVD_START_SESSION" },

    // --- Storage IOCTLs ---
    { IOCTL_STORAGE_CHECK_VERIFY,               "IOCTL_STORAGE_CHECK_VERIFY" },
    { IOCTL_STORAGE_CHECK_VERIFY2,              "IOCTL_STORAGE_CHECK_VERIFY2" },
    { IOCTL_STORAGE_EJECT_MEDIA,                "IOCTL_STORAGE_EJECT_MEDIA" },
    { IOCTL_STORAGE_LOAD_MEDIA,                 "IOCTL_STORAGE_LOAD_MEDIA" },
    { IOCTL_STORAGE_LOAD_MEDIA2,                "IOCTL_STORAGE_LOAD_MEDIA2" },
    { IOCTL_STORAGE_MEDIA_REMOVAL,              "IOCTL_STORAGE_MEDIA_REMOVAL" },
    { IOCTL_STORAGE_GET_MEDIA_TYPES,            "IOCTL_STORAGE_GET_MEDIA_TYPES" },
    { IOCTL_STORAGE_GET_MEDIA_TYPES_EX,         "IOCTL_STORAGE_GET_MEDIA_TYPES_EX" },
    { IOCTL_STORAGE_GET_DEVICE_NUMBER,          "IOCTL_STORAGE_GET_DEVICE_NUMBER" },
    { IOCTL_STORAGE_QUERY_PROPERTY,             "IOCTL_STORAGE_QUERY_PROPERTY" },

    // --- Disk IOCTLs ---
    { IOCTL_DISK_GET_DRIVE_GEOMETRY,            "IOCTL_DISK_GET_DRIVE_GEOMETRY" },
    { IOCTL_DISK_GET_DRIVE_GEOMETRY_EX,         "IOCTL_DISK_GET_DRIVE_GEOMETRY_EX" },
    { IOCTL_DISK_GET_DRIVE_LAYOUT,              "IOCTL_DISK_GET_DRIVE_LAYOUT" },
    { IOCTL_DISK_GET_DRIVE_LAYOUT_EX,           "IOCTL_DISK_GET_DRIVE_LAYOUT_EX" },
    { IOCTL_DISK_GET_PARTITION_INFO,            "IOCTL_DISK_GET_PARTITION_INFO" },
    { IOCTL_DISK_GET_PARTITION_INFO_EX,         "IOCTL_DISK_GET_PARTITION_INFO_EX" },
    { IOCTL_DISK_GET_LENGTH_INFO,               "IOCTL_DISK_GET_LENGTH_INFO" },
    { IOCTL_DISK_PERFORMANCE,                   "IOCTL_DISK_PERFORMANCE" },
    { IOCTL_DISK_UPDATE_PROPERTIES,             "IOCTL_DISK_UPDATE_PROPERTIES" },

    // --- SCSI IOCTLs ---
    { IOCTL_SCSI_PASS_THROUGH,                  "IOCTL_SCSI_PASS_THROUGH" },
    { IOCTL_SCSI_PASS_THROUGH_DIRECT,           "IOCTL_SCSI_PASS_THROUGH_DIRECT" },
    { IOCTL_SCSI_GET_ADDRESS,                   "IOCTL_SCSI_GET_ADDRESS" },
    { IOCTL_SCSI_GET_CAPABILITIES,              "IOCTL_SCSI_GET_CAPABILITIES" },
    { IOCTL_SCSI_MINIPORT,                      "IOCTL_SCSI_MINIPORT" },
    { IOCTL_SCSI_MINIPORT_NVCACHE,              "IOCTL_SCSI_MINIPORT_NVCACHE" }
};
