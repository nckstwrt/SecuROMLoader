https://www.youtube.com/watch?v=AcVTF1HfTb  https://exelab.ru/f/index.php?action=vthread&forum=13&topic=19719
https://web.archive.org/web/20130908111155/http://exelab.ru/f/index.php?action=vthread&forum=13&topic=19719
https://jeyndoe.github.io/edump/pages/action=vthread&forum=3&topic=26235&page=0.html
https://web.archive.org/web/20160322163404/https://exelab.ru/f/index.php?action=vthread&forum=13&topic=19719

83E0 1F 3C 1F5

Step 3. Signature verification – Level 1. Layout 1. We look for the following sequence of bytes: 83E0 1F 3C 1F5 (that is, two instructions) and set the first Hardware Breakpoint.


83E0 1F 

3C1FE083


0111BFF4                       | 83E0 1F                               | and eax,1F                                       |
0111BFF7                       | 3C 1F                                 | cmp al,1F                                        |

83E0 1F 3C 1F

in nunc??
0102D591                       | E8 0A7BDCFF                           | call <cnc3game.sub_DF50A0>                       |
0102D596                       | B8 CBA7F2FF                           | mov eax,FFF2A7CB                                 |
0102D59B                       | 8D8428 E9570D00                       | lea eax,dword ptr ds:[eax+ebp+D57E9]             |
0102D5A2                       | 8D6424 FC                             | lea esp,dword ptr ss:[esp-4]                     | [esp-04]:ZwWaitForSingleObject+C
0102D5A6                       | 890424                                | mov dword ptr ss:[esp],eax                       | [esp]:WaitForSingleObjectEx+88
0102D5A9                       | 8BC8                                  | mov ecx,eax                                      |
0102D5AB                       | E8 60B5DCFF                           | call cnc3game.DF8B10                             |
0102D5B0                       | 83E0 1F                               | and eax,1F                                       |
0102D5B3                       | 3C 1F                                 | cmp al,1F                                        |
0102D5B5                       | 9C                                    | pushfd                                           |
0102D5B6                       | 9C                                    | pushfd                                           |
0102D5B7                       | 83EC 1C                               | sub esp,1C                                       |
0102D5BA                       | C74424 18 DA03CC45                    | mov dword ptr ss:[esp+18],45CC03DA               |
0102D5C2                       | C74424 14 39000100                    | mov dword ptr ss:[esp+14],10039                  |
0102D5CA                       | 894C24 10                             | mov dword ptr ss:[esp+10],ecx                    |


0102D5A9                       | 8BC8                                  | mov ecx,eax                                      |
0102D5AB                       | E8 60B5DCFF                           | call <cnc3game.sub_DF8B10>                       |
0102D5B0                       | 83E0 1F                               | and eax,1F                                       |
0102D5B3                       | 3C 1F                                 | cmp al,1F                                        |
0102D5B5                       | 9C                                    | pushfd                                           |
0102D5B6                       | 9C                                    | pushfd                                           |
^ this one did get hit when the right disk was inserted
(for CNC) - which was the last of the 3 in the list found



01158FBA                       | DD05 BA8F1501                         | fld qword ptr ds:[1158FBA]                       |
01158FC0                       | DC25 BA8F1501                         | fsub qword ptr ds:[1158FBA]                      |
01158FC6                       | DC0D BA8F1501                         | fmul qword ptr ds:[1158FBA]                      |
01158FCC                       | DC1D BA8F1501                         | fcomp qword ptr ds:[1158FBA]                     |
01158FD2                       | DFE0                                  | fnstsw ax                                        |
01158FD4                       | F6C4 05                               | test ah,5                                        |

DD05 ???????? DC25 ???????? DC0D ???????? DC1D ????????

Found these:
0103DAAD                       | DD05 D0181A01                         | fld qword ptr ds:[11A18D0]                       |
0103DAB3                       | DC25 D8181A01                         | fsub qword ptr ds:[11A18D8]                      |
0103DAB9                       | DC0D 3CBD3701                         | fmul qword ptr ds:[137BD3C]                      |
0103DABF                       | DC1D 50A53501                         | fcomp qword ptr ds:[135A550]                     |
0103DAC5                       | DFE0                                  | fnstsw ax                                        |
0103DAC7                       | F6C4 05                               | test ah,5                                        |

0103DBEA                       | DD05 D0181A01                         | fld qword ptr ds:[11A18D0]                       |
0103DBF0                       | DC25 D8181A01                         | fsub qword ptr ds:[11A18D8]                      |
0103DBF6                       | DC0D 3CBD3701                         | fmul qword ptr ds:[137BD3C]                      |
0103DBFC                       | DC1D 50A53501                         | fcomp qword ptr ds:[135A550]                     |
0103DC02                       | DFE0                                  | fnstsw ax                                        |
0103DC04                       | F6C4 05                               | test ah,5                                        |
0103DC07                       | 9C                                    | pushfd                                           |
0103DC08                       | 68 E8100000                           | push 10E8                                        |

01052470                       | DD05 D0181A01                         | fld qword ptr ds:[11A18D0]                       |
01052476                       | DC25 D8181A01                         | fsub qword ptr ds:[11A18D8]                      |
0105247C                       | DC0D 58A53501                         | fmul qword ptr ds:[135A558]                      |
01052482                       | DC1D 50A53501                         | fcomp qword ptr ds:[135A550]                     |
01052488                       | DFE0                                  | fnstsw ax                                        |
0105248A                       | F6C4 05                               | test ah,5                                        |
0105248D                       | 9C                                    | pushfd                                           |
0105248E                       | 9C                                    | pushfd                                           |

0105ACC7                       | DD05 D0181A01                         | fld qword ptr ds:[11A18D0]                       |
0105ACCD                       | DC25 D8181A01                         | fsub qword ptr ds:[11A18D8]                      |
0105ACD3                       | DC0D 3CBD3701                         | fmul qword ptr ds:[137BD3C]                      |
0105ACD9                       | DC1D 50A53501                         | fcomp qword ptr ds:[135A550]                     |
0105ACDF                       | DFE0                                  | fnstsw ax                                        |
0105ACE1                       | F6C4 05                               | test ah,5                                        |
0105ACE4                       | 9C                                    | pushfd                                           |
0105ACE5                       | 9C                                    | pushfd                                           |

bibendum seems to be the section doing the decryption

Can normal breakpoint the start of nunc
wait till it starts 8b 44 24
(or at least till the first byte)


01158FE8 | 8498 C0070000 | test byte ptr ds:[eax+7C0],bl    | eax+7C0:public: class AptAnimationTarget * __thiscall AptTarget::GetAnimationTarget(void)+A3AEA0

00C891A0                       | 8B06                                  | mov eax,dword ptr ds:[esi]                       | eax:public: class AptAnimationTarget * __thiscall AptTarget::GetAnimationTarget(void)+5847E0, [esi]:public: class AptAnimationTarget * __thiscall AptTarget::GetAnimationTarget(void)+5847E0
00C891A2                       | 014424 1C                             | add dword ptr ss:[esp+1C],eax                    | eax:public: class AptAnimationTarget * __thiscall AptTarget::GetAnimationTarget(void)+5847E0
00C891A6                       | 90                                    | nop                                              |
00C891A7                       | 83C6 04                               | add esi,4                                        | esi:public: class AptAnimationTarget * __thiscall AptTarget::GetAnimationTarget(void)+3318E4
00C891AA                       | 66:FF4C24 18                          | dec word ptr ss:[esp+18]                         |
00C891AF                       | 75 EF                                 | jne cnc3game.C891A0                              |
00C891B1                       | 50                                    | push eax                                         |
Is this a CRC check??

0C8B5FED afterwards (checked with a hw breakpoint)


00C89252                       | 817C24 20 350B0000                    | cmp dword ptr ss:[esp+20],B35                    |
00C8925A                       | 74 12                                 | je cnc3game.C8926E                               |
^ other CRC??

May be checking timings


00F11E97                                                  | 90                                    | nop                                                                             |
00F11E98                                                  | 890C24                                | mov dword ptr ss:[esp],ecx                                                      |
00F11E9B                                                  | 83C4 04                               | add esp,4                                                                       |
00F11E9E                                                  | 810424 48050000                       | add dword ptr ss:[esp],548                                                      |
00F11EA5                                                  | 64:FF35 00000000                      | push dword ptr fs:[0]                                                           |
00F11EAC                                                  | 64:8925 00000000                      | mov dword ptr fs:[0],esp                                                        |
00F11EB3                                                  | 8D6424 FC                             | lea esp,dword ptr ss:[esp-4]                                                    | [esp-04]:public: class AptAnimationTarget * __thiscall AptTarget::GetAnimationTarget(void)+5D07E0
00F11EB7                                                  | 893424                                | mov dword ptr ss:[esp],esi                                                      |
00F11EBA                                                  | 8D35 D1FB3C09                         | lea esi,dword ptr ds:[93CFBD1]                                                  |
00F11EC0                                                  | C786 CBD9E8F7 E66FE200                | mov dword ptr ds:[esi-8172635],<cnc3game.sub_E26FE6>                            |
00F11ECA                                                  | C786 CFD9E8F7 FE6FEA00                | mov dword ptr ds:[esi-8172631],<cnc3game.sub_EA6FFE>                            |
00F11ED4                                                  | C786 D3D9E8F7 1C70E700                | mov dword ptr ds:[esi-817262D],cnc3game.E7701C                                  |
00F11EDE                                                  | C786 D7D9E8F7 3470E600                | mov dword ptr ds:[esi-8172629],<cnc3game.sub_E67034>                            |
00F11EE8                                                  | 8B3424                                | mov esi,dword ptr ss:[esp]                                                      |
00F11EEB                                                  | 8D6424 04                             | lea esp,dword ptr ss:[esp+4]                                                    | [esp+04]:public: class AptAnimationTarget * __thiscall AptTarget::GetAnimationTarget(void)+5BBC3B
00F11EEF                                                  | 0F0B                                  | ud2                                                                             |
00F11EF1                                                  | EB 07                                 | jmp <cnc3game.sub_F11EFA>                                                       |
00F11EF3                                                  | 2222                                  | and ah,byte ptr ds:[edx]                                                        |
00F11EF5                                                  | 2200                                  | and al,byte ptr ds:[eax]                                                        | eax:public: class AptAnimationTarget * __thiscall AptTarget::GetAnimationTarget(void)+5D07E0
00F11EF7                                                  | 0300                                  | add eax,dword ptr ds:[eax]                                                      | eax:public: class AptAnimationTarget * __thiscall AptTarget::GetAnimationTarget(void)+5D07E0
00F11EF9                                                  | 028B 7D088B4D                         | add cl,byte ptr ds:[ebx+4D8B087D]                                               |
00F11EFF                                                  | 0C 33                                 | or al,33                                                                        |
00F11F01                                                  | ED                                    | in eax,dx                                                                       | eax:public: class AptAnimationTarget * __thiscall AptTarget::GetAnimationTarget(void)+5D07E0
00F11F02                                                  | 74 01                                 | je cnc3game.F11F05                                                              |
00F11F04                                                  | 25 33ED7402                           | and eax,274ED33                                                                 | eax:public: class AptAnimationTarget * __thiscall AptTarget::GetAnimationTarget(void)+5D07E0


00F11F49                                                  | 6201                                  | bound eax,qword ptr ds:[ecx]                                                    | eax:public: class AptAnimationTarget * __thiscall AptTarget::GetAnimationTarget(void)+5D07E0
00F11F4B                                                  | 0059 61                               | add byte ptr ds:[ecx+61],bl    0 <--- may go here                                                  |
00F11F4E                                                  | 8107 90AD0C00                         | add dword ptr ds:[edi],CAD90                                                    | edi:public: class AptAnimationTarget * __thiscall AptTarget::GetAnimationTarget(void)+9519A8
00F11F54                                                  | 33ED                                  | xor ebp,ebp                                                                     |
00F11F56                                                  | 74 01                                 | je cnc3game.F11F59                                                              |
00F11F58                                                  | B8 6068EC35                           | mov eax,35EC6860    

SEH might be here:
00F135D0                                                  | 0000                                  | add byte ptr ds:[eax],al                                                        |
00F135D2                                                  | 0000                                  | add byte ptr ds:[eax],al                                                        |
00F135D4                                                  | C705 085F1B01 00000000                | mov dword ptr ds:[11B5F08],0                                                    |
00F135DE                                                  | 61                                    | popad                                                                           |
00F135DF                                                  | 33C0                                  | xor eax,eax                                                                     |
00F135E1                                                  | 8BE5                                  | mov esp,ebp                                                                     |
00F135E3                                                  | 5D                                    | pop ebp                                                                         |
00F135E4                                                  | C3                                    | ret                                                                             |                                                            | eax:public: class AptAnimationTarget * __thiscall AptTarget::GetAnimationTarget(void)+5D07E0

One exception handler:
00F135E5 <cnc3game.sub_F135E5>                            | 55                                    | push ebp                                                                        |
00F135E6                                                  | 8BEC                                  | mov ebp,esp                                                                     |
00F135E8                                                  | 60                                    | pushad                                                                          |
00F135E9                                                  | A1 60A81601                           | mov eax,dword ptr ds:[116A860]                                                  |
00F135EE                                                  | A3 005F1B01                           | mov dword ptr ds:[11B5F00],eax                                                  |


Does hit here at least:
0104E978                                                  | DD1D D0181A01                         | fstp qword ptr ds:[11A18D0]                                                     |
0104E97E                                                  | E8 08000000                           | call <cnc3game.sub_104E98B>                                                     |
0104E983                                                  | 97                                    | xchg edi,eax                                                                    |
0104E984                                                  | CA 7308                               | ret far 873                                                                     |

--------------------------------------------------------------------------------------------------------------------------
v1.09

// 0
010BC29B                                                  | 84DB                                  | test bl,bl                                        |  <--- Swap the ZF - ZF needs to be 1 

83E0 1F 3C 1F
010B6FC9                                                  | E8 3F60F7FF                           | call cnc3game.102D00D                                                           |
010B6FCE                                                  | 83E0 1F                               | and eax,1F                       <---- B0 1F 90 (mov al, 1f)                                      |
010B6FD1                                                  | 3C 1F                                 | cmp al,1F                <-----  1         make al 1f                                            |
010B6FD3                                                  | 9C                                    | pushfd                                                                          |
010B6FD4                                                  | 9C                                    | pushfd                                                                          |
010B6FD5                                                  | 83EC 24                               | sub esp,24                                                                      |

010A6158                                                  | 33DB                                  | xor ebx,ebx                                                                     |
010A615A                                                  | F9                                    | stc                                                                             |
010A615B                                                  | 83D3 00                               | adc ebx,0                                                                       |
010A615E                                                  | 8498 C0070000                         | test byte ptr ds:[eax+7C0],bl    <-----  2            put 09 in the location (first byte)                                 |
010A6164                                                  | 895D FC                               | mov dword ptr ss:[ebp-4],ebx                                                    |
010A6167                                                  | B9 37F6FEFF                           | mov ecx,FFFEF637                                                                |
010A616C                                                  | 8D8C29 85090100                       | lea ecx,dword ptr ds:[ecx+ebp+10985]                                            |
010A6173                                                  | 9C                                    | pushfd                                                                          |
010A6174                                                  | 68 053B0000                           | push 3B05                                                                       |

010B86A1                                                  | 80BF F2070000 00                      | cmp byte ptr ds:[edi+7F2],0        <------  3     put 02 in the location (first byte)  (maybe 01?)                                   |
010B86A8                                                  | 9C                                    | pushfd                                                                          |
010B86A9                                                  | 68 7F2D0000                           | push 2D7F                                                                       |
010B86AE                                                  | 75 17                                 | jne cnc3game.10B86C7                 

803D ???????? 00 9C 68 ?? ?? ?? ?? 76
010DF7A9                                                  | 803D BF1D2D01 00                      | cmp byte ptr ds:[12D1DBF],0     <------  2FIX       put 02 in the location (first byte)                                          |
010DF7B0                                                  | 9C                                    | pushfd                                                                          |
010DF7B1                                                  | 68 AF060000                           | push 6AF                                                                        |
010DF7B6                                                  | 76 15                                 | jbe cnc3game.10DF7CD                                                            |                                           |

010EAFB2                                                  | DD05 78DC1E01                         | fld qword ptr ds:[11EDC78]        <--- Should be 0.126437                 |
010EAFB8                                                  | BE 301E2D01                           | mov esi,cnc3game.12D1E30                          | esi:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+98C8FA
010EAFBD                                                  | DC25 80DC1E01                         | fsub qword ptr ds:[11EDC80]       <--- should be 0            was 0.25 but subs 0 from it                                  |
010EAFC3                                                  | DC0D 50C04A01                         | fmul qword ptr ds:[14AC050]                   x10 = 25                                  |
010EAFC9                                                  | DC1D 98304801                         | fcomp qword ptr ds:[1483098]                  <---- this is 0? bu that's fine?                                  |
010EAFCF                                                  | DFE0                                  | fnstsw ax                                  // Swapping   | 34 01      | xor al,1  could work to invert it
010EAFD1                                                  | F6C4 05                               | test ah,5       <-----  // Geometry 1                                                                     |

DC25 ???????? DC0D ???????? DC1D ???????? DFE0 F6C4 05

010ED310                                                  | DD05 78DC1E01                         | fld qword ptr ds:[11EDC78]                                                      |
010ED316                                                  | DC25 80DC1E01                         | fsub qword ptr ds:[11EDC80]                                                     |
010ED31C                                                  | DC0D 644E4A01                         | fmul qword ptr ds:[14A4E64]                                                     |
010ED322                                                  | DC1D 98304801                         | fcomp qword ptr ds:[1483098]                                                    |
010ED328                                                  | DFE0                                  | fnstsw ax                                                <-- B4 01 mov ah, 01                       |
010ED32A                                                  | F6C4 05                               | test ah,5        <-----  // Geometry 2                                                                                                                                    |
010ED32D                                                  | 9C                                    | pushfd                                                                          |
010ED32E                                                  | 68 F2240000                           | push 24F2                                                                       |

010CD164                                                  | DD05 78DC1E01                         | fld qword ptr ds:[11EDC78]          loads 0.25                                            |
010CD16A                                                  | DC25 80DC1E01                         | fsub qword ptr ds:[11EDC80]          0 again                                           |
010CD170                                                  | DC0D 644E4A01                         | fmul qword ptr ds:[14A4E64]          multiples to -8 ?   so -32??? Yep is double                                        |
010CD176                                                  | DC1D 98304801                         | fcomp qword ptr ds:[1483098]                                                    |
010CD17C                                                  | DFE0                                  | fnstsw ax                                                                       |
010CD17E                                                  | F6C4 05                               | test ah,5        <------- // Geometry 3                                                               |
010CD181                                                  | 9C                                    | pushfd                                                                          |

is in artem
01483078  62 75 66 66 65 72 2E 63 00 00 00 00 2E 5C 63 72  buffer.c.....\cr  
01483088  79 70 74 6F 5C 6D 65 6D 5F 64 62 67 2E 63 00 00  ypto\mem_dbg.c..  
01483098  00 00 00 00 00 00 59 40 00 00 00 00 00 00 24 40  ......Y@......$@     <--- comp value normally 0
014830A8  00 00 00 00 00 00 E0 3F 2E 5C 63 72 79 70 74 6F  ......à?.\crypto  
014830B8  5C 62 69 6F 5C 62 5F 70 72 69 6E 74 2E 63 00 00  \bio\b_print.c..  

Making the subtraction = 0 - it will pass the check
010DF204                                                  | 872C24                                | xchg dword ptr ss:[esp],ebp                       |
010DF207                                                  | 8BD2                                  | mov edx,edx                                       |
010DF209                                                  | C74424 04 C204009B                    | mov dword ptr ss:[esp+4],9B0004C2                 |
010DF211                                                  | EB FA                                 | jmp cnc3game.10DF20D                              |
010DF213                                                  | 1B4E DD                               | sbb ecx,dword ptr ds:[esi-23]                     | ecx:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+6BAACA
010DF216                                                  | 1D 80DC1E01                           | sbb eax,cnc3game.11EDC80                          | eax:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+6BAACA
010DF21B                                                  | 9C                                    | pushfd                                            |

When using WinCDEmu
Geometry 1.
Loads DOUBLE(!) 0.0202556
SUBS 0.1  (0.0202556 - 0.1 = -0.0797444)
Multiplies by 100 (-7.97444)
Compares to 0 - should be higher! 
TEST ah,05 is AND'ing result with 05
ZF should be 1 (as we want AH to be 0 so it doesn't have 05)
Yep so seems to be basically just a check to say less than - so -8 would work



Geometry 2.
Loads DOUBLE(!) 0.0202556
Subs 0.1 (-0.0797444)
Now multiplies by -32 (gives 2.55)
ZF should be 0

Geometry 3.
Loads DOUBLE(!) 0.0202556
Subs 0.1 (-0.0797444)
Now multiplies by -32 (gives 2.55)
ZF should be 0

------------------------------------
CRC for FLD of the main value that's saved
010ED0AF                               | 8BBF EB952D01                         | mov edi,dword ptr ds:[edi+12D95EB]                |
010ED0B5                               | 8D35 78DC1E01                         | lea esi,dword ptr ds:[11EDC78]                    | esi:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+8A8742
010ED0BB                               | BA 03D5FBFF                           | mov edx,FFFBD503                                  |
010ED0C0                               | 8B9432 FD2A0400                       | mov edx,dword ptr ds:[edx+esi+42AFD]              |
010ED0C7                               | 81F2 341A0000                         | xor edx,1A34                                      |
010ED0CD                               | 8957 08                               | mov dword ptr ds:[edi+8],edx                      |
010ED0D0                               | BA EFB6F8FF                           | mov edx,FFF8B6EF                                  |
010ED0D5                               | 8B9432 15490700                       | mov edx,dword ptr ds:[edx+esi+74915]              |
010ED0DC                               | 81F2 21A30600                         | xor edx,6A321                                     |

0581DBC4                               | FF37                                  | push dword ptr ds:[edi]                           | edi:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+8A8742
0581DBC6                               | 31FF                                  | xor edi,edi                                       | edi:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+8A8742
0581DBC8                               | 89C2                                  | mov edx,eax                                       |
0581DBCA                               | C1C2 10                               | rol edx,10                                        |
0581DBCD                               | 81E2 FF000000                         | and edx,FF                                        |
0581DBD3                               | D2C2                                  | rol dl,cl                                         |
0581DBD5                               | C1E2 02                               | shl edx,2                                         |
0581DBD8                               | 01DA                                  | add edx,ebx                                       |
0581DBDA                               | 8F02                                  | pop dword ptr ds:[edx]                            | [edx]:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+8A8742
0581DBDC                               | 31D2                                  | xor edx,edx                                       |
0581DBDE                               | 89DF                                  | mov edi,ebx                                       | edi:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+8A8742
0581DBE0                               | 81C7 04000000                         | add edi,4                                         | edi:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+8A8742
0581DBE6                               | 8107 02000000                         | add dword ptr ds:[edi],2                          | edi:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+8A8742
0581DBEC                               | 8107 02000000                         | add dword ptr ds:[edi],2                          | edi:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+8A8742
0581DBF2                               | 58                                    | pop eax                                           |
0581DBF3                               | FFE0                                  | jmp eax                                           |
------------------------------------
So if make the drive point to the C drive - looking up the 102D00D function afterwards - there was test bl which when ZF set the other way made it think it was the right disk

Calls 102D00D twice and then does another func and then returns to:

010BC286                                                  | 90                                    | nop                                               |
010BC287                                                  | 873424                                | xchg dword ptr ss:[esp],esi                       |
010BC28A                                                  | B9 6D6EF7FF                           | mov ecx,FFF76E6D                                  |
010BC28F                                                  | 8D8C29 37910800                       | lea ecx,dword ptr ds:[ecx+ebp+89137]              |
010BC296                                                  | E8 1ABCC2FF                           | call cnc3game.CE7EB5                              |
010BC29B                                                  | 84DB                                  | test bl,bl                                        |  <--- Swap the ZF - ZF needs to be 1 
010BC29D                                                  | 9C                                    | pushfd                                            |
010BC29E                                                  | 68 9D180000                           | push 189D                                         |
010BC2A3                                                  | 74 10                                 | je cnc3game.10BC2B5                               |  <---- jump should be taken
010BC2A5                                                  | 810424 E7D03000                       | add dword ptr ss:[esp],30D0E7                     |
010BC2AC                                                  | 810424 C3D9DA00                       | add dword ptr ss:[esp],cnc3game.DAD9C3            |


----- PERFORMANCE CHECK
010F1033                               | FF30                                  | push dword ptr ds:[eax]                           | eax:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+39F3CA
010F1035                               | FF15 76BD4C01                         | call dword ptr ds:[<DeviceIoControl>]             |
010F103B                               | 85C0                                  | test eax,eax                                      | eax:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+39F3CA
010F103D                               | 74 B9                                 | je cnc3game.10F0FF8                               |
010F103F                               | 8D45 58                               | lea eax,dword ptr ss:[ebp+58]                     | eax:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+39F3CA
010F1042                               | 50                                    | push eax                                          | eax:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+39F3CA
010F1043                               | FF15 DABC4C01                         | call dword ptr ds:[<QueryPerformanceCounter>]     |
010F1049                               | 8B45 68                               | mov eax,dword ptr ss:[ebp+68]                     | eax:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+39F3CA
010F104C                               | 6A FF                                 | push FFFFFFFF                                     |
010F104E                               | FF30                                  | push dword ptr ds:[eax]                           | eax:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+39F3CA
010F1050                               | FF15 DABB4C01                         | call dword ptr ds:[<WaitForSingleObject>]         |
010F1056                               | 85C0                                  | test eax,eax                                      | eax:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+39F3CA
010F1058                               | 75 9E                                 | jne cnc3game.10F0FF8                              |
010F105A                               | 8D45 48                               | lea eax,dword ptr ss:[ebp+48]                     | eax:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+39F3CA
010F105D                               | 50                                    | push eax                                          | eax:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+39F3CA
010F105E                               | FF15 DABC4C01                         | call dword ptr ds:[<QueryPerformanceCounter>]     |
010F1064                               | 53                                    | push ebx                                          |
010F1065                               | 8D45 70                               | lea eax,dword ptr ss:[ebp+70]                     | eax:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+39F3CA
010F1068                               | 50                                    | push eax                                          | eax:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+39F3CA
010F1069                               | 6A 58                                 | push 58                                           |
010F106B                               | 8D45 98                               | lea eax,dword ptr ss:[ebp-68]                     | eax:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+39F3CA, [ebp-68]:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+B2D8B2
010F106E                               | 50                                    | push eax                                          | eax:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+39F3CA
010F106F                               | 8B45 6C                               | mov eax,dword ptr ss:[ebp+6C]                     | eax:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+39F3CA
010F1072                               | 53                                    | push ebx                                          |
010F1073                               | 53                                    | push ebx                                          |
010F1074                               | 68 20000700                           | push 70020                                        |
010F1079                               | FF30                                  | push dword ptr ds:[eax]                           | eax:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+39F3CA
010F107B                               | FF15 76BD4C01                         | call dword ptr ds:[<DeviceIoControl>]             |
010F1081                               | 85C0                                  | test eax,eax                                      | eax:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+39F3CA
010F1083                               | 0F84 6FFFFFFF                         | je cnc3game.10F0FF8                               |
010F1089                               | 8B45 98                               | mov eax,dword ptr ss:[ebp-68]                     | eax:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+39F3CA, [ebp-68]:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+B2D8B2
010F108C                               | 8BC8                                  | mov ecx,eax                                       | ecx:"7001F6819786B3A7557F9E4FAEE8C8858682E4BF73C73A1B3F1C2F381477B41922D35B0CD602818C6C9B61D59F0D1CF7AFD52975E0D6B02ABBA4A5618C630DFA376EAD4A8E3CE87FA14746FB396DD64AD0D8F3D367FB25C31743CBC6FBF08F035847", eax:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+39F3CA

DFE0F6C4 059C 
-----------------------------------------------
010B6FD1                                                  | 812F 00500000                         | sub dword ptr ds:[edi],5000                                                     | edi:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+993292
012D87C8  02 7F 6F 13 01 00 00 00 14 04 46 01 FC 03 46 01  ..o.......F.ü.F.  
136F7F02 - 5000 = 136F2F02

012D87C8  E8 DE 02 61 01 00 00 00 14 04 46 01 FC 03 46 01  èÞ.a......F.ü.F.  
6102DEE8 ^ 1BADBABE = 7AAF6456

So NtContinue tracing in - leads us to: (always different memory address)
01971AA9                                                  | 60                                    | pushad                                                                          |
01971AAA                                                  | 51                                    | push ecx                                                                        |
01971AAB                                                  | 50                                    | push eax                                                                        |
01971AAC                                                  | E8 BBFFFFFF                           | call 1971A6C                                                                    |
01971AB1                                                  | 83F8 00                               | cmp eax,0                                                                       |
01971AB4                                                  | 74 0D                                 | je 1971AC3                                                                      |
01971AB6                                                  | 61                                    | popad                                                                           |
01971AB7                                                  | 83C4 04                               | add esp,4                                                                       |
01971ABA                                                  | 51                                    | push ecx       
...
01971A15                                                  | EB 44                                 | jmp 1971A5B         <--- can BP   (search for EB 44)      
... >... Next call
01971A60                                                  | FF15 F45B9701   <--- these bytes      | call dword ptr ds:[1975BF4]                                                     |                                                   |                                                                 |

-------------------------------------------------------------------
in est - it unecrypts ars
011DADE4                                                  | EB 14                                 | jmp cnc3game.11DADFA                                                            |
011DADE6                                                  | F6C1 20                               | test cl,20                                                                      |
011DADE9                                                  | 74 08                                 | je cnc3game.11DADF3                                                             |
011DADEB                                                  | C706 0B000000                         | mov dword ptr ds:[esi],B                                                        | 0B:'\v'
011DADF1                                                  | EB 0D                                 | jmp cnc3game.11DAE00                                                            |
011DADF3                                                  | C740 18 70EA4B01                      | mov dword ptr ds:[eax+18],cnc3game.14BEA70                                      | 14BEA70:"invalid literal/length code"
011DADFA                                                  | C706 1B000000                         | mov dword ptr ds:[esi],1B                                                       |
011DAE00                                                  | 8B4D 0C                               | mov ecx,dword ptr ss:[ebp+C]                                                    |
011DAE03                                                  | C1E9 03                               | shr ecx,3                                                                       |
011DAE06                                                  | 2BD9                                  | sub ebx,ecx                                                                     |
011DAE08                                                  | C1E1 03                               | shl ecx,3                                                                       |
011DAE0B                                                  | 294D 0C                               | sub dword ptr ss:[ebp+C],ecx         <-------- decrypted here                                             |

011DA3F0                                                  | E9 27F6FFFF                           | jmp cnc3game.11D9A1C                                                            |
011DA3F5                                                  | 8B4B 4C                               | mov ecx,dword ptr ds:[ebx+4C]                                                   |
^ getting called in this loop

00C9796E                                                  | 64:FF35 00000000                      | push dword ptr fs:[0]                                                           |
00C97975                                                  | 64:8925 00000000                      | mov dword ptr fs:[0],esp                                                        |
00C9797C                                                  | 8D6424 FC                             | lea esp,dword ptr ss:[esp-4]                                                    |
00C97980                                                  | 893424                                | mov dword ptr ss:[esp],esi                                                      |
00C97983                                                  | 8D35 21264509                         | lea esi,dword ptr ds:[9452621]                                                  |
00C97989                                                  | C786 CBD9E8F7 AFCABA00                | mov dword ptr ds:[esi-8172635],cnc3game.BACAAF                                  | BACAAF:"Impl@Private@Gadget@InGameUI@@"
00C97993                                                  | C786 CFD9E8F7 C7CAC200                | mov dword ptr ds:[esi-8172631],cnc3game.C2CAC7                                  |
00C9799D                                                  | C786 D3D9E8F7 E5CABF00                | mov dword ptr ds:[esi-817262D],cnc3game.BFCAE5                                  |
00C979A7                                                  | C786 D7D9E8F7 FDCABE00                | mov dword ptr ds:[esi-8172629],cnc3game.BECAFD                                  |
00C979B1                                                  | 8B3424                                | mov esi,dword ptr ss:[esp]                                                      |
00C979B4                                                  | 8D6424 04                             | lea esp,dword ptr ss:[esp+4]                                                    | [esp+04]:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+35417A
00C979B8                                                  | 0F0B                                  | ud2                                                                             |
00C979BA                                                  | EB 07                                 | jmp cnc3game.C979C3                                                             |
^ does seem to go to the JMP after ud2 - but now all the DR registers are set
DR0 C979E1
DR1 C979F9
DR2 C97A17
DR3 C97A2F
DR6 000000
DR7 000155

DR6 = FFFF0FF1  After jmp)

once it gets to 00C979E1 | 812F 00500000 | sub dword ptr ds:[edi],5000                                                     | edi:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+993292

Exception handler:

struct EXCEPTION_REGISTRATION {
    EXCEPTION_REGISTRATION* Next;   // linked list
    PEXCEPTION_HANDLER      Handler; // function pointer
};

Exception Handler:
00C996B0                                                  | 55                                    | push ebp                                                                        |
00C996B1                                                  | 8BEC                                  | mov ebp,esp                                                                     |
00C996B3                                                  | 60                                    | pushad                                                                          |
00C996B4                                                  | 8B45 08                               | mov eax,dword ptr ss:[ebp+8]                                                    |
00C996B7                                                  | 8B00                                  | mov eax,dword ptr ds:[eax]                                                      |
00C996B9                                                  | A1 F0292101                           | mov eax,dword ptr ds:[12129F0]                                                  |
00C996BE                                                  | A3 A0222001                           | mov dword ptr ds:[12022A0],eax                                                  |
00C996C3                                                  | C705 A4222001 EF2A1826                | mov dword ptr ds:[12022A4],26182AEF                                             |
00C996CD                                                  | 892D A8222001                         | mov dword ptr ds:[12022A8],ebp                                                  |
00C996D3                                                  | 68 A0222001                           | push cnc3game.12022A0                                                           |
00C996D8                                                  | E8 63B80A00                           | call cnc3game.D44F40                                                            |
00C996DD                                                  | C705 A0222001 00000000                | mov dword ptr ds:[12022A0],0                                                    |
00C996E7                                                  | C705 A4222001 00000000                | mov dword ptr ds:[12022A4],0                                                    |
00C996F1                                                  | C705 A8222001 00000000                | mov dword ptr ds:[12022A8],0                                                    |


76FFA6BA <ntdll.sub_76FFA6BA>                             | 8BFF                                  | mov edi,edi                                                                     |
76FFA6BC                                                  | 55                                    | push ebp                                                                        |
76FFA6BD                                                  | 8BEC                                  | mov ebp,esp                                                                     |
76FFA6BF                                                  | FF75 0C                               | push dword ptr ss:[ebp+C]                                                       |
76FFA6C2                                                  | 52                                    | push edx                                                                        | edx:RtlInterlockedCompareExchange64+210
76FFA6C3                                                  | 64:FF35 00000000                      | push dword ptr fs:[0]                                                           |
76FFA6CA                                                  | 64:8925 00000000                      | mov dword ptr fs:[0],esp                                                        |
76FFA6D1                                                  | FF75 14                               | push dword ptr ss:[ebp+14]                                                      |
76FFA6D4                                                  | FF75 10                               | push dword ptr ss:[ebp+10]                                                      |
76FFA6D7                                                  | FF75 0C                               | push dword ptr ss:[ebp+C]                                                       |
76FFA6DA                                                  | FF75 08                               | push dword ptr ss:[ebp+8]                                                       |
76FFA6DD                                                  | 8B4D 18                               | mov ecx,dword ptr ss:[ebp+18]                                                   | ecx:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+35417A, [ebp+18]:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+35417A
76FFA6E0                                                  | FFD1                                  | call ecx      <----- here's where it calls the handler in NTDLL                                                                    | ecx:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+35417A
76FFA6E2                                                  | 64:8B25 00000000                      | mov esp,dword ptr fs:[0]                                                        |
76FFA6E9                                                  | 64:8F05 00000000                      | pop dword ptr fs:[0]                                                            |
76FFA6F0                                                  | 8BE5                                  | mov esp,ebp                                                                     |
76FFA6F2                                                  | 5D                                    | pop ebp                                                                         |
76FFA6F3                                                  | C2 1400                               | ret 14           


00DDD75A                                                  | FC                                    | cld                                                                             |
00DDD75B                                                  | 8B5D 0C                               | mov ebx,dword ptr ss:[ebp+C]                                                    |
00DDD75E                                                  | 8B45 08                               | mov eax,dword ptr ss:[ebp+8]                                                    |
00DDD761                                                  | F740 04 06000000                      | test dword ptr ds:[eax+4],6                                                     |
00DDD768                                                  | 0F85 AB000000                         | jne cnc3game.DDD819               


Similar HW breakpoint detection routine
00C97E19                                                  | C786 CBD9E8F7 37CFBA00                | mov dword ptr ds:[esi-8172635],cnc3game.BACF37                                  |
00C97E23                                                  | C786 CFD9E8F7 4CCFC200                | mov dword ptr ds:[esi-8172631],cnc3game.C2CF4C                                  |
00C97E2D                                                  | C786 D3D9E8F7 63CFBF00                | mov dword ptr ds:[esi-817262D],cnc3game.BFCF63                                  |
00C97E37                                                  | C786 D7D9E8F7 7ACFBE00                | mov dword ptr ds:[esi-8172629],cnc3game.BECF7A                                  |
00C97E41                                                  | 8B3424                                | mov esi,dword ptr ss:[esp]                                                      |
00C97E44                                                  | 8D6424 04                             | lea esp,dword ptr ss:[esp+4]                                                    | [esp+04]:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+35417A
00C97E48                                                  | 0F0B                                  | ud2                                                                             |                                              |                                                               |
...
00C97E7E                                                  | 8137 BEBAAD1B                         | xor dword ptr ds:[edi],1BADBABE                                                 | edi:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+993286

KiUserExceptionDispatcher

IOCTL_DISK_PERFORMANCE  ---> disabling this might stop geometry!

does do 2 hw bpt checks before doing any cd check


00C97EA4                                                  | 0F21B5                                | mov ebp,dr6                                                                     |
00C97EA7                                                  | EB 03                                 | jmp cnc3game.C97EAC                                                             |
00C97EA9                                                  | 0F21B5                                | mov ebp,dr6                                                                     |
00C97EAC                                                  | 8137 1D133200                         | xor dword ptr ds:[edi],32131D                                                   | edi:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+993286
00C97EB2                                                  | 33ED                                  | xor ebp,ebp                                                                     |
00C97EB4                                                  | 74 02                                 | je cnc3game.C97EB8                                                              |
00C97EB6                                                  | E9 FF33ED74                           | jmp advapi32.75B6B2BA                                                           |
End of 2nd HWBP check


-----------------
Version 1.0

// 1
0102D5A9                                                  | 8BC8                                  | mov ecx,eax                                       |
0102D5AB                                                  | E8 60B5DCFF                           | call cnc3game.DF8B10                              |
0102D5B0                                                  | 83E0 1F                               | and eax,1F                                        |
0102D5B3                                                  | 3C 1F                                 | cmp al,1F                                         |  1f
0102D5B5                                                  | 9C                                    | pushfd                                            |
0102D5B6                                                  | 9C                                    | pushfd                                            |
0102D5B7                                                  | 83EC 1C                               | sub esp,1C                                        |

// 2
0101CCCE                                                  | 33DB                                  | xor ebx,ebx                                       |
0101CCD0                                                  | F9                                    | stc                                               |
0101CCD1                                                  | 83D3 00                               | adc ebx,0                                         |
0101CCD4                                                  | 8498 C0070000                         | test byte ptr ds:[eax+7C0],bl                     |  // 9
0101CCDA                                                  | 895D FC                               | mov dword ptr ss:[ebp-4],ebx                      |
0101CCDD                                                  | B9 D9D7F2FF                           | mov ecx,FFF2D7D9                                  |
0101CCE2                                                  | 90                                    | nop                                               |
0101CCE3                                                  | 8D8C29 E3270D00                       | lea ecx,dword ptr ds:[ecx+ebp+D27E3]              |
0101CCEA                                                  | 9C                                    | pushfd                                            |

// 3
0102EC3A                                                  | EB F5                                 | jmp cnc3game.102EC31                              |
0102EC3C                                                  | 9D                                    | popfd                                             |
0102EC3D                                                  | 80BF F2070000 00                      | cmp byte ptr ds:[edi+7F2],0                       |
0102EC44                                                  | 9C                                    | pushfd                                            |
0102EC45                                                  | 68 96350000                           | push 3596                                         |
0102EC4A                                                  | 75 12                                 | jne cnc3game.102EC5E                              |
0102EC4C                                                  | 810424 84B60254                       | add dword ptr ss:[esp],5402B684                   |
0102EC53                                                  | 90                                    | nop                                               |



-----------------
Geometry
3?
0103DAAD                                                  | DD05 D0181A01                         | fld qword ptr ds:[11A18D0]                        |
0103DAB3                                                  | DC25 D8181A01                         | fsub qword ptr ds:[11A18D8]                       |
0103DAB9                                                  | DC0D 3CBD3701                         | fmul qword ptr ds:[137BD3C]                       |
0103DABF                                                  | DC1D 50A53501                         | fcomp qword ptr ds:[135A550]                      |
0103DAC5                                                  | DFE0                                  | fnstsw ax                                         |
0103DAC7                                                  | F6C4 05                               | test ah,5                                         |

0103DBEA                                                  | DD05 D0181A01                         | fld qword ptr ds:[11A18D0]                        |
0103DBF0                                                  | DC25 D8181A01                         | fsub qword ptr ds:[11A18D8]                       |
0103DBF6                                                  | DC0D 3CBD3701                         | fmul qword ptr ds:[137BD3C]                       |
0103DBFC                                                  | DC1D 50A53501                         | fcomp qword ptr ds:[135A550]                      |
0103DC02                                                  | DFE0                                  | fnstsw ax                                         |
0103DC04                                                  | F6C4 05                               | test ah,5                                         |

01052470                                                  | DD05 D0181A01                         | fld qword ptr ds:[11A18D0]                        |
01052476                                                  | DC25 D8181A01                         | fsub qword ptr ds:[11A18D8]                       |
0105247C                                                  | DC0D 58A53501                         | fmul qword ptr ds:[135A558]                       |
01052482                                                  | DC1D 50A53501                         | fcomp qword ptr ds:[135A550]                      |
01052488                                                  | DFE0                                  | fnstsw ax                                         |
0105248A                                                  | F6C4 05                               | test ah,5                                         |

01058BC5                                                  | DD05 D0181A01                         | fld qword ptr ds:[11A18D0]                        |
01058BCB                                                  | BE E0AE2401                           | mov esi,cnc3game.124AEE0                          |
01058BD0                                                  | DC25 D8181A01                         | fsub qword ptr ds:[11A18D8]                       |
01058BD6                                                  | DC0D 8C203801                         | fmul qword ptr ds:[138208C]                       |
01058BDC                                                  | DC1D 50A53501                         | fcomp qword ptr ds:[135A550]                      |
01058BE2                                                  | DFE0                                  | fnstsw ax                                         |
01058BE4                                                  | F6C4 05                               | test ah,5                                         |

-----

01058DA8                                                  | DD05 D0181A01                         | fld qword ptr ds:[11A18D0]        0.6                |   <---- First one !!!
01058DAE                                                  | BE E0AE2401                           | mov esi,cnc3game.124AEE0                          |
01058DB3                                                  | DC25 D8181A01                         | fsub qword ptr ds:[11A18D8]       0.4                |
01058DB9                                                  | DC0D 8C203801                         | fmul qword ptr ds:[138208C]       100   = 19.9999             |
01058DBF                                                  | DC1D 50A53501                         | fcomp qword ptr ds:[135A550]                      |
01058DC5                                                  | DFE0                                  | fnstsw ax                                         |
01058DC7                                                  | F6C4 05                               | test ah,5                                         |

2??
0105ACC7                                                  | DD05 D0181A01                         | fld qword ptr ds:[11A18D0]                        |
0105ACCD                                                  | DC25 D8181A01                         | fsub qword ptr ds:[11A18D8]                       |
0105ACD3                                                  | DC0D 3CBD3701                         | fmul qword ptr ds:[137BD3C]                       |
0105ACD9                                                  | DC1D 50A53501                         | fcomp qword ptr ds:[135A550]                      |
0105ACDF                                                  | DFE0                                  | fnstsw ax                                         |
0105ACE1                                                  | F6C4 05                               | test ah,5                                         |
ah should be = 0

Make the sub 0 and it should work


Geometry 2???
0105ACCD                                                  | DC25 D8181A01                         | fsub qword ptr ds:[11A18D8]                       |
0105ACD3                                                  | DC0D 3CBD3701                         | fmul qword ptr ds:[137BD3C]      -32                 |
0105ACD9                                                  | DC1D 50A53501                         | fcomp qword ptr ds:[135A550]                      |
0105ACDF                                                  | DFE0                                  | fnstsw ax                                         |
0105ACE1                                                  | F6C4 05                               | test ah,5                                         |

Geometry 3
0103DAAD                                                  | DD05 D0181A01                         | fld qword ptr ds:[11A18D0]                        |
0103DAB3                                                  | DC25 D8181A01                         | fsub qword ptr ds:[11A18D8]                       |
0103DAB9                                                  | DC0D 3CBD3701                         | fmul qword ptr ds:[137BD3C]      -32                 |
0103DABF                                                  | DC1D 50A53501                         | fcomp qword ptr ds:[135A550]                      |
0103DAC5                                                  | DFE0                                  | fnstsw ax                                         |
0103DAC7                                                  | F6C4 05                               | test ah,5                                         |

---------------------------------------------------------------------------------------------------------------------------
Prototype - drm_dyndata_7390006   07.39.0006

in Stext
searched for 83E0 1F 3C 1F - finds 3

Address=00C12B5A Disassembly=and eax,1F
Address=00C12C56 Disassembly=and eax,1F
Address=00C133DF Disassembly=and eax,1F

3rd one is the one it hits on:

// 1
00C133DA                                                  | E8 5C81AFFF                           | call <prototypef.sub_70B53B>                      |
00C133DF                                                  | 83E0 1F                               | and eax,1F                                        |
00C133E2                                                  | 3C 1F                                 | cmp al,1F                                         |
00C133E4                                                  | 9C                                    | pushfd                                            |
00C133E5                                                  | 68 74130000                           | push 1374                                         |

// 2 - Searched for 8498 C0070000   - 1 instance
00C034B8                                                  | 8B8428 D5000000                       | mov eax,dword ptr ds:[eax+ebp+D5]                 |
00C034BF                                                  | 33DB                                  | xor ebx,ebx                                       |
00C034C1                                                  | 83C3 01                               | add ebx,1                                         |
00C034C4                                                  | 8498 C0070000                         | test byte ptr ds:[eax+7C0],bl         // was already 9!            |
00C034CA                                                  | 895D FC                               | mov dword ptr ss:[ebp-4],ebx                      |
00C034CD                                                  | B9 97FFFFFF                           | mov ecx,FFFFFF97                                  |
00C034D2                                                  | 8D4C29 25                             | lea ecx,dword ptr ds:[ecx+ebp+25]                 |

// Looking for 3 80BF F2070000 00 - did not find anything. So for this version looks like the 8.0 search needs to be done:
80 78 02 00 CMP BYTE PTR DS:[EAX+2],0. Found 3:
Address=0085CA88 Disassembly=cmp byte ptr ds:[eax+2],0
Address=00C14B07 Disassembly=cmp byte ptr ds:[eax+2],0
Address=00C14FA1 Disassembly=cmp byte ptr ds:[eax+2],0
^ 3rd one gets hit:
00C14F9F                                                  | 90                                    | nop                                               |
00C14FA0                                                  | 58                                    | pop eax                                           |
00C14FA1                                                  | 8078 02 00                            | cmp byte ptr ds:[eax+2],0          <--- make 01               |
00C14FA5                                                  | 9C                                    | pushfd                                            |
00C14FA6                                                  | 68 86310000                           | push 3186                                         |
00C14FAB                                                  | 75 12                                 | jne prototypef.C14FBF                             |



// 2FIX : 803D ???????? 00 9C 68 ?? ?? ?? ?? 76 - Found 2 
Address=00C34916 Disassembly=cmp byte ptr ds:[EBDF21],0   <---- Gets hit here
Address=00C3BD05 Disassembly=cmp byte ptr ds:[EBDF22],0   

00C34912                                                  | 9D                                    | popfd                                             |
00C34913                                                  | EB F5                                 | jmp prototypef.C3490A                             |
00C34915                                                  | 9D                                    | popfd                                             |
00C34916                                                  | 803D 21DFEB00 00                      | cmp byte ptr ds:[EBDF21],0                        |
00C3491D                                                  | 9C                                    | pushfd                                            |
00C3491E                                                  | 68 CD2D0000                           | push 2DCD                                         |
00C34923                                                  | 76 13                                 | jbe <prototypef.sub_C34938>                       |
00C34925 <prototypef.sub_C34925>                          | 810424 341BC3B6                       | add dword ptr ss:[esp],B6C31B34                   |
00C3492C                                                  | 8D3F                                  | lea edi,dword ptr ds:[edi]                        |
00C3492E                                                  | 810424 C200004A                       | add dword ptr ss:[esp],4A0000C2                   |

// Geometry - search for:

DC25 ???????? DC0D ???????? DC1D ???????? DFE0 F6C4 05

Address=00C28999 Disassembly=fsub qword ptr ds:[DBFCD0]  3
Address=00C28A07 Disassembly=fsub qword ptr ds:[DBFCD0]
Address=00C42DCE Disassembly=fsub qword ptr ds:[DBFCD0]
Address=00C4BBE6 Disassembly=fsub qword ptr ds:[DBFCD0]  1 
Address=00C4E10D Disassembly=fsub qword ptr ds:[DBFCD0]  2 

2nd for last has the esi mov in the middle - going to assume that's the first one!

00C4BBDB                                                  | DD05 687CDB00                         | fld qword ptr ds:[DB7C68]                         |
00C4BBE1                                                  | BE 94DFEB00                           | mov esi,prototypef.EBDF94                         |
00C4BBE6                                                  | DC25 D0FCDB00                         | fsub qword ptr ds:[DBFCD0]                        |
00C4BBEC                                                  | DC0D 102DDA00                         | fmul qword ptr ds:[DA2D10]                        |
00C4BBF2                                                  | DC1D 38E1D500                         | fcomp qword ptr ds:[D5E138]                       |
00C4BBF8 <prototypef.sub_C4BBF8>                          | DFE0                                  | fnstsw ax                                         |
00C4BBFA                                                  | F6C4 05                               | test ah,5                                         |

it was!!! Maybe last is the next one - yep!

00C4E107                                                  | DD05 687CDB00                         | fld qword ptr ds:[DB7C68]                         |
00C4E10D                                                  | DC25 D0FCDB00                         | fsub qword ptr ds:[DBFCD0]                        |
00C4E113                                                  | DC0D FCB1D900                         | fmul qword ptr ds:[D9B1FC]                        |
00C4E119                                                  | DC1D 38E1D500                         | fcomp qword ptr ds:[D5E138]                       |
00C4E11F                                                  | DFE0                                  | fnstsw ax                                         |
00C4E121                                                  | F6C4 05                               | test ah,5                                         |

First one should be 3rd check - it was!!!

----------------------------------------------------------------------------------------------------
Look at CRC checks:
010BC257                               | 8B7424 18                             | mov esi,dword ptr ss:[esp+18]                     | [esp+18]:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+776E7E
010BC25B                               | 90                                    | nop                                               |
010BC25C                               | 8B36                                  | mov esi,dword ptr ds:[esi]                        |
010BC25E                               | 33FE                                  | xor edi,esi                                       | edi:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+40657F
010BC260                               | 834424 18 04                          | add dword ptr ss:[esp+18],4                       | [esp+18]:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+776E7E
010BC265                               | 8D00                                  | lea eax,dword ptr ds:[eax]                        |
010BC267                               | 66:FF4C24 14                          | dec word ptr ss:[esp+14]                          |
010BC26C                               | 75 E5                                 | jne cnc3game.10BC253        <----  CRC loop                     |
010BC26E                               | 8BF7                                  | mov esi,edi           <---- EDI gets  D4BAB5                           | edi:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+40657F
010BC270                               | 90                                    | nop                                               |
010BC271                               | 8B7C24 10                             | mov edi,dword ptr ss:[esp+10]                     | edi:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+40657F
010BC275                               | 83C4 1C                               | add esp,1C                                        |
010BC278                               | 9D                                    | popfd                                             |
010BC279                               | 90                                    | nop                                               |
010BC27A                               | 90                                    | nop                                               |
010BC27B                               | 9C                                    | pushfd                                            |
010BC27C                               | 81F6 B5BAD400                         | xor esi,cnc3game.D4BAB5   <----- CRC Check value           ESI should turn 0 if all good
010BC282                               | C1E7 00                               | shl edi,0                                         |
010BC285                               | 9D                                    | popfd                                             |
010BC286                               | 90                                    | nop                                               |
010BC287                               | 873424                                | xchg dword ptr ss:[esp],esi                       |
010BC28A                               | B9 6D6EF7FF                           | mov ecx,FFF76E6D                                  |
010BC28F                               | 8D8C29 37910800                       | lea ecx,dword ptr ds:[ecx+ebp+89137]              |
010BC296                               | E8 1ABCC2FF                           | call cnc3game.CE7EB5                              |
010BC29B                               | 84DB                                  | test bl,bl                       <-------- First check we might want to change                 |
010BC29D                               | 9C                                    | pushfd                                            |
010BC29E                               | 68 9D180000                           | push 189D                                         |
010BC2A3                               | 74 10                                 | je cnc3game.10BC2B5                               |
010BC2A5                               | 810424 E7D03000                       | add dword ptr ss:[esp],30D0E7                     |
010BC2AC                               | 810424 C3D9DA00                       | add dword ptr ss:[esp],cnc3game.DAD9C3            |
...... next CRC check:
010BC2DB                               | 33C0                                  | xor eax,eax                                       |
010BC2DD                               | 90                                    | nop                                               |
010BC2DE                               | 8B7424 10                             | mov esi,dword ptr ss:[esp+10]                     | [esp+10]:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+776D6E
010BC2E2                               | C1E5 00                               | shl ebp,0                                         |
010BC2E5                               | 8B36                                  | mov esi,dword ptr ds:[esi]                        |
010BC2E7                               | 56                                    | push esi                                          |
010BC2E8                               | 5E                                    | pop esi                                           |
010BC2E9                               | 33C6                                  | xor eax,esi                                       |
010BC2EB                               | EB 00                                 | jmp cnc3game.10BC2ED                              |
010BC2ED                               | 834424 10 04                          | add dword ptr ss:[esp+10],4                       | [esp+10]:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+776D6E
010BC2F2                               | EB 00                                 | jmp cnc3game.10BC2F4                              |
010BC2F4                               | 66:FF4C24 0C                          | dec word ptr ss:[esp+C]                           |
010BC2F9                               | 75 E2                                 | jne cnc3game.10BC2DD                              |
010BC2FB                               | 50                                    | push eax           <-----       00000BA4 C
010BC2FC                               | 16                                    | push ss                                           |
010BC2FD                               | 0FACD3 00                             | shrd ebx,edx,0                                    |
010BC301                               | 17                                    | pop ss                                            |
010BC302                               | 9C                                    | pushfd                                            |
010BC303                               | 8B0424                                | mov eax,dword ptr ss:[esp]                        | [esp]:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+3A299D
010BC306                               | F6C4 01                               | test ah,1                                         |

....
010BC31A                               | 90                                    | nop                                               |
010BC31B                               | 2D A40B0000                           | sub eax,BA4                                       |
010BC320                               | 76 05                                 | jbe cnc3game.10BC327                              |


----
010B6FCE                               | 83E0 1F                               | and eax,1F                                        |
010B6FD1                               | 3C 1F                                 | cmp al,1F                                         | // 1
010B6FD3                               | 9C                                    | pushfd                                            |
010B6FD4                               | 9C                                    | pushfd                                            |
010B6FD5                               | 83EC 24                               | sub esp,24                                        |
010B6FD8                               | C74424 20 BBB55C72                    | mov dword ptr ss:[esp+20],725CB5BB                |
010B6FE0                               | C74424 1C 44000000                    | mov dword ptr ss:[esp+1C],44                      | 44:'D'
010B6FE8                               | 895424 18                             | mov dword ptr ss:[esp+18],edx                     |
010B6FEC                               | BA 546F0B01                           | mov edx,cnc3game.10B6F54                          | edx:"J\f5y(M", 10B6F54:",$C"
010B6FF1                               | C14C24 20 00                          | ror dword ptr ss:[esp+20],0                       |
010B6FF6                               | 90                                    | nop                                               |
010B6FF7                               | 897424 14                             | mov dword ptr ss:[esp+14],esi                     |
010B6FFB                               | 0FACD2 00                             | shrd edx,edx,0                                    |
010B6FFF                               | 8B32                                  | mov esi,dword ptr ds:[edx]                        | edx:"J\f5y(M"
010B7001                               | 87C9                                  | xchg ecx,ecx                                      |
010B7003                               | 017424 20                             | add dword ptr ss:[esp+20],esi                     |
010B7007                               | 83C2 04                               | add edx,4                                         | edx:"J\f5y(M"
010B700A                               | 66:FF4C24 1C                          | dec word ptr ss:[esp+1C]                          |
010B700F                               | 75 EA                                 | jne cnc3game.10B6FFB                              |
010B7011                               | 804C24 20 01                          | or byte ptr ss:[esp+20],1                         |  <---- 2D1F

------------------------------------
Looking for the Emulation Conflict check:

010EC23E                               | 8D6424 FC                             | lea esp,dword ptr ss:[esp-4]                      |
010EC242                               | 893424                                | mov dword ptr ss:[esp],esi                        | esi:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+98C8FA
010EC245                               | 8BCE                                  | mov ecx,esi                                       | ecx:"7001F6819786B3A7557F9E4FAEE8C8858682E4BF73C73A1B3F1C2F381477B41922D35B0CD602818C6C9B61D59F0D1CF7AFD52975E0D6B02ABBA4A5618C630DFA376EAD4A8E3CE87FA14746FB396DD64AD0D8F3D367FB25C31743CBC6FBF08F035847", esi:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+98C8FA
010EC247                               | E8 14D9D2FF                           | call cnc3game.E19B60                              |

01483238 ?


Address=00CE4AAB Module/Label/Exception=<cnc3game.dat.sub_CE4AAB> State=Disabled Disassembly=push ebp Hits=0 Summary=// ANY_INTEREST func, execute()
Address=0102D00D Module/Label/Exception=cnc3game.dat State=Disabled Disassembly=push ebp Hits=0 Summary=// 0102D00D, execute()
Address=010A615E Module/Label/Exception=cnc3game.dat State=Disabled Disassembly=test byte ptr ds:[eax+7C0],bl Hits=1 Summary=// 2, execute()
Address=010B6FD1 Module/Label/Exception=cnc3game.dat State=Disabled Disassembly=cmp al,1F Hits=1 Summary=// 1, execute()
Address=010B6FD8 Module/Label/Exception=cnc3game.dat State=Disabled Disassembly=mov dword ptr ss:[esp+20],725CB5BB Hits=0 Summary=execute()
Address=010B7011 Module/Label/Exception=cnc3game.dat State=Disabled Disassembly=or byte ptr ss:[esp+20],1 Hits=0 Summary=execute()
Address=010B86A1 Module/Label/Exception=cnc3game.dat State=Disabled Disassembly=cmp byte ptr ds:[edi+7F2],0 Hits=1 Summary=// 3, execute()
Address=010BC29B Module/Label/Exception=cnc3game.dat State=Disabled Disassembly=test bl,bl Hits=1 Summary=// 0, execute() 
Address=010CD17E Module/Label/Exception=cnc3game.dat State=Disabled Disassembly=test ah,5 Hits=0 Summary=// Geometry 3, execute()
Address=010D2ABC Module/Label/Exception=cnc3game.dat State=Disabled Disassembly=cmp al,F Hits=0 Summary=// AND 0xF, execute() 
Address=010DF7A9 Module/Label/Exception=cnc3game.dat State=Disabled Disassembly=cmp byte ptr ds:[12D1DBF],0 Hits=1 Summary=// 2FIX, execute()
Address=010E35C7 Module/Label/Exception=cnc3game.dat  State=Disabled Disassembly=test ah,5  Hits=0 Summary=execute() 
Address=010EAFB2 Module/Label/Exception=cnc3game.dat State=Disabled Disassembly=fld qword ptr ds:[11EDC78] Hits=3 Summary=// Geometry 1, execute()
Address=010EC247 Module/Label/Exception=cnc3game.dat State=Disabled Disassembly=call <cnc3game.sub_E19B60> Hits=0 Summary=execute()
Address=010ED32A Module/Label/Exception=cnc3game.dat State=Disabled Disassembly=test ah,5 Hits=0 Summary=// Geometry 2, execute()
Address=010F0A79 Module/Label/Exception=<cnc3game.dat.sub_10F0A79> State=Disabled Disassembly=push ebp Hits=0 Summary=// Possible start of Performance check?, execute()
Address=010F1035 Module/Label/Exception=cnc3game.dat State=Disabled  Disassembly=call dword ptr ds:[<DeviceIoControl>] Hits=0 Summary=// Conflict with Emulation Software, execute()

010DF140                               | DD1D 78DC1E01                         | fstp qword ptr ds:[11EDC78]                       |
?? Stores the check?

// Crashing here:
00CAB7ED ???
00CAB7E9                               | FF5424 F8                             | call dword ptr ss:[esp-8]                         |
00CAB7ED                               | C686 83000000 00                      | mov byte ptr ds:[esi+83],0                        | esi+83:private: static void __cdecl Debug::PostStaticInit(void)+F68DB

---------------------------------------------
-99 is 011EDC78  00 00 00 80 14 AE EF BF 

it pushes the eflags (0x246)
010EB1D0                               | 9C                                    | pushfd                                            |
010EB1D1                               | 68 8F1E0000                           | push 1E8F                                         |
010EB1D6                               | 76 15                                 | jbe cnc3game.10EB1ED                              |
^ it then JBE's here later on


----------------------------------------------
CRC Check on Geometry 1:

1. 
010EAE9C                               | C74424 18 E9378964                    | mov dword ptr ss:[esp+18],648937E9                |
010EAEA4                               | C74424 14 65000100                    | mov dword ptr ss:[esp+14],10065                   |
010EAEAC                               | 894C24 10                             | mov dword ptr ss:[esp+10],ecx                     | [esp+10]:"7001DB1AF276CDD57A2F73F3E8E8D35FDC6A137E810E97F6D2E3CFA6B69CB12E56210CA0F5F0B54361A9BB5DF68D687B710E", ecx:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+7A5AC6
010EAEB0                               | B9 68AE0E01                           | mov ecx,cnc3game.10EAE68                          | ecx:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+7A5AC6
010EAEB5                               | C14C24 18 00                          | ror dword ptr ss:[esp+18],0                       |
010EAEBA                               | 0FA4C5 00                             | shld ebp,eax,0                                    |
010EAEBE                               | 895C24 0C                             | mov dword ptr ss:[esp+C],ebx                      |
010EAEC2                               | 90                                    | nop                                               |
010EAEC3                               | 8B19                                  | mov ebx,dword ptr ds:[ecx]                        | ecx:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+7A5AC6
010EAEC5                               | 90                                    | nop                                               |
010EAEC6                               | 015C24 18                             | add dword ptr ss:[esp+18],ebx                     |
010EAECA                               | 90                                    | nop                                               |
010EAECB                               | 83C1 04                               | add ecx,4                                         | ecx:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+7A5AC6
010EAECE                               | 0FA4CD 00                             | shld ebp,ecx,0                                    |
010EAED2                               | 66:FF4C24 14                          | dec word ptr ss:[esp+14]                          |
010EAED7                               | 75 E9                                 | jne cnc3game.10EAEC2                              |
010EAED9                               | 90                                    | nop                                               |
010EAEDA                               | 50                                    | push eax                                          | eax:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+39F3CA
010EAEDB                               | 16                                    | push ss                                           |
010EAEDC                               | 17                                    | pop ss                                            |
010EAEDD                               | C1EF 00                               | shr edi,0                                         |
010EAEE0                               | 9C                                    | pushfd                                            |
010EAEE1                               | 8B0424                                | mov eax,dword ptr ss:[esp]                        | eax:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+39F3CA, [esp]:"7001DB1AF276CDD57A2F73F3E8E8D35FDC6A137E810E97F6D2E3CFA6B69CB12E56210CA0F5F0B54361A9BB5DF68D687B710E"
010EAEE4                               | F6C4 01                               | test ah,1                                         |
010EAEE7                               | 51                                    | push ecx                                          | ecx:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+7A5AC6
010EAEE8                               | 59                                    | pop ecx                                           | ecx:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+7A5AC6
010EAEE9                               | 74 05                                 | je cnc3game.10EAEF0                               |
010EAEEB                               | B9 BE070000                           | mov ecx,7BE                                       | ecx:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+7A5AC6
010EAEF0                               | C1E6 00                               | shl esi,0                                         |
010EAEF3                               | 33C0                                  | xor eax,eax                                       | eax:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+39F3CA
010EAEF5                               | 90                                    | nop                                               |
010EAEF6                               | 74 02                                 | je cnc3game.10EAEFA                               |
010EAEF8                               | 0FA59D 58C1FD00                       | shld dword ptr ss:[ebp+FDC158],ebx,cl             |
010EAEFF                               | 806424 18 FE                          | and byte ptr ss:[esp+18],FE                       |  <---- takes one way away from FA7 CRC
010EAF04                               | 817C24 18 A60F0000                    | cmp dword ptr ss:[esp+18],FA6                     |
010EAF0C                               | 90                                    | nop                                               |
010EAF0D                               | 76 04                                 | jbe cnc3game.10EAF13                              |   <---- JMP 

010EAFD1                               | 82FC 05                               | cmp ah,5                                          | // Geometry 1

010EB04B                               | 39FF                                  | cmp edi,edi                                       |

ars:
00C48000                               | C3                                    | ret                                               |
011D3FFE                               | 0000                                  | add byte ptr ds:[eax],al                          |


First CRC we hit is 
00FA7396
CRC Check at: 00FA7396 location: 00FA7360 amount: 0051
ESI = 00817BB7

00FA7396 is checked by 

00FA6E8E                               | 83EC 18                               | sub esp,18                                        |
00FA6E91                               | C74424 14 0D755AC5                    | mov dword ptr ss:[esp+14],C55A750D                |
00FA6E99                               | C74424 10 C5040000                    | mov dword ptr ss:[esp+10],4C5                     |
00FA6EA1                               | 897C24 0C                             | mov dword ptr ss:[esp+C],edi                      | edi:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+661EAA
00FA6EA5                               | BF 5C6EFA00                           | mov edi,cnc3game.FA6E5C                           | edi:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+661EAA
00FA6EAA                               | C14C24 14 18                          | ror dword ptr ss:[esp+14],18                      | 0179633C  C5 0D 75 5A 46 50 09 01 E0 69 FA 00 78 73 79 01  Å.uZFP..àiú.xsy.  
00FA6EAF                               | C1FE 00                               | sar esi,0                                         |
00FA6EB2                               | 897424 08                             | mov dword ptr ss:[esp+8],esi                      |
00FA6EB6                               | 8B37                                  | mov esi,dword ptr ds:[edi]                        | edi:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+661EAA
00FA6EB8                               | 017424 14                             | add dword ptr ss:[esp+14],esi                     |
00FA6EBC                               | 83C7 04                               | add edi,4                                         | edi:public: class AptCIH * __thiscall AptCIH::GetDisplayListNext(void) const+661EAA
00FA6EBF                               | 90                                    | nop                                               |
00FA6EC0                               | 66:FF4C24 10                          | dec word ptr ss:[esp+10]                          |
00FA6EC5                               | 75 EF                                 | jne cnc3game.FA6EB6                               |

00E1D5F0 -> problematic

00E1D5BD                               | 83EC 14                               | sub esp,14                                        |
00E1D5C0                               | C74424 10 9DBD2E49                    | mov dword ptr ss:[esp+10],492EBD9D                |
00E1D5C8                               | C74424 0C 5F000200                    | mov dword ptr ss:[esp+C],2005F                    | 2005F:"????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????!\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????"
00E1D5D0                               | 894C24 08                             | mov dword ptr ss:[esp+8],ecx                      | ecx:NtCreateFile+C
00E1D5D4                               | B9 84D5E100                           | mov ecx,cnc3game.E1D584                           | ecx:NtCreateFile+C
00E1D5D9                               | 897C24 04                             | mov dword ptr ss:[esp+4],edi                      |
00E1D5DD                               | 894C24 10                             | mov dword ptr ss:[esp+10],ecx                     | ecx:NtCreateFile+C
00E1D5E1                               | 33C9                                  | xor ecx,ecx                                       | ecx:NtCreateFile+C
00E1D5E3                               | 8B7C24 10                             | mov edi,dword ptr ss:[esp+10]                     |
00E1D5E7                               | 8B3F                                  | mov edi,dword ptr ds:[edi]                        |
00E1D5E9                               | 33CF                                  | xor ecx,edi                                       | ecx:NtCreateFile+C
00E1D5EB                               | 834424 10 04                          | add dword ptr ss:[esp+10],4                       |
00E1D5F0                               | 66:FF4C24 0C                          | dec word ptr ss:[esp+C]                           |
00E1D5F5                               | C1E1 00                               | shl ecx,0                <----- nonsense param breaks it                         |
00E1D5F8                               | 75 E9                                 | jne cnc3game.E1D5E3                               |

-----------------------------------------------------------------------------------------------
Driv3r - 5.03.13

Address=008EE000 Size=000E8000 Page Information=".eurum"
^ some CD Checks

009735EF                               | A3 E86B9D00                           | mov dword ptr ds:[9D6BE8],eax                     |
009735F4                               | 68 00080000                           | push 800                                          |
009735F9                               | 68 A0F5AD00                           | push driv3r.ADF5A0                                |
009735FE                               | 68 40DAAD00                           | push driv3r.ADDA40                                |
00973603                               | E8 28550500                           | call driv3r.9C8B30                                |
00973608                               | 83C4 0C                               | add esp,C                                         |
0097360B                               | 8B0D 5865AC00                         | mov ecx,dword ptr ds:[AC6558]                     | ecx:NtUserPeekMessage+C
00973611                               | 80CD 40                               | or ch,40                                          |
00973614                               | 890D 5865AC00                         | mov dword ptr ds:[AC6558],ecx                     | ecx:NtUserPeekMessage+C
0097361A                               | 833D F07AA000 00                      | cmp dword ptr ds:[A07AF0],0                       |
00973621                               | 74 30                                 | je driv3r.973653                                  |
00973623                               | 8B15 E07AAD00                         | mov edx,dword ptr ds:[AD7AE0]                     |
00973629                               | 83C2 61                               | add edx,61                                        |
0097362C                               | 52                                    | push edx                                          |
0097362D                               | 68 606B9D00                           | push driv3r.9D6B60                                | 9D6B60:"UKD_701100.001"
00973632                               | 68 000FA300                           | push driv3r.A30F00                                | A30F00:"7001CF466CF02D46F662603110104DA7B6C6336867C232D1959248244A2F98F3F15E{%s}1092F4B3FCE760591A34BF0274A030D603C06ED3947354B9{%c}0A768E9E18E469C7029286529DFDE967FC6E01241B13A1D7"
00973637                               | 68 008EAD00                           | push driv3r.AD8E00                                | AD8E00:"Please insert the DRIV3R disc"
0097363C                               | E8 7F590500                           | call driv3r.9C8FC0                                |

83C2 61 52 68
68 ???????? 68 ???????? 68 ???????? E8

00937D00                               | 85C9                                  | test ecx,ecx                                      |
00937D02                               | 75 E2                                 | jne driv3r.937CE6                                 |
00937D04                               | E8 A7960300                           | call driv3r.9713B0                                |
00937D09                               | E8 12D20300                           | call driv3r.974F20                                |
00937D0E                               | 833D 2C65AC00 00                      | cmp dword ptr ds:[AC652C],0                       |
00937D15                               | 0F84 C3000000                         | je driv3r.937DDE                                  |
00937D1B                               | C705 FC75AD00 00000000                | mov dword ptr ds:[AD75FC],0                       |
00937D25                               | EB 0F                                 | jmp driv3r.937D36                                 |
00937D27                               | 8B15 FC75AD00                         | mov edx,dword ptr ds:[AD75FC]                     |
00937D2D                               | 83C2 01                               | add edx,1                                         |

CRC Check:
009736B2                               | 8B0D A86B9D00                         | mov ecx,dword ptr ds:[9D6BA8]                     | 009D6BA8:"v37#"
009736B8                               | 3B0D 8CCBAD00                         | cmp ecx,dword ptr ds:[ADCB8C]                     | 00ADCB8C:"v37#"
009736BE                               | 0F85 A3000000                         | jne driv3r.973767                                 |

009736B0                            | EB CC                                 | jmp driv3r.97367E                                |
009736B2                            | 8B0D A86B9D00                         | mov ecx,dword ptr ds:[9D6BA8]                    | 009D6BA8:"v37#"
009736B8                            | 3B0D 8CCBAD00                         | cmp ecx,dword ptr ds:[ADCB8C]                    | 00ADCB8C:"/NYF"
009736BE                            | 0F85 A3000000                         | jne driv3r.973767                                |
009736C4                            | 68 A0F5AD00                           | push driv3r.ADF5A0                               |

EBCC????????????3B0D????????0F85????????68

EBCC????????????3B0D0????????F85????????68

00938098                               | 50                                    | push eax                                          |
00938099                               | 68 50B4AD00                           | push driv3r.ADB450                                |
0093809E                               | 68 20CCAD00                           | push driv3r.ADCC20                                |
009380A3                               | 8B0D E07AAD00                         | mov ecx,dword ptr ds:[AD7AE0]                     | ecx:NtUserCallMsgFilter+C
009380A9                               | 51                                    | push ecx                                          | ecx:NtUserCallMsgFilter+C
009380AA                               | E8 3173FBFF                           | call driv3r.8EF3E0                                |  <---- will moan about the time it took here


008EF6FF                               | 68 E007AE00                           | push driv3r.AE07E0                                |
008EF704                               | 68 60B5AD00                           | push driv3r.ADB560                                |
008EF709 <driv3r.sub_8EF709>           | 68 F407AE00                           | push driv3r.AE07F4                                |
008EF70E                               | 68 E07CAD00                           | push driv3r.AD7CE0                                |
008EF713                               | 68 E8C8AD00                           | push driv3r.ADC8E8                                |
008EF718                               | 6A 00                                 | push 0                                            |
008EF71A                               | 68 30B4AD00                           | push driv3r.ADB430                                |
008EF71F                               | 68 886B9D00                           | push driv3r.9D6B88                                |
008EF724                               | 8B0D A823A100                         | mov ecx,dword ptr ds:[A123A8]                     |
008EF72A                               | 8B11                                  | mov edx,dword ptr ds:[ecx]                        |
008EF72C                               | 52                                    | push edx                                          |
008EF72D                               | E8 5E860900                           | call driv3r.987D90                                |

https://github.com/elishacloud/Silent-Hill-2-Enhancements/issues/89

008F04FC                               | 8B85 78FEFFFF                         | mov eax,dword ptr ss:[ebp-188]                    |
008F0502                               | 83C0 1F                               | add eax,1F                                        |
008F0505                               | 3905 44B4AD00                         | cmp dword ptr ds:[ADB444],eax                     |

0098A808                               | 8B45 08                               | mov eax,dword ptr ss:[ebp+8]                      |
0098A80B                               | 50                                    | push eax                                          |
0098A80C                               | FF15 E456AE00                         | call dword ptr ds:[<DeviceIoControl>]             |
0098A812                               | 85C0                                  | test eax,eax                                      |
0098A814                               | 74 08                                 | je driv3r.98A81E                                  |
0098A816                               | 8A4D FC                               | mov cl,byte ptr ss:[ebp-4]                        |

0096A480                               | 50                                    | push eax                                          |
0096A481                               | 6A 0C                                 | push C                                            |
0096A483                               | 8D4D EC                               | lea ecx,dword ptr ss:[ebp-14]                     |
0096A486                               | 51                                    | push ecx                                          |
0096A487                               | 68 00142D00                           | push 2D1400                                       |
0096A48C                               | 8B55 08                               | mov edx,dword ptr ss:[ebp+8]                      |
0096A48F                               | 52                                    | push edx                                          |
0096A490                               | FF15 BCC4AD00                         | call dword ptr ds:[<&DeviceIoControl>]            |
0096A496                               | 8945 F8                               | mov dword ptr ss:[ebp-8],eax                      |
0096A499                               | 837D F8 00                            | cmp dword ptr ss:[ebp-8],0                        |
0096A49D                               | 74 1B                                 | je driv3r.96A4BA                                  |
0096A49F                               | 837D 0C 00                            | cmp dword ptr ss:[ebp+C],0                        |
0096A4A3                               | 74 15                                 | je driv3r.96A4BA                                  |
0096A4A5                               | 6A 28                                 | push 28                                           |
0096A4A7                               | 8D85 ECFDFFFF                         | lea eax,dword ptr ss:[ebp-214]                    |
0096A4AD                               | 50                                    | push eax                                          |

009698F9                               | E8 044E0400                           | call <driv3r.sub_9AE702>                          |
009698FE                               | 83C4 08                               | add esp,8                                         |
00969901                               | DD1D B07CAD00                         | fstp qword ptr ds:[AD7CB0]                        |   <---- it's -99 ! Make it 0 and it works ???!
00969907                               | E9 18000000                           | jmp driv3r.969924                                 |
0096990C                               | B8 774B6D47                           | mov eax,476D4B77                                  |

83C4 08  DD1D ???????? E9

00969924                               | E8 44B40200                           | call <driv3r.sub_994D6D>                          |
00969929                               | DC1D B07CAD00                         | fcomp qword ptr ds:[AD7CB0]                       |
0096992F                               | DFE0                                  | fnstsw ax                                         |
00969931                               | F6C4 41                               | test ah,41                                        |
00969934                               | 0F85 29010000                         | jne driv3r.969A63                                 |

.eurum
009698DB                               | E8 A0F0FFFF                           | call <driv3r.sub_968980>                          |
009698E0                               | 83C4 18                               | add esp,18                                        |
009698E3                               | 8B0D 30DAAD00                         | mov ecx,dword ptr ds:[ADDA30]                     | ecx:NtUserPeekMessage+C
009698E9                               | 890D 88C4AD00                         | mov dword ptr ds:[ADC488],ecx                     | ecx:NtUserPeekMessage+C
009698EF                               | 68 30DAAD00                           | push driv3r.ADDA30                                |
009698F4                               | 68 00D1AD00                           | push driv3r.ADD100                                |
009698F9                               | E8 044E0400                           | call <driv3r.sub_9AE702>                          |
009698FE                               | 83C4 08                               | add esp,8                                         |
00969901                               | DD1D B07CAD00                         | fstp qword ptr ds:[AD7CB0]                        |
00969907                               | E9 18000000                           | jmp driv3r.969924                                 |
0096990C                               | B8 774B6D47                           | mov eax,476D4B77                                  |
00969911                               | 0000                                  | add byte ptr ds:[eax],al                          |
00969913                               | 0000                                  | add byte ptr ds:[eax],al                          |
00969915                               | 1D 00000002                           | sbb eax,2000000                                   |
0096991A                               | 0000                                  | add byte ptr ds:[eax],al                          |
0096991C                               | 002427                                | add byte ptr ds:[edi],ah                          |
0096991F                               | 0000                                  | add byte ptr ds:[eax],al                          |
00969921                               | 2F                                    | das                                               |
00969922                               | FE                                    | ???                                               |
00969923                               | 5A                                    | pop edx                                           |

From PVD:
009735AB                               | 68 C8F5AD00                           | push driv3r.ADF5C8                                | ADF5C8:"DRIV3R                          " <--- actually our PVD
Which is then used:
009C9446                               | 8B4D 10                               | mov ecx,dword ptr ss:[ebp+10]                     |
009C9449                               | E3 26                                 | jecxz driv3r.9C9471                               |
009C944B                               | 8BD9                                  | mov ebx,ecx                                       |
009C944D                               | 8B7D 08                               | mov edi,dword ptr ss:[ebp+8]                      | [ebp+08]:"DRIV3R                          "
009C9450                               | 8BF7                                  | mov esi,edi                                       | esi:"DRIV3R                          ", edi:"RIV3R                          "
009C9452                               | 33C0                                  | xor eax,eax                                       |
009C9454                               | F2:AE                                 | repne scasb                                       |
009C9456                               | F7D9                                  | neg ecx                                           |
009C9458                               | 03CB                                  | add ecx,ebx                                       |
009C945A                               | 8BFE                                  | mov edi,esi                                       | edi:"RIV3R                          ", esi:"DRIV3R                          "
009C945C                               | 8B75 0C                               | mov esi,dword ptr ss:[ebp+C]                      | [ebp+0C]:"UKD_701100.001"
009C945F                               | F3:A6                                 | repe cmpsb                                        |
009C9461                               | 8A46 FF                               | mov al,byte ptr ds:[esi-1]                        | esi-01:" DRIV3R                          "
009C9464                               | 33C9                                  | xor ecx,ecx                                       |
009C9466                               | 3A47 FF                               | cmp al,byte ptr ds:[edi-1]                        | edi-01:"DRIV3R                          "
009C9469                               | 77 04                                 | ja driv3r.9C946F                                  |
009C946B                               | 74 04                                 | je driv3r.9C9471                                  |
009C946D                               | 49                                    | dec ecx                                           |

009735B0                               | E8 8B5E0500                           | call <driv3r.sub_9C9440>                          |
009735B5                               | 83C4 0C                               | add esp,C                                         |
009735B8                               | 85C0                                  | test eax,eax                                      | <--- tests the string compare (EAX = FF when matching?)
009735BA                               | 0F85 A8000000                         | jne driv3r.973668                                 | takes jmp

009C8B61                               | 72 29                                 | jb driv3r.9C8B8C                                  |
009C8B63                               | F3:A5                                 | rep movsd                                         |  <--- copying PVD here too
009C8B65                               | FF2495 788C9C00                       | jmp dword ptr ds:[edx*4+9C8C78]                   |
009C8B6C                               | 8BC7                                  | mov eax,edi                                       | eax:sub_ADFD89+17, edi:sub_ADDA2D+813
009C8B6E                               | BA 03000000                           | mov edx,3                                         |

00937FBA                               | 75 E2                                 | jne driv3r.937F9E                                 |
00937FBC                               | 68 00080000                           | push 800                                          |
00937FC1                               | 68 40DAAD00                           | push driv3r.ADDA40                                |    <---- where it copied the PVD to
00937FC6                               | 68 A0F5AD00                           | push driv3r.ADF5A0                                |    <---- these should match
00937FCB                               | E8 600B0900                           | call driv3r.9C8B30                                |
00937FD0                               | 83C4 0C                               | add esp,C                                         |
00937FD3                               | E8 38580300                           | call <driv3r.sub_96D810>                          |

Daemon tool's IOCTL_STORAGE_QUERY_PROPERTY
"28000000A700000005000100000000004C000000750000007E000000020000002400000000000000058000325B00000044697363536F6674344D4947475033334B524C2020202020312E302044697363536F667420344D4947475033334B524C002020202000000000000000000000000000000000312E300000000000000000"

00937D5C                               | C705 FC75AD00 00000000                | mov dword ptr ds:[AD75FC],0                       | DO WE EVEN GET HERE?

009736B2                               | 8B0D A86B9D00                         | mov ecx,dword ptr ds:[9D6BA8]                     | 009D6BA8:"v37#"  <--- right value 009D6BA8  76 33 37 23 00 00 00 00 00 00 00 00 00 00 00 00  v37#............  
009736B8                               | 3B0D 8CCBAD00                         | cmp ecx,dword ptr ds:[ADCB8C]                     | 00ADCB8C:"/NYF"  <--- wrong value 00ADCB8C  2F 4E 59 46 00 00 00 00 00 00 00 00 00 00 00 00  /NYF............  
009736BE                               | 0F85 A3000000                         | jne driv3r.973767                                 | Should this be taken - does when bad   <---- key jmp
8B0D ???????? 3B0D ???????? 0F85

00937FD3                               | E8 38580300                           | call <driv3r.sub_96D810>                          | WIll this call be ok (no when bad)

0096DA45                               | 3B0C85 A86B9D00                       | cmp ecx,dword ptr ds:[eax*4+9D6BA8]               | eax*4+9D6BA8:"v37#" <---- checking right value again?
0096DA4C                               | 75 02                                 | jne driv3r.96DA50                                 | Maybe IMPORTANT (not taken)

3B0C85 ???????? 75 02

0096DA38                               | 8B15 ACB4AD00                         | mov edx,dword ptr ds:[ADB4AC]                     |
0096DA3E                               | A1 FC75AD00                           | mov eax,dword ptr ds:[AD75FC]                     |
0096DA43                               | 8B0A                                  | mov ecx,dword ptr ds:[edx]                        |
0096DA45                               | 3B0C85 A86B9D00                       | cmp ecx,dword ptr ds:[eax*4+9D6BA8]               | eax*4+9D6BA8:"v37#"
0096DA4C                               | 75 02                                 | jne driv3r.96DA50                                 | Maybe IMPORTANT (not taken)
0096DA4E                               | EB 11                                 | jmp driv3r.96DA61                                 |

Can just nop those two JNE and the FSTP and it will run

----------------------------------------------------------------------------
Max Payne 2 - 4.85.04 v1.0
4.85.07 v1.01

0055B232                               | A1 749F6400                           | mov eax,dword ptr ds:[649F74]                     |
0055B237                               | 99                                    | cdq                                               |
0055B238                               | B9 05000000                           | mov ecx,5                                         |
0055B23D                               | F7F9                                  | idiv ecx                                          |
0055B23F                               | 8BCA                                  | mov ecx,edx                                       |
0055B241                               | B8 0C000000                           | mov eax,C                                         | 0C:'\f'
0055B246                               | 99                                    | cdq                                               |
0055B247                               | F7F9                                  | idiv ecx                                          |   <---- crashes here
0055B249                               | 8B15 48F46400                         | mov edx,dword ptr ds:[64F448]                     |
0055B24F                               | 0315 749F6400                         | add edx,dword ptr ds:[649F74]                     |
0055B255                               | 8A0A                                  | mov cl,byte ptr ds:[edx]                          |
0055B257                               | 02C8                                  | add cl,al                                         |
0055B259                               | 8B15 48F46400                         | mov edx,dword ptr ds:[64F448]                     |
0055B25F                               | 0315 749F6400                         | add edx,dword ptr ds:[649F74]                     |

Seems they like to call UpdateWindow ???
0055B1DA                               | FF15 84AF6400                         | call dword ptr ds:[<&UpdateWindow>]               |

Petite does cause an exception - maybe doesn't matter
00580C76                                                             | 8B45 08                               | mov eax,dword ptr ss:[ebp+8]                      | [ebp+08]:"C:\\Users\\Nick\\AppData\\Local\\Temp\\CmdLineExt03.dll"
00580C79                                                             | 50                                    | push eax                                          |
00580C7A                                                             | FF15 D86D6500                         | call dword ptr ds:[<LoadLibraryA>]                |
^
Called from:
00580BD3                                                             | E8 98000000                           | call maxpayne2.580C70                             |

https://support.microsoft.com/en-gb/topic/how-to-enable-structured-exception-handling-overwrite-protection-sehop-in-windows-operating-systems-8d4595f7-827f-72ee-8c34-fa8e0fe7b915
DisableExceptionChainValidation 
Computer\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\kernel
https://learn.microsoft.com/en-ie/answers/questions/2127814/changes-to-seh-on-windows-11-24h2-causing-problems

#define STATUS_INTEGER_DIVIDE_BY_ZERO    ((DWORD   )0xC0000094L)    


772AA6D7                                          | FF75 0C                               | push dword ptr ss:[ebp+C]                         |
772AA6DA                                          | FF75 08                               | push dword ptr ss:[ebp+8]                         |
772AA6DD                                          | 8B4D 18                               | mov ecx,dword ptr ss:[ebp+18]                     | ecx:RtlInterlockedCompareExchange64+210, [ebp+18]:RtlInterlockedCompareExchange64+210
772AA6E0                                          | FFD1                                  | call ecx          <---- handler call                                | ecx:RtlInterlockedCompareExchange64+210
772AA6E2                                          | 64:8B25 00000000                      | mov esp,dword ptr fs:[0]                          |
772AA6E9                                          | 64:8F05 00000000                      | pop dword ptr fs:[0]                              |
772AA6F0                                          | 8BE5                                  | mov esp,ebp                                       |

01372FA4                                          | 5A                                    | pop edx                                         | edx:&"PE"
01372FA5                                          | 59                                    | pop ecx                                         |
01372FA6                                          | 83C4 04                               | add esp,4                                       |
01372FA9                                          | FFE1                                  | jmp ecx                                         |
01372FAB <JMP.&memcmp>                            | FF25 8C303701                         | jmp dword ptr ds:[<&memcmp>]                    |
01372FB1 <JMP.&memcpy>                            | FF25 88303701                         | jmp dword ptr ds:[<&memcpy>]                    |
01372FB7 <JMP.&memset>                            | FF25 90303701                         | jmp dword ptr ds:[<&memset>]                    |


0055A0B0                                          | 55                                    | push ebp                                        |
0055A0B1                                          | 8BEC                                  | mov ebp,esp                                     |
0055A0B3                                          | B8 00400000                           | mov eax,4000                                    |
0055A0B8                                          | E8 53930300                           | call <maxpayne2.sub_593410>                     |
0055A0BD                                          | 53                                    | push ebx                                        |
0055A0BE                                          | 56                                    | push esi                                        |
0055A0BF                                          | 57                                    | push edi                                        | edi:EntryPoint
0055A0C0                                          | 8B45 08                               | mov eax,dword ptr ss:[ebp+8]                    |
0055A0C3                                          | 8138 940000C0                         | cmp dword ptr ds:[eax],C0000094                 |   <---- checking for div by zero
0055A0C9                                          | 75 38                                 | jne maxpayne2.55A103                            |
0055A0CB                                          | 8B4D 10                               | mov ecx,dword ptr ss:[ebp+10]                   | [ebp+10]:EntryPoint
0055A0CE                                          | C781 AC000000 06000000                | mov dword ptr ds:[ecx+AC],6                     |
0055A0D8                                          | 8B15 A8F86400                         | mov edx,dword ptr ds:[64F8A8]                   |
0055A0DE                                          | 0315 74916400                         | add edx,dword ptr ds:[649174]                   |
0055A0E4                                          | 66:0FB602                             | movzx ax,byte ptr ds:[edx]                      |
0055A0E8                                          | 8B0D 10C96400                         | mov ecx,dword ptr ds:[64C910]                   |

So it was SAFESEH causing the problem - which is the config directy in the exe.
Need to kill it before loading the file

0057398C                                          | 8B0D 78FB5900                         | mov ecx,dword ptr ds:[59FB78]                   |
00573992                                          | 3B0D ACBA6400                         | cmp ecx,dword ptr ds:[64BAAC]                   | 0064BAAC:"/NYF"
00573998                                          | 0F85 B3000000                         | jne maxpayne2.573A51                            |
^ wasn't getting to there like driv3r was

00575918                                          | 51                                    | push ecx                                        |
00575919                                          | FF15 78506400                         | call dword ptr ds:[<&INQ32>]                    |
0057591F                                          | A3 209A6400                           | mov dword ptr ds:[649A20],eax                   |   <---- has done the PVD read
00575924                                          | 6A 08                                 | push 8                                          |
00575926                                          | 68 ACDE5D00                           | push maxpayne2.5DDEAC                           |
0057592B                                          | 68 48916400                           | push maxpayne2.649148                           |
00575930                                          | E8 BBDB0100                           | call <maxpayne2.sub_5934F0>                     |
00575935                                          | 83C4 0C                               | add esp,C                                       |
00575938                                          | 85C0                                  | test eax,eax                                    |
0057593A                                          | 75 4F                                 | jne maxpayne2.57598B                            |
0057593C                                          | 833D A0015C00 00                      | cmp dword ptr ds:[5C01A0],0                     |

Or maybe it was ???

these aren't being called though:
00570132                                          | 8B0A                                  | mov ecx,dword ptr ds:[edx]                      |
00570134                                          | 3B0C85 98FB5900                       | cmp ecx,dword ptr ds:[eax*4+59FB98]             |
0057013B                                          | 75 02                                 | jne maxpayne2.57013F                            |

005704AF                                          | 3B0C85 78FB5900                       | cmp ecx,dword ptr ds:[eax*4+59FB78]             |
005704B6                                          | 75 02                                 | jne maxpayne2.5704BA                            |
005704B8                                          | EB 11                                 | jmp maxpayne2.5704CB                            |

Sounds familiar:
0056A146                                          | 8B55 F8                               | mov edx,dword ptr ss:[ebp-8]                    |
0056A149                                          | 8B82 C0070000                         | mov eax,dword ptr ds:[edx+7C0]                  |
0056A14F                                          | 83E0 01                               | and eax,1                                       |
0056A152                                          | 85C0                                  | test eax,eax                                    |
0056A154                                          | 74 23                                 | je maxpayne2.56A179                             |

It's calling exit process even with the ISO:
00592D9C                                          | 75 10                                 | jne maxpayne2.592DAE                            |
00592D9E                                          | FF7424 08                             | push dword ptr ss:[esp+8]                       |
00592DA2                                          | 893D 1C4A6400                         | mov dword ptr ds:[644A1C],edi                   |
00592DA8                                          | FF15 F46D6500                         | call dword ptr ds:[<ExitProcess>]               |
00592DAE                                          | 5F                                    | pop edi                                         |

0056C1AF                                          | E8 FC0B0100                           | call <maxpayne2.sub_57CDB0>                     |
0056C1B4                                          | 83C4 08                               | add esp,8                                       |
0056C1B7                                          | DD1D 70596400                         | fstp qword ptr ds:[645970]                      |
0056C1BD                                          | E9 95000000                           | jmp maxpayne2.56C257                            |
0056C1C2                                          | B8 774B6D47                           | mov eax,476D4B77                                |

DC1D ???????? DFE0 F6C4 <---- fcomp search

0057DA4F                                          | C745 FC A4707DBF                      | mov dword ptr ss:[ebp-4],BF7D70A4               |  <---- this is the bad -99


0057DA21                            | 74 07                                 | je maxpayne2.57DA2A                             |
0057DA23                            | C745 FC CDCCCC3D                      | mov dword ptr ss:[ebp-4],3DCCCCCD               |  <--- maybe that's like the perfect value (nope!)
0057DA2A                            | DB45 EC                               | fild dword ptr ss:[ebp-14]                      |
0057DA2D                            | D95D A8                               | fstp dword ptr ss:[ebp-58]                      |
0057DA30                            | DB45 F8                               | fild dword ptr ss:[ebp-8]                       |
0057DA33                            | D95D A4                               | fstp dword ptr ss:[ebp-5C]                      |
0057DA36                            | D945 A4                               | fld dword ptr ss:[ebp-5C]                       |
0057DA39                            | D835 C4536300                         | fdiv dword ptr ds:[6353C4]                      |
0057DA3F                            | D80D C0536300                         | fmul dword ptr ds:[6353C0]                      |
0057DA45                            | D85D A8                               | fcomp dword ptr ss:[ebp-58]                     |
0057DA48                            | DFE0                                  | fnstsw ax                                       |
0057DA4A                            | F6C4 41                               | test ah,41                                      |
0057DA4D                            | 75 07                                 | jne maxpayne2.57DA56                            |
0057DA4F                            | C745 FC A4707DBF                      | mov dword ptr ss:[ebp-4],BF7D70A4               |
0057DA56                            | D945 FC                               | fld dword ptr ss:[ebp-4]                        |
0057DA59                            | 8BE5                                  | mov esp,ebp                                     |
0057DA5B                            | 5D                                    | pop ebp                                         |
0057DA5C                            | C3                                    | ret                                             |

These are all floats not doubles - dword not qword!!!

0057AAA6                            | 85C0                                  | test eax,eax                                    |
0057AAA8                            | 74 10                                 | je maxpayne2.57AABA                             |
0057AAAA                            | C745 E4 7B14AE47                      | mov dword ptr ss:[ebp-1C],47AE147B              |
0057AAB1                            | C745 E8 E17A943F                      | mov dword ptr ss:[ebp-18],3F947AE1              |
0057AAB8                            | EB 0E                                 | jmp maxpayne2.57AAC8                            |
0057AABA                            | C745 E4 B81E85EB                      | mov dword ptr ss:[ebp-1C],EB851EB8              |
0057AAC1                            | C745 E8 51B89E3F                      | mov dword ptr ss:[ebp-18],3F9EB851              |  <---- hard coding values
0057AAC8                            | DD45 E4                               | fld qword ptr ss:[ebp-1C]                       |
0057AACB                            | D95D EC                               | fstp dword ptr ss:[ebp-14]                      |
0057AACE                            | 8B55 EC                               | mov edx,dword ptr ss:[ebp-14]                   |


0057ADFA                            | 68 6CE76300                           | push maxpayne2.63E76C                           |
0057ADFF                            | 68 68E76300                           | push maxpayne2.63E768                           |
0057AE04                            | E8 17FCFFFF                           | call <maxpayne2.sub_57AA20>                     |
0057AE09                            | 83C4 08                               | add esp,8                                       |
0057AE0C                            | D99D 98F7FFFF                         | fstp dword ptr ss:[ebp-868]                     |
0057AE12                            | 8B15 AC536300                         | mov edx,dword ptr ds:[6353AC]                   |
0057AE18                            | 52                                    | push edx                                        |
0057AE19                            | A1 98536300                           | mov eax,dword ptr ds:[635398]                   |
0057AE1E                            | 50                                    | push eax                                        |
0057AE1F                            | E8 0CF3FFFF                           | call <maxpayne2.sub_57A130>                     |
0057AE24                            | 83C4 08                               | add esp,8                                       |
0057AE27                            | D89D 98F7FFFF                         | fcomp dword ptr ss:[ebp-868]                    |
0057AE2D                            | DFE0                                  | fnstsw ax                                       |
0057AE2F                            | F6C4 01                               | test ah,1                                       |
0057AE32                            | 74 05                                 | je maxpayne2.57AE39                             |

0057AFB2                            | 83C4 18                               | add esp,18                                      |
0057AFB5                            | D99D A0F7FFFF                         | fstp dword ptr ss:[ebp-860]                     |
0057AFBB                            | 8B15 2CE76300                         | mov edx,dword ptr ds:[63E72C]                   |
0057AFC1                            | 83C2 01                               | add edx,1                                       |
0057AFC4                            | 8915 2CE76300                         | mov dword ptr ds:[63E72C],edx                   |
0057AFCA                            | D985 A0F7FFFF                         | fld dword ptr ss:[ebp-860]                      |   <--- could be the timeout??
0057AFD0                            | DC1D D8526300                         | fcomp qword ptr ds:[6352D8]                     |


0057B0C5                            | 83C4 18                               | add esp,18                                      |
0057B0C8                            | D99D 7CF7FFFF                         | fstp dword ptr ss:[ebp-884]                     |
0057B0CE                            | D985 7CF7FFFF                         | fld dword ptr ss:[ebp-884]                      |   <---- compares against 350
0057B0D4                            | D81D C86C5E00                         | fcomp dword ptr ds:[5E6CC8]                     |
0057B0DA                            | DFE0                                  | fnstsw ax                                       |
0057B0DC                            | F6C4 41                               | test ah,41                                      |
0057B0DF                            | 75 0F                                 | jne maxpayne2.57B0F0                            |

0057DF07                            | 83C4 0C                               | add esp,C                                       |
0057DF0A                            | D95D D8                               | fstp dword ptr ss:[ebp-28]                      |
0057DF0D                            | D945 D8                               | fld dword ptr ss:[ebp-28]                       |
0057DF10                            | D835 04546300                         | fdiv dword ptr ds:[635404]                      |
0057DF16                            | D95D E4                               | fstp dword ptr ss:[ebp-1C]                      | [ebp-1C]:"MP2_PLAY                        "
0057DF19                            | C745 E8 00000000                      | mov dword ptr ss:[ebp-18],0                     | [ebp-18]:"UKD_590162.001"
0057DF20                            | EB 09                                 | jmp maxpayne2.57DF2B                            |

Last one could be interesting
0056C471                            | DC1D 70596400                         | fcomp qword ptr ds:[645970]                     |
0056C477                            | DFE0                                  | fnstsw ax                                       |
0056C479                            | F6C4 41                               | test ah,41                                      |
0056C47C                            | 75 0C                                 | jne maxpayne2.56C48A                            | is taken
0056C47E                            | C705 945C6300 00000000                | mov dword ptr ds:[635C94],0                     |
0056C488                            | EB 0A                                 | jmp maxpayne2.56C494                            |
0056C48A                            | C705 945C6300 01000000                | mov dword ptr ds:[635C94],1                     |

00565B4F                            | DC5D C8                               | fcomp qword ptr ss:[ebp-38]                     |
00565B52                            | DFE0                                  | fnstsw ax                                       |
00565B54                            | F6C4 01                               | test ah,1                                       |
DC5D C8 DFE0 F6C4


00560F5E                            | 833D 945C6300 00                      | cmp dword ptr ds:[635C94],0                     |
^ could be the way it speeds up?


0056650B                            | A1 885E6300                           | mov eax,dword ptr ds:[635E88]                   |
00566510                            | 33C9                                  | xor ecx,ecx                                     |
00566512                            | 8A08                                  | mov cl,byte ptr ds:[eax]                        |
00566514                            | 85C9                                  | test ecx,ecx                                    |
00566516                            | 0F85 830A0000                         | jne maxpayne2.566F9F                 <------- maybe just flipping this makes it work ?!?!!? WHAT?!?!?!
0056651C                            | DB45 D8                               | fild dword ptr ss:[ebp-28]                      |
0056651F                            | DD9D 5CFFFFFF                         | fstp qword ptr ss:[ebp-A4]                      |
00566525                            | DB05 58F86400                         | fild dword ptr ds:[64F858]                      |
0056652B                            | DD9D 54FFFFFF                         | fstp qword ptr ss:[ebp-AC]                      |
00566531                            | DD85 54FFFFFF                         | fld qword ptr ss:[ebp-AC]                       |
00566537                            | DC0D E0526300                         | fmul qword ptr ds:[6352E0]                      |
0056653D                            | DC9D 5CFFFFFF                         | fcomp qword ptr ss:[ebp-A4]                     |
00566543                            | DFE0                                  | fnstsw ax                                       |
00566545                            | F6C4 01                               | test ah,1                                       |
00566548                            | 0F84 510A0000                         | je maxpayne2.566F9F                             |
0056654E                            | 833D A0015C00 00                      | cmp dword ptr ds:[5C01A0],0                     |
^ Here ???

DB45 ?? DD9D ????????

00566516                            | 0F85 830A0000                         | jne maxpayne2.566F9F                            | COULD THIS BE IT
0056651C                            | DB45 D8                               | fild dword ptr ss:[ebp-28]                      |
0056651F                            | DD9D 5CFFFFFF                         | fstp qword ptr ss:[ebp-A4]                      |
00566525                            | DB05 58F86400                         | fild dword ptr ds:[64F858]                      |
0056652B                            | DD9D 54FFFFFF                         | fstp qword ptr ss:[ebp-AC]                      |
00566531                            | DD85 54FFFFFF                         | fld qword ptr ss:[ebp-AC]                       |
00566537                            | DC0D E0526300                         | fmul qword ptr ds:[6352E0]                      |
0056653D                            | DC9D 5CFFFFFF                         | fcomp qword ptr ss:[ebp-A4]                     |
00566543                            | DFE0                                  | fnstsw ax                                       |
00566545                            | F6C4 01                               | test ah,1                                       |
00566548                            | 0F84 510A0000                         | je maxpayne2.566F9F                             | not taken
0056654E                            | 833D A0015C00 00                      | cmp dword ptr ds:[5C01A0],0                     |
00566555                            | 74 0F                                 | je maxpayne2.566566                             | is taken
00566557                            | 68 085F6300                           | push maxpayne2.635F08                           |
0056655C                            | 6A 30                                 | push 30                                         |
0056655E                            | E8 4DA50100                           | call <maxpayne2.sub_580AB0>                     |
00566563                            | 83C4 08                               | add esp,8                                       |
00566566                            | 833D A05D6300 00                      | cmp dword ptr ds:[635DA0],0                     |
0056656D                            | 74 12                                 | je maxpayne2.566581                             | is taken
0056656F                            | 833D CC5C6300 00                      | cmp dword ptr ds:[635CCC],0                     |
00566576                            | 75 09                                 | jne maxpayne2.566581                            |
00566578                            | 833D 08C96400 00                      | cmp dword ptr ds:[64C908],0                     |
0056657F                            | 74 09                                 | je maxpayne2.56658A                             |
00566581                            | 833D 505D6300 00                      | cmp dword ptr ds:[635D50],0                     |
00566588                            | 74 27                                 | je maxpayne2.5665B1                             | is taken
0056658A                            | C705 98EE5B00 00000000                | mov dword ptr ds:[5BEE98],0                     |
00566594                            | 833D A0015C00 00                      | cmp dword ptr ds:[5C01A0],0                     |
0056659B                            | 74 0F                                 | je maxpayne2.5665AC                             |
0056659D                            | 68 48825D00                           | push maxpayne2.5D8248                           | 5D8248:"70018B9460D314E9FCA33848A7FDA2F25C59B077CAE600CD46FA"
005665A2                            | 6A 10                                 | push 10                                         |
005665A4                            | E8 07A50100                           | call <maxpayne2.sub_580AB0>                     |
005665A9                            | 83C4 08                               | add esp,8                                       |
005665AC                            | E9 11020000                           | jmp maxpayne2.5667C2                            |
005665B1                            | 8B15 4CD26400                         | mov edx,dword ptr ds:[64D24C]                   |
005665B7                            | 8B02                                  | mov eax,dword ptr ds:[edx]                      |
005665B9                            | 2D 06030000                           | sub eax,306                                     |
005665BE                            | A3 54596400                           | mov dword ptr ds:[645954],eax                   |
005665C3                            | 68 00100000                           | push 1000                                       |
005665C8                            | 6A 00                                 | push 0                                          |
005665CA                            | 68 E0E66400                           | push maxpayne2.64E6E0                           |
005665CF                            | E8 3CCB0200                           | call <maxpayne2.sub_593110>                     |
005665D4                            | 83C4 0C                               | add esp,C                                       |
005665D7                            | 833D CC5C6300 00                      | cmp dword ptr ds:[635CCC],0                     |
005665DE                            | 74 24                                 | je maxpayne2.566604                             | not taken


00569C27                            | 74 49                                 | je maxpayne2.569C72                             | TERMINATE JMPS
00569C29                            | 833D B0015C00 00                      | cmp dword ptr ds:[5C01B0],0                     |
00569C30                            | 74 40                                 | je maxpayne2.569C72                             |
00569C32                            | E8 79E60000                           | call <maxpayne2.sub_5782B0>                     |
00569C37                            | 833D 8C5E6300 00                      | cmp dword ptr ds:[635E8C],0                     |
00569C3E                            | 74 32                                 | je maxpayne2.569C72                             |
00569C40                            | A1 8C5E6300                           | mov eax,dword ptr ds:[635E8C]                   | TERMINATE
00569C45                            | 50                                    | push eax                                        |
00569C46                            | FF15 707E6400                         | call dword ptr ds:[<&DestroyWindow>]            |
00569C4C                            | C705 8C5E6300 00000000                | mov dword ptr ds:[635E8C],0                     |
00569C56                            | C785 C0F9FFFF 00000000                | mov dword ptr ss:[ebp-640],0                    |
00569C60                            | 8B8D C0F9FFFF                         | mov ecx,dword ptr ss:[ebp-640]                  |
00569C66                            | 51                                    | push ecx                                        |
00569C67                            | 68 BCFE5D00                           | push maxpayne2.5DFEBC                           | 5DFEBC:"MainWClass"
00569C6C                            | FF15 14706500                         | call dword ptr ds:[<UnregisterClassA>]          |
00569C72                            | 6A 06                                 | push 6                                          |
00569C74                            | E8 B707FFFF                           | call maxpayne2.55A430                           |
00569C79                            | 83C4 04                               | add esp,4                                       |
00569C7C                            | 6A 06                                 | push 6                                          |
00569C7E                            | E8 72900200                           | call <maxpayne2.sub_592CF5>                     | TERMINATE

Reference from 5684D9, Jump from 569B33

0056661F                            | FF15 68916400                         | call dword ptr ds:[<&RLOS32>]                   | RLOS32
00566625                            | A3 98EE5B00                           | mov dword ptr ds:[5BEE98],eax                   |
0056662A                            | 833D 98EE5B00 00                      | cmp dword ptr ds:[5BEE98],0                     |
00566631                            | 0F85 8B010000                         | jne maxpayne2.5667C2                            | is taken   Doesn't matter ?


005670B5                            | 83C2 01                               | add edx,1                                       |
005670B8                            | 8955 E8                               | mov dword ptr ss:[ebp-18],edx                   |
005670BB                            | 837D E8 23                            | cmp dword ptr ss:[ebp-18],23                    | 23:'#'
005670BF                            | 0F8F C2000000                         | jg maxpayne2.567187                             |  not taken
005670C5                            | 837D E8 1F                            | cmp dword ptr ss:[ebp-18],1F                    |
005670C9                            | 75 44                                 | jne maxpayne2.56710F                            |
005670CB                            | 833D 905C6300 00                      | cmp dword ptr ds:[635C90],0                     |
005670D2                            | 75 19                                 | jne maxpayne2.5670ED                            |

--------------------------
Back to the CD Checks
00575CA7                            | A1 78FB5900                           | mov eax,dword ptr ds:[59FB78]                   |
00575CAC                            | 3B05 ACBA6400                         | cmp eax,dword ptr ds:[64BAAC]                   | 0064BAAC:"/NYF"
00575CB2                            | 0F85 89000000                         | jne maxpayne2.575D41                            |

0059FB78  7A 6E EA 1B 00 00 00 00 00 00 00 00 00 00 00 00  znê.............  <----- Correct

0064BAAC  2F 4E 59 46 00 00 00 00 00 00 00 00 00 00 00 00  /NYF............  <----- Incorrect

0056A149                            | 8B82 C0070000                         | mov eax,dword ptr ds:[edx+7C0]                  | should be 0
0056A14F                            | 83E0 01                               | and eax,1                                       |
0056A152                            | 85C0                                  | test eax,eax                                    |
0056A154                            | 74 23                                 | je maxpayne2.56A179                             | taken

005704AF                            | 3B0C85 78FB5900                       | cmp ecx,dword ptr ds:[eax*4+59FB78]             |
005704B6                            | 75 02                                 | jne maxpayne2.5704BA              <-- can just nop              |   <---- seems to recheck it here - need to make it be the value it needs

00568F6F                            | E8 3C7B0100                           | call <maxpayne2.sub_580AB0>                     |
00568F74                            | 83C4 08                               | add esp,8                                       |
00568F77                            | E8 34AC0000                           | call <maxpayne2.sub_573BB0>                     |  <---- check CD ?
00568F7C                            | E8 CFE00000                           | call <maxpayne2.sub_577050>                     |

Known as CD Check 3 - optional one ???
0056FF7C                            | 81EA 96000000                         | sub edx,96                                       |
0056FF82                            | 3915 48536400                         | cmp dword ptr ds:[645348],edx                    |
0056FF88                            | 74 12                                 | je maxpayne2.56FF9C                              | taken - difference maker!!!!!
0056FF8A                            | E8 A1C8FFFF                           | call <maxpayne2.sub_56C830>                      |
0056FF8F                            | 85C0                                  | test eax,eax                                     |

81??9600000039??????????74??E8

For X2 it looks like:
0632BE6D                            | 75 C8                                 | jne x2.632BE37                                   |
0632BE6F                            | A1 EC124606                           | mov eax,dword ptr ds:[64612EC]                   |
0632BE74                            | 8B08                                  | mov ecx,dword ptr ds:[eax]                       |
0632BE76                            | 81E9 96000000                         | sub ecx,96                                       |
0632BE7C                            | 390D 48A64506                         | cmp dword ptr ds:[645A648],ecx                   |
0632BE82                            | 74 16                                 | je x2.632BE9A                                    |
0632BE84                            | E8 17C8FFFF                           | call <x2.sub_63286A0>                            |
0632BE89                            | 85C0                                  | test eax,eax                                     |
0632BE8B                            | 75 0D                                 | jne x2.632BE9A                                   |
0632BE8D                            | E8 4EA2FFFF                           | call <x2.sub_63260E0>                            |
0632BE92                            | 85C0                                  | test eax,eax                                     |



0056FF88 - 0056FF7C = 0xC

then just do the fstp ! no need for the trick

CD Check 1
00575CA5                            | EB CC                                 | jmp maxpayne2.575C73                             |
00575CA7                            | A1 78FB5900                           | mov eax,dword ptr ds:[59FB78]                    | Good
00575CAC                            | 3B05 ACBA6400                         | cmp eax,dword ptr ds:[64BAAC]                    | 0064BAAC:"/NYF"
00575CB2                            | 0F85 89000000                         | jne maxpayne2.575D41                             | not taken
00575CB8                            | 68 E0E66400                           | push maxpayne2.64E6E0                            |
00575CBD                            | E8 3E44FFFF                           | call <maxpayne2.sub_56A100>                      |
00575CC2                            | 83C4 04                               | add esp,4                                        |
00575CC5                            | 85C0                                  | test eax,eax                                     |
00575CC7                            | 74 78                                 | je maxpayne2.575D41                              | not taken  <--- part 2

Drivers@
009736B0                            | EB CC                                 | jmp driv3r.97367E                                |
009736B2                            | 8B0D A86B9D00                         | mov ecx,dword ptr ds:[9D6BA8]                    | 009D6BA8:"v37#"
009736B8                            | 3B0D 8CCBAD00                         | cmp ecx,dword ptr ds:[ADCB8C]                    | 00ADCB8C:"/NYF"
009736BE                            | 0F85 A3000000                         | jne driv3r.973767                                |
009736C4                            | 68 A0F5AD00                           | push driv3r.ADF5A0                               |
009736C9                            | E8 2247FFFF                           | call driv3r.967DF0                               |
009736CE                            | 83C4 04                               | add esp,4                                        |
009736D1                            | 85C0                                  | test eax,eax                                     | eax:TpCallbackIndependent+140
009736D3                            | 0F84 8E000000                         | je driv3r.973767                                 |
009736D9                            | 68 00080000                           | push 800                                         |

0F84 ???????? 68 00080000 


3B?? ???????? 0F85 ???????? 68 ???????? E8 ???????? 83C40485C0
009736BE - 009736B8 = 6
009736D3 - 009736B8 = 1B

EBCC????????????3B0D????????0F85????????68

EBCCA1????????3B05????????0F85????????68

00575CC7 - 00575CA5 = 0x20

// THERE'S ANOTHER VERSION - not needed?
00575456                            | 8B0D BC526400                         | mov ecx,dword ptr ds:[6452BC]                    |
0057545C                            | 8B15 ACBA6400                         | mov edx,dword ptr ds:[64BAAC]                    |
00575462                            | 03148D E0E66400                       | add edx,dword ptr ds:[ecx*4+64E6E0]              |
00575469                            | 8915 ACBA6400                         | mov dword ptr ds:[64BAAC],edx                    |
0057546F                            | EB CC                                 | jmp maxpayne2.57543D                             |
00575471                            | A1 78FB5900                           | mov eax,dword ptr ds:[59FB78]                    |
00575476                            | 3B05 ACBA6400                         | cmp eax,dword ptr ds:[64BAAC]                    |
0057547C                            | 0F85 20010000                         | jne maxpayne2.5755A2                             |
00575482                            | 68 E0E66400                           | push maxpayne2.64E6E0                            |
00575487                            | E8 744CFFFF                           | call maxpayne2.56A100                            |

CD Check 2
005704A8                            | A1 BC526400                           | mov eax,dword ptr ds:[6452BC]                    |
005704AD                            | 8B0A                                  | mov ecx,dword ptr ds:[edx]                       |
005704AF                            | 3B0C85 78FB5900                       | cmp ecx,dword ptr ds:[eax*4+59FB78]              |
005704B6                            | 75 02                                 | jne maxpayne2.5704BA                             |
005704B8                            | EB 11                                 | jmp maxpayne2.5704CB                             |
005704BA                            | 8B15 BC526400                         | mov edx,dword ptr ds:[6452BC]                    | edx:"/NYF"

A1????????8B0A3B0C85????????7502EB118B

005704B6 - 005704A8 = E

0056C1AF                                          | E8 FC0B0100                           | call <maxpayne2.sub_57CDB0>                     |
0056C1B4                                          | 83C4 08                               | add esp,8                                       |
0056C1B7                                          | DD1D 70596400                         | fstp qword ptr ds:[645970]                      |
0056C1BD                                          | E9 95000000                           | jmp maxpayne2.56C257                            |
0056C1C2                                          | B8 774B6D47                           | mov eax,476D4B77                                |

E8????????83C408DD1D????????E9

0056C1B7 - 0056C1AF = 8

Finding our way again now comments have gone:
005691FE                            | 68 00080000                           | push 800                                         |  <---- get to here
00569203                            | 68 60C96400                           | push maxpayne2.64C960                            |
00569208                            | 68 E0E66400                           | push maxpayne2.64E6E0                            |
0056920D                            | E8 BE9B0200                           | call maxpayne2.592DD0                            |
0056920D                            | E8 BE9B0200                           | call maxpayne2.592DD0                            |
00569212                            | 83C4 0C                               | add esp,C                                        |
00569215                            | E8 E66F0000                           | call <maxpayne2.sub_570200>                      |  <---- this one can kick us out

---------------------------------------------------------------------------------------------
Counter Strike: Condition Zero - 5.00.03

0351E33E                            | 8A08                                  | mov cl,byte ptr ds:[eax]                        |
0351E340                            | 85C9                                  | test ecx,ecx                                    | ecx:NtQueryInformationThread+C
0351E342                            | 0F85 D80A0000                         | jne czero.351EE20                               |   <----- max payne jump fixed it
0351E348                            | DB45 D8                               | fild dword ptr ss:[ebp-28]                      |
0351E34B                            | DD9D 5CFFFFFF                         | fstp qword ptr ss:[ebp-A4]                      |
0351E351                            | DB05 F8486B03                         | fild dword ptr ds:[36B48F8]                     |
0351E357                            | DD9D 54FFFFFF                         | fstp qword ptr ss:[ebp-AC]                      |
0351E35D                            | DD85 54FFFFFF                         | fld qword ptr ss:[ebp-AC]                       |
0351E363                            | DC0D 20A26903                         | fmul qword ptr ds:[369A220]                     |
0351E369                            | DC9D 5CFFFFFF                         | fcomp qword ptr ss:[ebp-A4]                     |
0351E36F                            | DFE0                                  | fnstsw ax                                       |
0351E371                            | F6C4 01                               | test ah,1                                       |

035790E4                            | 8B0D F0196B03                         | mov ecx,dword ptr ds:[36B19F0]                  | ecx:NtQueryInformationThread+C
035790EA                            | 890D 48046B03                         | mov dword ptr ds:[36B0448],ecx                  | ecx:NtQueryInformationThread+C
035790F0                            | 68 F0196B03                           | push czero.36B19F0                              |
035790F5                            | 68 C0106B03                           | push czero.36B10C0                              |
035790FA                            | E8 0F100400                           | call czero.35BA10E                              |
035790FF                            | 83C4 08                               | add esp,8                                       |
03579102                            | DD1D 70BC6A03                         | fstp qword ptr ds:[36ABC70]                     |   <----- as does zero'ing out this
03579108                            | E9 21000000                           | jmp czero.357912E                               |
0357910D                            | B8 774B6D47                           | mov eax,476D4B77                                |
03579112                            | 0000                                  | add byte ptr ds:[eax],al                        |
03579114                            | 0000                                  | add byte ptr ds:[eax],al                        |
03579116                            | 26:0000                               | add byte ptr es:[eax],al                        |
03579119                            | 0002                                  | add byte ptr ds:[edx],al                        |


00569C1C                            | 8B15 6E906400                         | mov edx,dword ptr ds:[64906E]                   |
00569C22                            | 83E2 02                               | and edx,2                                       |
00569C25                            | 85D2                                  | test edx,edx                                    |
00569C27                            | 74 49                                 | je maxpayne2.569C72                             | TERMINATE JMPS

^ Both Max Payne and Driv3r method work

trace into:
0x{p:cip} {i:cip}

------------------------------------------------------------------------------------------------
Pro Evolution Soccer 3 - 4.85.04


AddD....4.85.04
4164644403000000342E38352E303400
4164644403000000??2E????2E????00

max payne 2 trick worked

00ED86EA                             | EB D8                            | jmp pes3.ED86C4                                               |
00ED86EC                             | 8B0D 883BF000                    | mov ecx,dword ptr ds:[F03B88]                                 | 00F03B88:"h@K<"
00ED86F2                             | 3B0D 4C06FB00                    | cmp ecx,dword ptr ds:[FB064C]                                 |
00ED86F8                             | 0F85 B3000000                    | jne pes3.ED87B1                                               |
^ maybe not

is here:
00EDAA07                             | A1 883BF000                      | mov eax,dword ptr ds:[F03B88]                                 | 00F03B88:"h@K<"
00EDAA0C                             | 3B05 4C06FB00                    | cmp eax,dword ptr ds:[FB064C]      

00EDAA18                             | 68 8032FB00                      | push pes3.FB3280                                              |
00EDAA1D                             | E8 8E46FFFF                      | call <pes3.sub_ECF0B0>                                        |
00EDAA22                             | 83C4 04                          | add esp,4                                                     |
00EDAA25                             | 85C0                             | test eax,eax                                                  |
00EDAA27                             | 74 78                            | je pes3.EDAAA1                                                |
00EDAA29                             | 68 00080000                      | push 800                                                      |
00EDAA2E                             | 68 8032FB00                      | push pes3.FB3280                                              |
00EDAA33                             | 68 0015FB00                      | push pes3.FB1500                                              |
00EDAA38                             | E8 D3CC0100                      | call <pes3.sub_EF7710>                                        |
00EDAA3D                             | 83C4 0C                          | add esp,C                                                     |
00EDAA40                             | 833D B041F200 00                 | cmp dword ptr ds:[F241B0],0             

74??680008000068????????68????????E8
-------------------------------------------------------------------------------------------------
Magic The Gathering - Battlegrounds - 4.85.07

Max Payne 2 trick works

--------------------------------------------------------------------------------------------------
X-2 The Threat - 5.00.03

It's getting to 
062FC1A6                            | 68 00080000                           | push 800                                         |
062FC1AB                            | 68 000A4606                           | push x2.6460A00                                  |
062FC1B0                            | 68 80274606                           | push x2.6462780                                  |
062FC1B5                            | E8 96DB0700                           | call <x2.sub_6379D50>                            |
062FC1BA                            | 83C4 0C                               | add esp,C                                        |
062FC1BD                            | E8 AEFA0200                           | call x2.632BC70                                  |
062FC1C2                            | 833D 98513B06 00                      | cmp dword ptr ds:[63B5198],0                     |


0632F97D                             | EB D6                            | jmp x2.632F955                                                |
0632F97F                             | A1 786B3806                      | mov eax,dword ptr ds:[6386B78]                                | eax:TpCallbackIndependent+140, 06386B78:"qo\v'"
0632F984                             | 3B05 4CFB4506                    | cmp eax,dword ptr ds:[645FB4C]                                | eax:TpCallbackIndependent+140, 0645FB4C:"&FYF"
0632F98A                             | 0F85 B3000000                    | jne x2.632FA43                                                |
0632F990                             | 68 80274606                      | push x2.6462780                                               |
0632F995                             | E8 5667FFFF                      | call <x2.sub_63260F0>                                         |

06331D76                             | 030C85 80274606                  | add ecx,dword ptr ds:[eax*4+6462780]                          |
06331D7D                             | 890D 4CFB4506                    | mov dword ptr ds:[645FB4C],ecx                                | 0645FB4C:"&FYF"
06331D83                             | EB CB                            | jmp x2.6331D50                                                |
06331D85                             | 8B15 786B3806                    | mov edx,dword ptr ds:[6386B78]                                | 06386B78:"qo\v'"
06331D8B                             | 3B15 4CFB4506                    | cmp edx,dword ptr ds:[645FB4C]                                | 0645FB4C:"&FYF"
06331D91                             | 0F85 8E000000                    | jne x2.6331E25                                                |
06331D97                             | 68 80274606                      | push x2.6462780                                               |
06331D9C                             | E8 4F43FFFF                      | call <x2.sub_63260F0>                                         |
06331DA1                             | 83C4 04                          | add esp,4                                                     |
06331DA4                             | 85C0                             | test eax,eax                                                  | eax:TpCallbackIndependent+140

Lots of :
0634E8EB                             | 74 01                            | je x2.634E8EE                                                 |
0634E8ED                             | CC                               | int3                                                          |
0634E8EE                             | 8B4C24 08                        | mov ecx,dword ptr ss:[esp+8]                                  |

The one the only correct fstp:
063280FA                             | E8 0F100400                      | call x2.636910E                                               |
063280FF                             | 83C4 08                          | add esp,8                                                     |
06328102                             | DD1D 70AC4506                    | fstp qword ptr ds:[645AC70]                                   |
06328108                             | E9 21000000                      | jmp x2.632812E                                                |
0632810D                             | B8 774B6D47                      | mov eax,476D4B77                                              |
06328112                             | 0000                             | add byte ptr ds:[eax],al                                      |
06328114                             | 0000                             | add byte ptr ds:[eax],al                                      |

---------------------------------------------------------------------------------------------------
Sid Meier's Pirates! - 5.03.06

Could not find CD Check location!

0092DD4E                            | FF15 C43BC200                         | call dword ptr ds:[<&DeviceIoControl>]           |
0092DD54                            | 8945 FC                               | mov dword ptr ss:[ebp-4],eax                     |
0092DD57                            | 33C0                                  | xor eax,eax                                      |

.mvmkdx
00AA6A8A         | 8B15 1032C200                         | mov edx,dword ptr ds:[C23210]                    |
00AA6A90         | 83EC 04                               | sub esp,4                                        |
00AA6A93         | 891424                                | mov dword ptr ss:[esp],edx                       |
00AA6A96         | FF15 283CC200                         | call dword ptr ds:[<&GDS32>]                     |
00AA6A9C         | 83EC 04                               | sub esp,4                                        |
00AA6A9F         | 891C24                                | mov dword ptr ss:[esp],ebx                       |
00AA6AA2         | 8B1D 108BB500                         | mov ebx,dword ptr ds:[B58B10]                    |
^ pops out here

CRC Check!?
0092DD8E         | C74424 14 73000200                    | mov dword ptr ss:[esp+14],20073                  | [esp+14]:"???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????!\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????", 20073:"????????????????????????????????????????????????
0092DD96         | 894424 10                             | mov dword ptr ss:[esp+10],eax                    |
0092DD9A         | B8 50DD9200                           | mov eax,pirates!.92DD50                          |
0092DD9F         | 896C24 0C                             | mov dword ptr ss:[esp+C],ebp                     |
0092DDA3         | 894424 18                             | mov dword ptr ss:[esp+18],eax                    |
0092DDA7         | 33C0                                  | xor eax,eax                                      |
0092DDA9         | 8B6C24 18                             | mov ebp,dword ptr ss:[esp+18]                    |
0092DDAD         | 8B6D 00                               | mov ebp,dword ptr ss:[ebp]                       |
0092DDB0         | 33C5                                  | xor eax,ebp                                      |
0092DDB2         | 834424 18 04                          | add dword ptr ss:[esp+18],4                      |
0092DDB7         | 66:FF4C24 14                          | dec word ptr ss:[esp+14]                         |
0092DDBC         | 75 EB                                 | jne pirates!.92DDA9                              |

CRC Checks everywhere:
0092F2A8         | C74424 1C 0191BB09                    | mov dword ptr ss:[esp+1C],9BB9101                |
0092F2B0         | C74424 18 79000100                    | mov dword ptr ss:[esp+18],10079                  |
0092F2B8         | 894424 14                             | mov dword ptr ss:[esp+14],eax                    |
0092F2BC         | B8 60F29200                           | mov eax,pirates!.92F260                          |
0092F2C1         | C14C24 1C 00                          | ror dword ptr ss:[esp+1C],0                      |
0092F2C6         | 894C24 10                             | mov dword ptr ss:[esp+10],ecx                    |
0092F2CA         | 8B08                                  | mov ecx,dword ptr ds:[eax]                       |
0092F2CC         | 014C24 1C                             | add dword ptr ss:[esp+1C],ecx                    |
0092F2D0         | 83C0 04                               | add eax,4                                        |
0092F2D3         | 66:FF4C24 18                          | dec word ptr ss:[esp+18]                         |
0092F2D8         | 75 F0                                 | jne pirates!.92F2CA                              |
0092F2DA         | 806424 1C FE                          | and byte ptr ss:[esp+1C],FE                      |
0092F2DF         | 8B4424 1C                             | mov eax,dword ptr ss:[esp+1C]                    |
0092F2E3         | 3D 54080000                           | cmp eax,854                                      |
0092F2E8         | 74 01                                 | je pirates!.92F2EB                               |
0092F2EA         | CC                                    | int3                                             |
0092F2EB         | 8B4424 20                             | mov eax,dword ptr ss:[esp+20]                    |
0092F2EF         | 8B4C24 1C                             | mov ecx,dword ptr ss:[esp+1C]                    |
0092F2F3         | 894424 1C                             | mov dword ptr ss:[esp+1C],eax                    |
0092F2F7         | 8B4424 14                             | mov eax,dword ptr ss:[esp+14]                    |

Currently here:
00AA9851         | 8B7C24 14                             | mov edi,dword ptr ss:[esp+14]                    |

Currently here:
00AA6E3F         | 83EC 20                               | sub esp,20                                       |
00AA6E42         | C74424 1C 2746D3F0                    | mov dword ptr ss:[esp+1C],F0D34627               |
00AA6E4A         | C74424 18 68000200                    | mov dword ptr ss:[esp+18],20068                  | 20068:"???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????!\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????"
00AA6E52         | 897C24 14                             | mov dword ptr ss:[esp+14],edi                    |
00AA6E56         | BF 0C6EAA00                           | mov edi,<pirates!.sub_AA6E0C>                    |
00AA6E5B         | 895424 10                             | mov dword ptr ss:[esp+10],edx                    |
00AA6E5F         | 897C24 1C                             | mov dword ptr ss:[esp+1C],edi                    |
00AA6E63         | 33FF                                  | xor edi,edi                                      |

After hitting retry:
00ADF6DE         | 83C4 04                               | add esp,4                                        |
00ADF6E1         | EB 1C                                 | jmp pirates!.ADF6FF                              |
00ADF6E3         | 837D FC 00                            | cmp dword ptr ss:[ebp-4],0                       | [ebp-04]:MessageBoxA
00ADF6E7         | 74 16                                 | je pirates!.ADF6FF                               |
00ADF6E9         | 8B4D 14                               | mov ecx,dword ptr ss:[ebp+14]                    |
00ADF6EC         | 51                                    | push ecx                                         |
00ADF6ED         | 8B55 10                               | mov edx,dword ptr ss:[ebp+10]                    | [ebp+10]:"Pirates!"
00ADF6F0         | 52                                    | push edx                                         |
00ADF6F1         | 8B45 0C                               | mov eax,dword ptr ss:[ebp+C]                     | [ebp+0C]:"Wrong Disc inserted. Please insert the original Pirates! disc into your CD/DVD drive."
00ADF6F4         | 50                                    | push eax                                         |
00ADF6F5         | 8B4D 08                               | mov ecx,dword ptr ss:[ebp+8]                     |
00ADF6F8         | 51                                    | push ecx                                         |
00ADF6F9         | FF55 FC                               | call dword ptr ss:[ebp-4]                        | [ebp-04]:MessageBoxA
00ADF6FC         | 8945 F8                               | mov dword ptr ss:[ebp-8],eax                     |
00ADF6FF         | 8B55 F0                               | mov edx,dword ptr ss:[ebp-10]                    |
00ADF702         | 52                                    | push edx                                         |
00ADF703         | FF15 E0C8C200                         | call dword ptr ds:[<FreeLibrary>]                |
00ADF709         | 8B45 F8                               | mov eax,dword ptr ss:[ebp-8]                     |

00B20FBD         | 8B53 08                               | mov edx,dword ptr ds:[ebx+8]                     |
00B20FC0         | 8B5B 04                               | mov ebx,dword ptr ds:[ebx+4]                     |
00B20FC3         | 034D F4                               | add ecx,dword ptr ss:[ebp-C]                     | [ebp-0C]:MessageBoxW
00B20FC6         | 895A 04                               | mov dword ptr ds:[edx+4],ebx                     |
00B20FC9         | 8B55 0C                               | mov edx,dword ptr ss:[ebp+C]                     | [ebp+0C]:"Wrong Disc inserted. Please insert the original Pirates! disc into your CD/DVD drive."
00B20FCC         | 894D FC                               | mov dword ptr ss:[ebp-4],ecx                     | [ebp-04]:MessageBoxA
00B20FCF         | 8B5A 04                               | mov ebx,dword ptr ds:[edx+4]                     |
00B20FD2         | 8B52 08                               | mov edx,dword ptr ds:[edx+8]                     |
00B20FD5         | 8953 08                               | mov dword ptr ds:[ebx+8],edx                     |
00B20FD8         | 8BD1                                  | mov edx,ecx                                      |
00B20FDA         | C1FA 04                               | sar edx,4                                        |
00B20FDD         | 4A                                    | dec edx                                          |
00B20FDE         | 83FA 3F                               | cmp edx,3F                                       | 3F:'?'
00B20FE1         | 76 03                                 | jbe pirates!.B20FE6                              |

00ADF5DD         | 75 14                                 | jne pirates!.ADF5F3                              |
00ADF5DF         | 8B45 10                               | mov eax,dword ptr ss:[ebp+10]                    | [ebp+10]:"Pirates!"
00ADF5E2         | 50                                    | push eax                                         |
00ADF5E3         | E8 18FFFFFF                           | call pirates!.ADF500                             |
00ADF5E8         | 83C4 04                               | add esp,4                                        |
00ADF5EB         | 85C0                                  | test eax,eax                                     |
00ADF5ED         | 0F84 F0000000                         | je pirates!.ADF6E3                               |  <--- a possibly good jmp?



00A1EB89         | 0081 34241601                         | add byte ptr ds:[ecx+1162434],al                 |
00A1EB8F         | 0000                                  | add byte ptr ds:[eax],al                         | eax:TpCallbackIndependent+140
00A1EB91 <pirate | 032424                                | add esp,dword ptr ss:[esp]                       | [esp]:TpCallbackIndependent+478
00A1EB94         | DD1D B853C200                         | fstp qword ptr ds:[C253B8]                       |  <----- does get hit with a -99 - and skipping does skip geometry
00A1EB9A         | E9 1E000000                           | jmp pirates!.A1EBBD                              |
00A1EB9F         | B8 774B6D47                           | mov eax,476D4B77                                 | eax:TpCallbackIndependent+140

00A1F901         | 833424 73                             | xor dword ptr ss:[esp],73                        | [esp]:TpCallbackIndependent+478
00A1F905         | 032424                                | add esp,dword ptr ss:[esp]                       | [esp]:TpCallbackIndependent+478
00A1F908         | DD1D B853C200                         | fstp qword ptr ds:[C253B8]                       |
00A1F90E         | 68 012F0000                           | push 2F01                                        |
00A1F913         | 7C 11                                 | jl pirates!.A1F926                               |

03 24 24 DD1D ????????



Max Payne CD Check 1
00575CA5                            | EB CC                                 | jmp maxpayne2.575C73                             |
00575CA7                            | A1 78FB5900                           | mov eax,dword ptr ds:[59FB78]                    | Good
00575CAC                            | 3B05 ACBA6400                         | cmp eax,dword ptr ds:[64BAAC]                    | 0064BAAC:"/NYF"
00575CB2                            | 0F85 89000000                         | jne maxpayne2.575D41                             | not taken
00575CB8                            | 68 E0E66400                           | push maxpayne2.64E6E0                            |
00575CBD                            | E8 3E44FFFF                           | call <maxpayne2.sub_56A100>                      |
00575CC2                            | 83C4 04                               | add esp,4                                        |
00575CC5                            | 85C0                                  | test eax,eax                                     |
00575CC7                            | 74 78                                 | je maxpayne2.575D41                              | not taken  <--- part 2

3B05 ??????00

Looks familiar
008FB92A         | 8B7424 18                             | mov esi,dword ptr ss:[esp+18]                    |
008FB92E         | 83C4 24                               | add esp,24                                       |
008FB931         | 8B0D A0DBC000                         | mov ecx,dword ptr ds:[C0DBA0]                    |
008FB937         | 83EC 04                               | sub esp,4                                        |
008FB93A         | 890C24                                | mov dword ptr ss:[esp],ecx                       |
008FB93D         | FF15 2C45C200                         | call dword ptr ds:[<&UpdateWindow>]              |
008FB943         | C705 60F8C100 00000000                | mov dword ptr ds:[C1F860],0                      |
008FB94D         | EB 0F                                 | jmp pirates!.8FB95E                              |
008FB94F         | 8B15 60F8C100                         | mov edx,dword ptr ds:[C1F860]                    |
008FB955         | 83C2 01                               | add edx,1                                        |
008FB958         | 8915 60F8C100                         | mov dword ptr ds:[C1F860],edx                    |
008FB95E         | A1 60F8C100                           | mov eax,dword ptr ds:[C1F860]                    |
008FB963         | 3B05 ECEBC100                         | cmp eax,dword ptr ds:[C1EBEC]                    |
008FB969         | 7D 7D                                 | jge pirates!.8FB9E8                              |
008FB96B         | 8B0D 60F8C100                         | mov ecx,dword ptr ds:[C1F860]                    |
008FB971         | 3B0D E8EBC100                         | cmp ecx,dword ptr ds:[C1EBE8]                    | 00C1EBE8:&"???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
008FB977         | 75 0F                                 | jne pirates!.8FB988                              |  is taken when good - booo taken when bad too
008FB979         | 8B15 60F8C100                         | mov edx,dword ptr ds:[C1F860]                    |
008FB97F         | 83C2 04                               | add edx,4                                        |
008FB982         | 8915 60F8C100                         | mov dword ptr ds:[C1F860],edx                    |
008FB988         | A1 7845C200                           | mov eax,dword ptr ds:[C24578]                    |
008FB98D         | 0305 60F8C100                         | add eax,dword ptr ds:[C1F860]                    |
008FB993         | 33C9                                  | xor ecx,ecx                                      |
008FB995         | 8A08                                  | mov cl,byte ptr ds:[eax]                         |

"/NYF"  <--- wrong value 00ADCB8C  2F 4E 59 46 00 00 00 00 00 00 00 00 00 00 00 00  /NYF............  

009B22A1 WriteProcessMemory writes after the above


00B28D22         | A1 B8D4C100                           | mov eax,dword ptr ds:[C1D4B8]                    |
00B28D27         | 33DB                                  | xor ebx,ebx                                      |
00B28D29         | 385E 01                               | cmp byte ptr ds:[esi+1],bl                       |
00B28D2C         | 0F94C3                                | sete bl                                          |
00B28D2F         | 3B05 BCD4C100                         | cmp eax,dword ptr ds:[C1D4BC]                    |
00B28D35         | 75 0C                                 | jne pirates!.B28D43                              |


+7C0 Search
0056A149                                          | 8B82 C0070000                         | mov eax,dword ptr ds:[edx+7C0]                  |
0056A14F                                          | 83E0 01                               | and eax,1                                       |
0056A152                                          | 85C0                                  | test eax,eax                                    |
0056A154                                          | 74 23                                 | je maxpayne2.56A179                             |


008FBFC9         | 8B88 C0070000                         | mov ecx,dword ptr ds:[eax+7C0]                   | eax+7C0:TpCallbackIndependent+900

008FC177         | 8B8D 74FEFFFF                         | mov ecx,dword ptr ss:[ebp-18C]                   |
008FC17D         | 8B91 E0070000                         | mov edx,dword ptr ds:[ecx+7E0]                   |
008FC183         | 8995 28FFFFFF                         | mov dword ptr ss:[ebp-D8],edx                    |
008FC189         | 8B85 74FEFFFF                         | mov eax,dword ptr ss:[ebp-18C]                   | eax:TpCallbackIndependent+140
008FC18F         | 8B88 C0070000                         | mov ecx,dword ptr ds:[eax+7C0]                   | eax+7C0:TpCallbackIndependent+900
008FC195         | 83E1 01                               | and ecx,1                                        |
008FC198         | 83EC 04                               | sub esp,4                                        |

008FCC81         | 8B88 C0070000                         | mov ecx,dword ptr ds:[eax+7C0]                   | eax+7C0:TpCallbackIndependent+900


008FCD23         | 8B85 74FEFFFF                         | mov eax,dword ptr ss:[ebp-18C]                   | eax:TpCallbackIndependent+140
008FCD29         | 8B88 C0070000                         | mov ecx,dword ptr ds:[eax+7C0]                   | eax+7C0:TpCallbackIndependent+900
008FCD2F         | C1E9 04                               | shr ecx,4                                        |
008FCD32         | 83E1 01                               | and ecx,1                                        |
008FCD35         | 83EC 04                               | sub esp,4                                        |
008FCD38         | 892C24                                | mov dword ptr ss:[esp],ebp                       | [esp]:TpCallbackIndependent+478
008FCD3B         | 8BE9                                  | mov ebp,ecx                                      |

009FFB00         | 8B45 F4                               | mov eax,dword ptr ss:[ebp-C]                     | eax:TpCallbackIndependent+140, [ebp-0C]:wcstombs+70
009FFB03         | 8B88 C0070000                         | mov ecx,dword ptr ds:[eax+7C0]                   | eax+7C0:TpCallbackIndependent+900
009FFB09         | 83E1 01                               | and ecx,1                                        |
009FFB0C         | 83EC 04                               | sub esp,4                                        |
009FFB0F         | 893C24                                | mov dword ptr ss:[esp],edi                       | [esp]:TpCallbackIndependent+478
009FFB12         | 8BF9                                  | mov edi,ecx                                      |
009FFB14         | 23F9                                  | and edi,ecx                                      |
009FFB16         | 5F                                    | pop edi                                          |
009FFB17         | 9C                                    | pushfd                                           |

009FFC98         | 8B45 F4                               | mov eax,dword ptr ss:[ebp-C]                     | eax:TpCallbackIndependent+140, [ebp-0C]:wcstombs+70
009FFC9B         | 8B88 C0070000                         | mov ecx,dword ptr ds:[eax+7C0]                   | eax+7C0:TpCallbackIndependent+900
009FFCA1         | 83E1 01                               | and ecx,1                                        |
009FFCA4         | 83EC 04                               | sub esp,4                                        |
009FFCA7         | 892C24                                | mov dword ptr ss:[esp],ebp                       | [esp]:TpCallbackIndependent+478

00A00303         | 8B82 C0070000                         | mov eax,dword ptr ds:[edx+7C0]                   | eax:TpCallbackIndependent+140
00A00309         | C1E8 04                               | shr eax,4                                        | eax:TpCallbackIndependent+140
00A0030C         | 83E0 01                               | and eax,1                                        | eax:TpCallbackIndependent+140
00A0030F         | 83EC 04                               | sub esp,4                                        |
00A00312         | 891C24                                | mov dword ptr ss:[esp],ebx                       | [esp]:TpCallbackIndependent+478
00A00315         | 8BD8                                  | mov ebx,eax                                      | eax:TpCallbackIndependent+140

00ADA2CA         | 8B55 F4                               | mov edx,dword ptr ss:[ebp-C]                     | [ebp-0C]:wcstombs+70
00ADA2CD         | 8B82 C0070000                         | mov eax,dword ptr ds:[edx+7C0]                   | eax:TpCallbackIndependent+140
00ADA2D3         | 8B4D 10                               | mov ecx,dword ptr ss:[ebp+10]                    |
00ADA2D6         | 8901                                  | mov dword ptr ds:[ecx],eax                       | eax:TpCallbackIndependent+140
00ADA2D8         | 837D 14 00                            | cmp dword ptr ss:[ebp+14],0                      | [ebp+14]:RtlInitializeExceptionChain+6B
00ADA2DC         | 74 2F                                 | je pirates!.ADA30D                               |

----------------------------
After a CD Retry and putting the new CD in it goes here when good and not when bad:

008FCBCD         | C74424 20 2F425FAD                    | mov dword ptr ss:[esp+20],AD5F422F               |
008FCBD5         | C74424 1C 58000000                    | mov dword ptr ss:[esp+1C],58                     | 58:'X'
008FCBDD         | 894C24 18                             | mov dword ptr ss:[esp+18],ecx                    |
008FCBE1         | B9 8CCB8F00                           | mov ecx,pirates!.8FCB8C                          |
008FCBE6         | C14C24 20 18                          | ror dword ptr ss:[esp+20],18                     |
008FCBEB         | 895424 14                             | mov dword ptr ss:[esp+14],edx                    |
008FCBEF         | 8B11                                  | mov edx,dword ptr ds:[ecx]                       |
008FCBF1         | 015424 20                             | add dword ptr ss:[esp+20],edx                    |
008FCBF5         | 83C1 04                               | add ecx,4                                        |
008FCBF8         | 66:FF4C24 1C                          | dec word ptr ss:[esp+1C]                         |
008FCBFD         | 75 F0                                 | jne pirates!.8FCBEF                              |
008FCBFF         | 804C24 20 01                          | or byte ptr ss:[esp+20],1                        |
008FCC04         | 8B4C24 20                             | mov ecx,dword ptr ss:[esp+20]                    |
008FCC08         | 81F9 B5270000                         | cmp ecx,27B5                                     |
008FCC0E         | 74 01                                 | je pirates!.8FCC11                               |
008FCC10         | CC                                    | int3                                             |
008FCC11         | 8B4C24 24                             | mov ecx,dword ptr ss:[esp+24]                    |
008FCC15         | 8B5424 20                             | mov edx,dword ptr ss:[esp+20]                    |


Max Payne 2:
00575C50         | E8 5BAE0000                           | call <maxpayne2.sub_580AB0>                      |
00575C55         | 83C4 08                               | add esp,8                                        |
00575C58         | E9 BB010000                           | jmp maxpayne2.575E18                             |
00575C5D         | C705 ACBA6400 00000000                | mov dword ptr ds:[64BAAC],0                      |
00575C67         | C705 BC526400 15000000                | mov dword ptr ds:[6452BC],15                     |
00575C71         | EB 0D                                 | jmp maxpayne2.575C80                             |
00575C73         | A1 BC526400                           | mov eax,dword ptr ds:[6452BC]                    |
00575C78         | 83C0 01                               | add eax,1                                        |
00575C7B         | A3 BC526400                           | mov dword ptr ds:[6452BC],eax                    |
00575C80         | 813D BC526400 00020000                | cmp dword ptr ds:[6452BC],200                    | 813D ??????00 00020000
00575C8A         | 7D 1B                                 | jge maxpayne2.575CA7                             |
00575C8C         | 8B0D BC526400                         | mov ecx,dword ptr ds:[6452BC]                    | ecx:EntryPoint
00575C92         | 8B15 ACBA6400                         | mov edx,dword ptr ds:[64BAAC]                    | edx:EntryPoint
00575C98         | 03148D E0E66400                       | add edx,dword ptr ds:[ecx*4+64E6E0]              | edx:EntryPoint   03148D <--- search?
00575C9F         | 8915 ACBA6400                         | mov dword ptr ds:[64BAAC],edx                    | edx:EntryPoint
00575CA5         | EB CC                                 | jmp maxpayne2.575C73                             |
00575CA7         | A1 78FB5900                           | mov eax,dword ptr ds:[59FB78]                    |
00575CAC         | 3B05 ACBA6400                         | cmp eax,dword ptr ds:[64BAAC]                    |
00575CB2         | 0F85 89000000                         | jne maxpayne2.575D41                             |     <-------- JNE
00575CB8         | 68 E0E66400                           | push maxpayne2.64E6E0                            |
00575CBD         | E8 3E44FFFF                           | call <maxpayne2.sub_56A100>                      |
00575CC2         | 83C4 04                               | add esp,4                                        |
00575CC5         | 85C0                                  | test eax,eax                                     |
00575CC7         | 74 78                                 | je maxpayne2.575D41                              |     <------- JE
00575CC9         | 68 00080000                           | push 800                                         | 68 00080000 68 ???????? 68
00575CCE         | 68 E0E66400                           | push maxpayne2.64E6E0                            |
00575CD3         | 68 60C96400                           | push maxpayne2.64C960                            |
00575CD8         | E8 F3D00100                           | call <maxpayne2.sub_592DD0>                      |
00575CDD         | 83C4 0C                               | add esp,C                                        |
00575CE0         | 833D A0015C00 00                      | cmp dword ptr ds:[5C01A0],0                      |  83C4 0C 833D ???????? 00 74
00575CE7         | 74 46                                 | je maxpayne2.575D2F                              |
00575CE9         | 8B0D ACBA6400                         | mov ecx,dword ptr ds:[64BAAC]                    | ecx:EntryPoint
00575CEF         | 51                                    | push ecx                                         | ecx:EntryPoint
00575CF0         | 8B15 ACBA6400                         | mov edx,dword ptr ds:[64BAAC]                    | edx:EntryPoint
00575CF6         | 52                                    | push edx                                         | edx:EntryPoint
00575CF7         | A1 78FB5900                           | mov eax,dword ptr ds:[59FB78]                    |
00575CFC         | 50                                    | push eax                                         |
00575CFD         | 8B0D 78FB5900                         | mov ecx,dword ptr ds:[59FB78]                    | ecx:EntryPoint
00575D03         | 51                                    | push ecx                                         | ecx:EntryPoint
00575D04         | 8B15 A0576400                         | mov edx,dword ptr ds:[6457A0]                    | edx:EntryPoint
00575D0A         | 83C2 61                               | add edx,61                                       | edx:EntryPoint
00575D0D         | 52                                    | push edx                                         | edx:EntryPoint
00575D0E         | 68 ECE05D00                           | push maxpayne2.5DE0EC                            | 5DE0EC:"7001CF466CF02D46F66257685D24B85BB3EAE5BFFE976340E083D65C9411775BDB90CF2F8BEB728AF9F8{%c}0A768E9E18E469C7029286529DFDE96753B57859E2C23968A35BC193BAE8A2DCEF79D06FE195C00C7B50A241A93D6AFCB896F4C4FAF31E63{%lu}900866012CED3BBD{%08x}963C7619B036D649E989785690AA3D7F1452D62E99B8A30F5FA9E4794B68479A{%lu}900866012CED3BBD{%08x}5185EEF873391C9B014D20FAFBE913D0EB4C80ADE9F1F3B1A1D837D692A74D0F"
00575D13         | 68 C06A6400                           | push maxpayne2.646AC0                            |
00575D18         | E8 43D50100                           | call <maxpayne2.sub_593260>                      |
00575D1D         | 83C4 1C                               | add esp,1C                                       |
00575D20         | 68 C06A6400                           | push maxpayne2.646AC0                            |


Driv3r:
00973668         | C705 8CCBAD00 00000000                | mov dword ptr ds:[ADCB8C],0                      |
00973672         | C705 FC75AD00 15000000                | mov dword ptr ds:[AD75FC],15                     | C705 ???????? 15000000 
0097367C         | EB 0F                                 | jmp driv3r.97368D                                |
0097367E         | 8B0D FC75AD00                         | mov ecx,dword ptr ds:[AD75FC]                    |
00973684         | 83C1 01                               | add ecx,1                                        |
00973687         | 890D FC75AD00                         | mov dword ptr ds:[AD75FC],ecx                    |
0097368D         | 813D FC75AD00 00020000                | cmp dword ptr ds:[AD75FC],200                    | 813D FC75AD00 00020000
00973697         | 7D 19                                 | jge driv3r.9736B2                                |
00973699         | 8B15 FC75AD00                         | mov edx,dword ptr ds:[AD75FC]                    |
0097369F         | A1 8CCBAD00                           | mov eax,dword ptr ds:[ADCB8C]                    |
009736A4         | 030495 A0F5AD00                       | add eax,dword ptr ds:[edx*4+ADF5A0]              |
009736AB         | A3 8CCBAD00                           | mov dword ptr ds:[ADCB8C],eax                    |
009736B0         | EB CC                                 | jmp driv3r.97367E                                |
009736B2         | 8B0D A86B9D00                         | mov ecx,dword ptr ds:[9D6BA8]                    |
009736B8         | 3B0D 8CCBAD00                         | cmp ecx,dword ptr ds:[ADCB8C]                    |
009736BE         | 0F85 A3000000                         | jne driv3r.973767                                |         <----- jne
009736C4         | 68 A0F5AD00                           | push driv3r.ADF5A0                               |
009736C9         | E8 2247FFFF                           | call driv3r.967DF0                               |
009736CE         | 83C4 04                               | add esp,4                                        |
009736D1         | 85C0                                  | test eax,eax                                     |
009736D3         | 0F84 8E000000                         | je driv3r.973767                                 |         <----- je
009736D9         | 68 00080000                           | push 800                                         |
009736DE         | 68 A0F5AD00                           | push driv3r.ADF5A0                               |
009736E3         | 68 40DAAD00                           | push driv3r.ADDA40                               |
009736E8         | E8 43540500                           | call driv3r.9C8B30                               |


---
00AAA7BC         | 03148D C010C200                       | add edx,dword ptr ds:[ecx*4+C210C0]              |   <---- hits this one a retry

00AAA4F4         | C705 60F8C100 15000000                | mov dword ptr ds:[C1F860],15                     |   <---- hits this one a retry

C705 ???????? 15000000 

00AA1D47 | 68 B9380000                          | push 38B9                                                          |
00AA1D4C | 78 10                                | js pirates!.AA1D5E                                                 |
00AA1D4E | 810424 F420A000                      | add dword ptr ss:[esp],pirates!.A020F4                             |
00AA1D55 | 810424 C3C30900                      | add dword ptr ss:[esp],9C3C3                                       |
00AA1D5C | EB FA                                | jmp pirates!.AA1D58                                                |
00AA1D5E | 810424 1C96A000                      | add dword ptr ss:[esp],pirates!.A0961C                             |
00AA1D65 | 810424 C34E0900                      | add dword ptr ss:[esp],94EC3                                       |
00AA1D6C | EB FA                                | jmp pirates!.AA1D68                                                |
00AA1D6E | AD                                   | lodsd                                                              |
00AA1D6F | 4A                                   | dec edx                                                            |
00AA1D70 | C705 50DCC100 00000000               | mov dword ptr ds:[C1DC50],0                                        |
00AA1D7A | C705 60F8C100 15000000               | mov dword ptr ds:[C1F860],15                                       |
00AA1D84 | 83EC 04                              | sub esp,4                                                          |
00AA1D87 | C70424 2EB09C00                      | mov dword ptr ss:[esp],pirates!.9CB02E                             |
00AA1D8E | 810424 C36E0D00                      | add dword ptr ss:[esp],D6EC3                                       |
00AA1D95 | EB FA                                | jmp pirates!.AA1D91                                                |
00AA1D97 | D7                                   | xlat                                                               |
00AA1D98 | C705 50DCC100 00000000               | mov dword ptr ds:[C1DC50],0                                        |
00AA1DA2 | C705 60F8C100 15000000               | mov dword ptr ds:[C1F860],15                                       |
00AA1DAC | 83EC 04                              | sub esp,4                                                          |
00AA1DAF | C70424 2E439E00                      | mov dword ptr ss:[esp],pirates!.9E432E                             |
00AA1DB6 | 810424 C3DB0B00                      | add dword ptr ss:[esp],BDBC3                                       |

0x{p:cip} {i:cip}


When good we end up here:
00B20AC1         | 0F85 F4000000                         | jne pirates!.B20BBB                              |
and then - all hit when all goes well
00ADBD37         | 0F85 B4000000                         | jne pirates!.ADBDF1                              |
00ADC424         | 0F85 B4000000                         | jne pirates!.ADC4DE                              |
00ADC1DD         | 0F85 B4000000                         | jne pirates!.ADC297                              |
00ADBD37         | 0F85 B4000000                         | jne pirates!.ADBDF1                              |

---------------------------
Fixing CRCs




00AA5857         | 3E:8B15 20E2C100                      | mov edx,dword ptr ds:[C1E220]                    |
00AA585E         | 8915 1032C200                         | mov dword ptr ds:[C23210],edx                    |
00AA5864         | A1 1032C200                           | mov eax,dword ptr ds:[C23210]                    |
00AA5869         | 83EC 04                               | sub esp,4                                        |
00AA586C         | 890424                                | mov dword ptr ss:[esp],eax                       | [esp]:EndDialog+439
00AA586F         | B8 E30FD1E0                           | mov eax,E0D10FE3                                 |
00AA5874         | 73 FC                                 | jae pirates!.AA5872                              |

Jackpot:
EDC1 | 00AAA9F4 | 2B05 50DCC100            | sub eax,dword ptr ds:[C1DC50]                                   | eax: 41956D9-> BDC008AA eflags: 202-> 297         | 00C1DC50: 46594E2F-> 46594E2F       | 00C1DC50:"/NYF"
EE15 | 00AAB880 | 8B10                     | mov edx,dword ptr ds:[eax]                                      | edx: 46594E2F-> 1740000                           | 00AAB828: 1740000-> 1740000         |
EE14 | 00AAB87C | 895424 08                | mov dword ptr ss:[esp+8],edx                                    |                                                   | 0019F2C0: 404120-> 46594E2F         |
EE27 | 00AAB8B5 | 8B5424 08                | mov edx,dword ptr ss:[esp+8]                                    | edx: E14-> 46594E2F                               | 0019F2C0: 46594E2F-> 46594E2F       |
ED59 | 00AAA7C3 | 8915 50DCC100            | mov dword ptr ds:[C1DC50],edx                                   |                                                   | 00C1DC50: B382BA7E-> 46594E2F       | 00C1DC50:"/NYF"

2B05 ???????? 8b10

"/NYF"  <--- wrong value 00ADCB8C  2F 4E 59 46 00 00 00 00 00 00 00 00 00 00 00 00  /NYF............  

Calc'ing the value
00AAA7C3         | 8915 50DCC100                         | mov dword ptr ds:[C1DC50],edx                    | 00C1DC50:"/NYF"
00AAA7C9         | 83EC 04                               | sub esp,4                                        |
00AAA7CC         | C70424 BF83A100                       | mov dword ptr ss:[esp],<pirates!.sub_A183BF>     |  C70424 ???????? 810424
00AAA7D3         | 810424 C3210900                       | add dword ptr ss:[esp],921C3                     |
00AAA7DA         | EB FA                                 | jmp pirates!.AAA7D6                              |

Maybe comparing with a sub?
00AAA9EF         | 890424                                | mov dword ptr ss:[esp],eax                       |
00AAA9F2         | 8BC0                                  | mov eax,eax                                      |
00AAA9F4         | 2B05 50DCC100                         | sub eax,dword ptr ds:[C1DC50]                    | 00C1DC50:"/NYF"  Good value is: 041956D9 00C1DC50  D9 56 19 04 00 00 00 00 00 00 00 00 00 00 00 00  ÙV..............  

00ADCB8C:"/NYF"  <--- wrong value 00ADCB8C  2F 4E 59 46 00 00 00 00 00 00 00 00 00 00 00 00  /NYF............  

CD Check 1
00AAA9FA         | 58                                    | pop eax                                          |
00AAA9FB         | 68 FC030000                           | push 3FC                                         |
00AAAA00         | 75 12                                 | jne pirates!.AAAA14                              |  <---- so this should be NOP'd to always match
^ but only does it once!

When nop'd goes here:
00AAAA8B         | 810424 82000000                       | add dword ptr ss:[esp],82                        | [esp]:sub_AAAA78+9
then goes here:
009FF55C         | 68 9D1B0000                           | push 1B9D                                        |


Gets to here:
009FF69A         | 810424 81000000                       | add dword ptr ss:[esp],81                        | [esp]:EndDialog+439

This func ends up with 46594E2F in eax
00ADF780         | 55                                    | push ebp                                         |
00ADF781         | 8BEC                                  | mov ebp,esp                                      |
00ADF783         | 83EC 0C                               | sub esp,C                                        |
00ADF786         | 8B45 08                               | mov eax,dword ptr ss:[ebp+8]                     |
00ADF789         | 8945 FC                               | mov dword ptr ss:[ebp-4],eax                     |
00ADF78C         | C745 F8 00000000                      | mov dword ptr ss:[ebp-8],0                       |
00ADF793         | C745 F4 00000000                      | mov dword ptr ss:[ebp-C],0                       |
00ADF79A         | EB 09                                 | jmp pirates!.ADF7A5                              |
00ADF79C         | 8B4D F4                               | mov ecx,dword ptr ss:[ebp-C]                     |
00ADF79F         | 83C1 01                               | add ecx,1                                        |
00ADF7A2         | 894D F4                               | mov dword ptr ss:[ebp-C],ecx                     |
00ADF7A5         | 8B55 0C                               | mov edx,dword ptr ss:[ebp+C]                     |
00ADF7A8         | C1EA 02                               | shr edx,2                                        |
00ADF7AB         | 3955 F4                               | cmp dword ptr ss:[ebp-C],edx                     |
00ADF7AE         | 73 11                                 | jae pirates!.ADF7C1                              |
00ADF7B0         | 8B45 F4                               | mov eax,dword ptr ss:[ebp-C]                     |
00ADF7B3         | 8B4D FC                               | mov ecx,dword ptr ss:[ebp-4]                     |
00ADF7B6         | 8B1481                                | mov edx,dword ptr ds:[ecx+eax*4]                 |
00ADF7B9         | 0355 F8                               | add edx,dword ptr ss:[ebp-8]                     |
00ADF7BC         | 8955 F8                               | mov dword ptr ss:[ebp-8],edx                     |
00ADF7BF         | EB DB                                 | jmp pirates!.ADF79C                              |
00ADF7C1         | 8B45 F8                               | mov eax,dword ptr ss:[ebp-8]                     |
00ADF7C4         | 8BE5                                  | mov esp,ebp                                      |
00ADF7C6         | 5D                                    | pop ebp                                          |
00ADF7C7         | C3                                    | ret                                              |  

After the function it does some heavy checks ?
00ADF844         | 83C4 08                               | add esp,8                                        |
00ADF847         | 8945 F8                               | mov dword ptr ss:[ebp-8],eax                     |  eax = 041956D9
00ADF84A         | 8B55 FC                               | mov edx,dword ptr ss:[ebp-4]                     |  edx = 00C210C0
00ADF84D         | 8B82 BC070000                         | mov eax,dword ptr ds:[edx+7BC]                   |  eax = 964F98FE
00ADF853         | 3345 F8                               | xor eax,dword ptr ss:[ebp-8]                     |  eax = 9256CE27
00ADF856         | 8B4D FC                               | mov ecx,dword ptr ss:[ebp-4]                     |  ecx = 00C210C0
00ADF859         | 3381 E4070000                         | xor eax,dword ptr ds:[ecx+7E4]                   |  eax = 1234ABCD
00ADF85F         | 3D CDAB3412                           | cmp eax,1234ABCD                                 |  
00ADF864         | 75 09                                 | jne pirates!.ADF86F                              |  not taken
00ADF866         | 8B55 F0                               | mov edx,dword ptr ss:[ebp-10]                    |  edx = 0
00ADF869         | 83CA 01                               | or edx,1                                         |  edx = 1
00ADF86C         | 8955 F0                               | mov dword ptr ss:[ebp-10],edx                    |
00ADF86F         | 8B45 FC                               | mov eax,dword ptr ss:[ebp-4]                     |  eax = 00C210C0
00ADF872         | 8B88 C8070000                         | mov ecx,dword ptr ds:[eax+7C8]                   |  edx = D2F2FEC9
00ADF878         | 334D F8                               | xor ecx,dword ptr ss:[ebp-8]                     |  ecx = D6EBA810
00ADF87B         | 8B55 FC                               | mov edx,dword ptr ss:[ebp-4]                     |  edx = 00C210C0 
00ADF87E         | 338A E4070000                         | xor ecx,dword ptr ds:[edx+7E4]                   |  ecx = 5689CDFA
00ADF884         | 81F9 FACD8956                         | cmp ecx,5689CDFA                                 |
00ADF88A         | 75 08                                 | jne pirates!.ADF894                              |   not taken
00ADF88C         | 8B45 F0                               | mov eax,dword ptr ss:[ebp-10]                    |
00ADF88F         | 0C 02                                 | or al,2                                          |
00ADF891         | 8945 F0                               | mov dword ptr ss:[ebp-10],eax                    |
00ADF894         | 8B4D FC                               | mov ecx,dword ptr ss:[ebp-4]                     |
00ADF897         | 8B91 D8070000                         | mov edx,dword ptr ds:[ecx+7D8]                   |
00ADF89D         | 3355 F8                               | xor edx,dword ptr ss:[ebp-8]                     |
00ADF8A0         | 8B45 FC                               | mov eax,dword ptr ss:[ebp-4]                     |
00ADF8A3         | 3390 E4070000                         | xor edx,dword ptr ds:[eax+7E4]                   |
00ADF8A9         | 81FA E0AC3265                         | cmp edx,6532ACE0                                 |
00ADF8AF         | 75 09                                 | jne pirates!.ADF8BA                              |   not taken
00ADF8B1         | 8B4D F0                               | mov ecx,dword ptr ss:[ebp-10]                    |
00ADF8B4         | 83C9 04                               | or ecx,4                                         |
00ADF8B7         | 894D F0                               | mov dword ptr ss:[ebp-10],ecx                    |
00ADF8BA         | 837D 0C 00                            | cmp dword ptr ss:[ebp+C],0                       |
00ADF8BE         | 74 08                                 | je pirates!.ADF8C8                               |  is taken
00ADF8C0         | 8B55 0C                               | mov edx,dword ptr ss:[ebp+C]                     |
00ADF8C3         | 8B45 F8                               | mov eax,dword ptr ss:[ebp-8]                     |
00ADF8C6         | 8902                                  | mov dword ptr ds:[edx],eax                       |
00ADF8C8         | 6A 30                                 | push 30                                          |
00ADF8CA         | 8B4D FC                               | mov ecx,dword ptr ss:[ebp-4]                     |   00C210C0
00ADF8CD         | 81C1 BC070000                         | add ecx,7BC                                      |   00C2187C   00C2187C  FE 98 4F 96 08 00 00 00 00 00 00 00 C9 FE F2 D2  þ.O.........ÉþòÒ  
00ADF8D3         | 51                                    | push ecx                                         |
00ADF8D4         | E8 F7FEFFFF                           | call pirates!.ADF7D0                             |  returns eax = 196A5A74
00ADF8D9         | 83C4 08                               | add esp,8                                        |
00ADF8D9         | 83C4 08                               | add esp,8                                        |
00ADF8DC         | 8945 F4                               | mov dword ptr ss:[ebp-C],eax                     |
00ADF8DF         | 8B55 FC                               | mov edx,dword ptr ss:[ebp-4]                     |
00ADF8E2         | 8B45 F4                               | mov eax,dword ptr ss:[ebp-C]                     |
00ADF8E5         | 3B82 EC070000                         | cmp eax,dword ptr ds:[edx+7EC]                   |   edx+7EC = 00C218AC  74 5A 6A 19 00 00 00 01 FE B6 02 01 FE B6 02 00  tZj.....þ¶..þ¶..  
00ADF8EB         | 75 09                                 | jne pirates!.ADF8F6                              |   not taken
00ADF8ED         | 8B4D F0                               | mov ecx,dword ptr ss:[ebp-10]                    |   
00ADF8F0         | 83C9 08                               | or ecx,8                                         |
00ADF8F3         | 894D F0                               | mov dword ptr ss:[ebp-10],ecx                    |
00ADF8F6         | 8B45 F0                               | mov eax,dword ptr ss:[ebp-10]                    |  0xF
00ADF8F9         | 8BE5                                  | mov esp,ebp                                      |
00ADF8FB         | 5D                                    | pop ebp                                          |
00ADF8FC         | C3                                    | ret                                              |

00AAAE6E         | 810424 1BE99C00                       | add dword ptr ss:[esp],pirates!.9CE91B           |
00AAAE75         | 810424 C3A90D00                       | add dword ptr ss:[esp],DA9C3                     |
00AAAE7C         | EB FA                                 | jmp pirates!.AAAE78                              |
00AAAE7E         | 5F                                    | pop edi                                          |  5F 8B?? ???????? 83EC 04
00AAAE7F         | 8B0D 50DCC100                         | mov ecx,dword ptr ds:[C1DC50]                    | 00C1DC50:"/NYF"
00AAAE85         | 83EC 04                               | sub esp,4                                        |
00AAAE88         | 890C24                                | mov dword ptr ss:[esp],ecx                       |
00AAAE8B         | 8B15 50DCC100                         | mov edx,dword ptr ds:[C1DC50]                    | 00C1DC50:"/NYF"
00AAAE91         | 83EC 04                               | sub esp,4                                        |  8B?? ???????? 83EC0489??24 8B?? ???????? 83EC0489??24
00AAAE94         | 891424                                | mov dword ptr ss:[esp],edx                       |
00AAAE97         | A1 A8BBB200                           | mov eax,dword ptr ds:[B2BBA8]                    |
00AAAE9C         | 83EC 04                               | sub esp,4                                        |
00AAAE9F         | 890424                                | mov dword ptr ss:[esp],eax                       |
00AAAEA2         | 8B0D A8BBB200                         | mov ecx,dword ptr ds:[B2BBA8]                    |
00AAAEA8         | 83EC 04                               | sub esp,4                                        |
00AAAEAB         | 890C24                                | mov dword ptr ss:[esp],ecx                       | 8b15 ???????? 83EC 04  891424
00AAAEAE         | 8B15 1032C200                         | mov edx,dword ptr ds:[C23210]                    |

Good value might be stored here:
00B2BBA8  D9 56 19 04 00 00 00 00 00 00 00 00 00 00 00 00  ÙV..............  
00B63F08  D9 56 19 04 08 45 34 77 29 6D 42 BE 21 E4 2C 07  ÙV...E4w)mB¾!ä,.  
00C23CC8  D9 56 19 04 08 45 34 77 29 6D 42 BE 21 E4 2C 07  ÙV...E4w)mB¾!ä,.  <--- not used?


009FF96F         | 8B5424 14                             | mov edx,dword ptr ss:[esp+14]                    |
009FF973         | 896424 14                             | mov dword ptr ss:[esp+14],esp                    |
009FF977         | 834424 14 24                          | add dword ptr ss:[esp+14],24                     |
009FF97C         | 2BC8                                  | sub ecx,eax                                      |    <---- worth checking out ?
009FF97E         | 8B4424 18                             | mov eax,dword ptr ss:[esp+18]                    |
009FF982         | 8B6424 14                             | mov esp,dword ptr ss:[esp+14]                    |
009FF986         | 59                                    | pop ecx                                          |
009FF987         | 68 87360000                           | push 3687                                        |
009FF98C         | 74 11                                 | je pirates!.9FF99F                               |

009FFC98         | 8B45 F4                               | mov eax,dword ptr ss:[ebp-C]                     |
009FFC9B         | 8B88 C0070000                         | mov ecx,dword ptr ds:[eax+7C0]                   |   <---- if I make this 0 it at least goes and gets the TOC (although should be 08???)
009FFCA1         | 83E1 01                               | and ecx,1                                        |
009FFCA4         | 83EC 04                               | sub esp,4                                        |
009FFCA7         | 892C24                                | mov dword ptr ss:[esp],ebp                       |
009FFCAA         | 8BE9                                  | mov ebp,ecx                                      |

00AAAB4B         | 68 C010C200                           | push pirates!.C210C0                             |
00AAAB50         | 68 C008C200                           | push pirates!.C208C0                             |
00AAAB55         | E8 08000000                           | call pirates!.AAAB62                             |  <--- does this do the TOC call?

Then end up here:
00B1DB00         | 55                                    | push ebp                                         |
00B1DB01         | 8BEC                                  | mov ebp,esp                                      |
00B1DB03         | 57                                    | push edi                                         |
00B1DB04         | 56                                    | push esi                                         |
00B1DB05         | 8B75 0C                               | mov esi,dword ptr ss:[ebp+C]                     |
00B1DB08         | 8B4D 10                               | mov ecx,dword ptr ss:[ebp+10]                    |
00B1DB0B         | 8B7D 08                               | mov edi,dword ptr ss:[ebp+8]                     |
00B1DB0E         | 8BC1                                  | mov eax,ecx                                      |
00B1DB10         | 8BD1                                  | mov edx,ecx                                      |
00B1DB12         | 03C6                                  | add eax,esi                                      |
00B1DB14         | 3BFE                                  | cmp edi,esi                                      |
00B1DB16         | 76 08                                 | jbe pirates!.B1DB20                              |

Then here:
00AAAE6E         | 810424 1BE99C00                       | add dword ptr ss:[esp],pirates!.9CE91B           |
00AAAE75         | 810424 C3A90D00                       | add dword ptr ss:[esp],DA9C3                     |
00AAAE7C         | EB FA                                 | jmp pirates!.AAAE78                              |  <--- but we jmp
00AAAE7E         | 5F                                    | pop edi                                          |
00AAAE7F         | 8B0D 50DCC100                         | mov ecx,dword ptr ds:[C1DC50]                    | 00C1DC50:"/NYF"
00AAAE85         | 83EC 04                               | sub esp,4                                        |
00AAAE88         | 890C24                                | mov dword ptr ss:[esp],ecx                       |
00AAAE8B         | 8B15 50DCC100                         | mov edx,dword ptr ds:[C1DC50]                    | 00C1DC50:"/NYF"
00AAAE91         | 83EC 04                               | sub esp,4                                        |
00AAAE94         | 891424                                | mov dword ptr ss:[esp],edx                       |
00AAAE97         | A1 A8BBB200                           | mov eax,dword ptr ds:[B2BBA8]                    |
00AAAE9C         | 83EC 04                               | sub esp,4                                        |
00AAAE9F         | 890424                                | mov dword ptr ss:[esp],eax                       |
00AAAEA2         | 8B0D A8BBB200                         | mov ecx,dword ptr ds:[B2BBA8]                    |
00AAAEA8         | 83EC 04                               | sub esp,4                                        |
00AAAEAB         | 890C24                                | mov dword ptr ss:[esp],ecx                       |
00AAAEAE         | 8B15 1032C200                         | mov edx,dword ptr ds:[C23210]                    |
00AAAEB4         | 83EC 04                               | sub esp,4                                        |
00AAAEB7         | 891424                                | mov dword ptr ss:[esp],edx                       |
00AAAEBA         | BA 6105D1E2                           | mov edx,E2D10561                                 |
00AAAEBF         | 73 FC                                 | jae pirates!.AAAEBD                              |

Then goes to:
00AAB131         | 8B0D 44DCC000                         | mov ecx,dword ptr ds:[C0DC44]                    |  01040200
00AAB137         | 80CD 20                               | or ch,20                                         |  01042200
00AAB13A         | 890D 44DCC000                         | mov dword ptr ds:[C0DC44],ecx                    |
00AAB140         | 6A 00                                 | push 0                                           |
00AAB142         | E8 08000000                           | call pirates!.AAB14F                             |

Then to:
00A27139         | 83EC 04                               | sub esp,4                                        |
00A2713C         | 892C24                                | mov dword ptr ss:[esp],ebp                       | [esp]:EndDialog+439
00A2713F         | 8BEC                                  | mov ebp,esp                                      |
00A27141         | E8 07000000                           | call pirates!.A2714D                             |

After a lot of tracing - TOC done now:
00A0965E         | 90                                    | nop                                              |

trace into:
0x{p:cip} {i:cip}


Never goes here either:
47A54 | 00A097A6 | 66:FF4C24 1C             | dec word ptr ss:[esp+1C]                |                                                   | 0019F2A8: 51-> 50                                 |
47A55 | 00A097AB | 90                       | nop                                     |                                                   |                                                   |
47A56 | 00A097AC | 90                       | nop                                     |                                                   |                                                   |
47A57 | 00A097AD | 804C24 20 01             | or byte ptr ss:[esp+20],1               |                                                   | 0019F2AC: 2877-> 2877                             |
47A58 | 00A097B2 | 8B5424 20                | mov edx,dword ptr ss:[esp+20]           | edx: A09748-> 2877                                | 0019F2AC: 2877-> 2877                             |
47A59 | 00A097B6 | 81FA 77280000            | cmp edx,2877                            | eflags: 206-> 246                                 |                                                   |
47A5A | 00A097BC | 74 01                    | je pirates!.A097BF                      |                                                   |                                                   |
47A5B | 00A097BF | 8B5424 24                | mov edx,dword ptr ss:[esp+24]           | edx: 2877-> 206                                   | 0019F2B0: 206-> 206                               |
47A5C | 00A097C3 | 8B7424 20                | mov esi,dword ptr ss:[esp+20]           | esi: EB0003E2-> 2877                              | 0019F2AC: 2877-> 2877                             |
47A5D | 00A097C7 | 895424 20                | mov dword ptr ss:[esp+20],edx           |                                                   | 0019F2AC: 2877-> 206                              |
47A5E | 00A097CB | 8B5424 18                | mov edx,dword ptr ss:[esp+18]           | edx: 206-> B2BBF8                                 | 0019F2A4: B2BBF8-> B2BBF8                         |
47A5F | 00A097CF | 897424 24                | mov dword ptr ss:[esp+24],esi           |                                                   | 0019F2B0: 206-> 2877                              |
47A60 | 00A097D3 | 8B7424 14                | mov esi,dword ptr ss:[esp+14]           | esi: 2877-> 404120                                | 0019F2A0: 404120-> 404120                         |
47A61 | 00A097D7 | 83C4 20                  | add esp,20                              | esp: 19F28C-> 19F2AC eflags: 246-> 206            |                                                   |
47A62 | 00A097DA | 9D                       | popfd                                   | esp: 19F2AC-> 19F2B0                              | 0019F2AC: 206-> 206                               |
47A63 | 00A097DB | 72 11                    | jb pirates!.A097EE                      |                                                   |                                                   |
47A64 | 00A097DD | 810424 17639400          | add dword ptr ss:[esp],pirates!.946317  |                                                   | 0019F2B0: 2877-> 948B8E                           |
47A65 | 00A097E4 | 810424 C30C0C00          | add dword ptr ss:[esp],C0CC3            | eflags: 206-> 212                                 | 0019F2B0: 948B8E-> A09851                         |
47A66 | 00A097EB | EB FA                    | jmp pirates!.A097E7                     |                                                   |                                                   |
47A67 | 00A097E7 | C3                       | ret                                     | esp: 19F2B0-> 19F2B4                              | 0019F2B0: A09851-> A09851                         |
47A68 | 00A09851 | 8BE5                     | mov esp,ebp                             | esp: 19F2B4-> 19F2B8                              |                                                   |
47A69 | 00A09853 | 8B2C24                   | mov ebp,dword ptr ss:[esp]              | ebp: 19F2B8-> 19F2D8                              | 0019F2B8: 19F2D8-> 19F2D8                         |
47A6A | 00A09856 | 83C4 04                  | add esp,4                               | esp: 19F2B8-> 19F2BC eflags: 212-> 202            |                                                   |
47A6B | 00A09859 | FF3424                   | push dword ptr ss:[esp]                 | esp: 19F2BC-> 19F2B8                              | 0019F2BC: 8F4C1F-> 8F4C1F 0019F2B8: 8F4C1F-> 8F4C |
47A6C | 00A0985C | C74424 04 C20400B6       | mov dword ptr ss:[esp+4],B60004C2       |                                                   | 0019F2BC: 8F4C1F-> B60004C2                       | [esp+04]:DeleteDC+5A5D
47A6D | 00A09864 | EB FA                    | jmp pirates!.A09860                     |                                                   |                                                   |
47A6E | 00A09860 | C2 0400                  | ret 4                                   | esp: 19F2B8-> 19F2C0                              | 0019F2B8: 8F4C1F-> 8F4C1F                         |
Is this where we should be jumping when correct? NOPE!!!
47A6F | 008F4C1F | C70424 51010000          | mov dword ptr ss:[esp],151              |                                                   | 0019F2C0: B2BBF8-> 151                            |
47A70 | 008F4C26 | 813424 55010000          | xor dword ptr ss:[esp],155              |                                                   | 0019F2C0: 151-> 4                                 |
47A71 | 008F4C2D | 032424                   | add esp,dword ptr ss:[esp]              | esp: 19F2C0-> 19F2C4                              | 0019F2C0: 4-> 4                                   |
47A72 | 008F4C30 | 83EC 04                  | sub esp,4                               | esp: 19F2C4-> 19F2C0 eflags: 202-> 206            |                                                   |
47A73 | 008F4C33 | 890C24                   | mov dword ptr ss:[esp],ecx              |                                                   | 0019F2C0: 4-> B2BBF8                              |
47A74 | 008F4C36 | 8B4D 08                  | mov ecx,dword ptr ss:[ebp+8]            | ecx: B2BBF8-> 5                                   | 0019F2E0: 5-> 5                                   |
47A75 | 008F4C39 | 83E9 02                  | sub ecx,2                               | ecx: 5-> 3                                        |                                                   | ecx:L"if"
47A76 | 008F4C3C | 59                       | pop ecx                                 | ecx: 3-> B2BBF8 esp: 19F2C0-> 19F2C4              | 0019F2C0: B2BBF8-> B2BBF8                         | ecx:L"if"

?????
00A094CD                                  | 7D 12                                 | jge pirates!.A094E1                              |  is taken when bad - oh and it loops
00A094CF                                  | 810424 B3A49600                       | add dword ptr ss:[esp],pirates!.96A4B3           |
00A094D6                                  | 810424 C3C10900                       | add dword ptr ss:[esp],9C1C3                     |
00A094DD                                  | EB FA                                 | jmp pirates!.A094D9                              |
00A094DF                                  | B7 8A                                 | mov bh,8A                                        |
00A094E1                                  | 810424 E3C89600                       | add dword ptr ss:[esp],pirates!.96C8E3           |
00A094E8                                  | 810424 C39D0900                       | add dword ptr ss:[esp],99DC3                     |
00A094EF                                  | EB FA                                 | jmp pirates!.A094EB                              |
00A094F1                                  | EB 57                                 | jmp pirates!.A0954A                              |
00A094F3                                  | 8B45 FC                               | mov eax,dword ptr ss:[ebp-4]                     |


?
008F4C23                                  | 0100                                  | add dword ptr ds:[eax],eax                       |
008F4C25                                  | 0081 34245501                         | add byte ptr ds:[ecx+1552434],al                 |
008F4C2B                                  | 0000                                  | add byte ptr ds:[eax],al                         |
008F4C2D                                  | 032424                                | add esp,dword ptr ss:[esp]                       |
008F4C30                                  | 83EC 04                               | sub esp,4                                        |
008F4C33                                  | 890C24                                | mov dword ptr ss:[esp],ecx                       |
008F4C36                                  | 8B4D 08                               | mov ecx,dword ptr ss:[ebp+8]                     |
008F4C39                                  | 83E9 02                               | sub ecx,2                                        |
008F4C3C                                  | 59                                    | pop ecx                                          |
008F4C3D                                  | 68 B80E0000                           | push EB8                                         |
008F4C42                                  | 74 10                                 | je pirates!.8F4C54         wasn't taken when bad                      |

?
008F4CAF                                  | 8B6C24 0C                             | mov ebp,dword ptr ss:[esp+C]                     |
008F4CB3                                  | 896424 0C                             | mov dword ptr ss:[esp+C],esp                     |
008F4CB7                                  | 834424 0C 1C                          | add dword ptr ss:[esp+C],1C                      |
008F4CBC                                  | 2BC2                                  | sub eax,edx                                      |
008F4CBE                                  | 8B5424 10                             | mov edx,dword ptr ss:[esp+10]                    |
008F4CC2                                  | 8B6424 0C                             | mov esp,dword ptr ss:[esp+C]                     |
008F4CC6                                  | 58                                    | pop eax                                          |
008F4CC7                                  | 68 A90F0000                           | push FA9                                         |
008F4CCC                                  | 75 10                                 | jne pirates!.8F4CDE                              |

00A09606                                  | 896424 10                             | mov dword ptr ss:[esp+10],esp                    |
00A0960A                                  | 834424 10 20                          | add dword ptr ss:[esp+10],20                     |
00A0960F                                  | 2BEF                                  | sub ebp,edi                                      |
00A09611                                  | 8B7C24 14                             | mov edi,dword ptr ss:[esp+14]                    |
00A09615                                  | 8B6424 10                             | mov esp,dword ptr ss:[esp+10]                    |
00A09619                                  | 5D                                    | pop ebp                                          |
00A0961A                                  | 68 1B300000                           | push 301B                                        |
00A0961F                                  | 7C 10                                 | jl pirates!.A09631                               |   ???  not taken when bad - loops
00A09621                                  | 810424 643E9A00                       | add dword ptr ss:[esp],pirates!.9A3E64           |
00A09628                                  | 810424 C3270600                       | add dword ptr ss:[esp],627C3                     |
00A0962F                                  | EB FA                                 | jmp pirates!.A0962B                              |
00A09631                                  | 810424 99B89600                       | add dword ptr ss:[esp],pirates!.96B899           |
00A09638                                  | 810424 C3AE0900                       | add dword ptr ss:[esp],9AEC3                     |


Address=00A1EB94 Module/Label/Exception=pirates!.exe State=Enabled Disassembly=fstp qword ptr ds:[C253B8] Hits=0 Summary=execute()
Address=00A1F908 Module/Label/Exception=pirates!.exe State=Enabled Disassembly=fstp qword ptr ds:[C253B8] Hits=0 Summary=execute()
Address=00AAAA00 Module/Label/Exception=pirates!.exe State=Enabled Disassembly=jne pirates!.AAAA14 Hits=1 Summary=execute()


0002D | 009FFE90 | 73 12                    | jae pirates!.9FFEA4                     |                                                   |                                                   |

From the TRACE this the difference:
00C86,00B20A55,74 3B,je pirates!.B20A92,,, taken when bad - not taken when good

Bad ?
00DDD,00B1DFE0,C9,leave ,esp: 19EA78-> 19EA9C ebp: 19EA98-> 19F2E4,0019EA98: 19F2E4-> 19F2E4,
00DDE,00B1DFE1,C3,ret ,esp: 19EA9C-> 19EAA0,0019EA9C: AC7293-> AC7293,
00DDF,00AC7293,C70424 89020000,"mov dword ptr ss:[esp],289",,0019EAA0: 19F2C4-> 289,
00DE0,00AC729A,813424 85020000,"xor dword ptr ss:[esp],285",eflags: 246-> 206,0019EAA0: 289-> C,
00DE1,00AC72A1,032424,"add esp,dword ptr ss:[esp]",esp: 19EAA0-> 19EAAC,0019EAA0: C-> C,
00DE2,00AC72A4,8D4D E0,"lea ecx,dword ptr ss:[ebp-20]",ecx: 19EA78-> 19F2C4,,
00DE3,00AC72A7,83EC 04,"sub esp,4",esp: 19EAAC-> 19EAA8 eflags: 206-> 202,,
00DE4,00AC72AA,890C24,"mov dword ptr ss:[esp],ecx",,0019EAA8: F64-> 19F2C4,
00DE5,00AC72AD,6A 00,push 0,esp: 19EAA8-> 19EAA4,0019EAA4: 19F2C4-> 0,
00DE6,00AC72AF,68 03001F00,push 1F0003,esp: 19EAA4-> 19EAA0,0019EAA0: 0-> 1F0003,"1F0003:""??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????"
00DE7,00AC72B4,FF15 3443C200,call dword ptr ds:[<&OpenEventA>],esp: 19EAA0-> 19EA9C,00C24334: 7591E930-> 7591E930 0019EA9C: 1F0003-> AC72BA,
00DE8,7591E930 <kernel32.OpenEventA>,FF25 F8199875,jmp dword ptr ds:[<OpenEventA>],,759819F8: 76299F70-> 76299F70,OpenEventA
00DE9,76299F70 <kernelbase.OpenEventA>,8BFF,"mov edi,edi",,,OpenEventA
00DEA,76299F72,55,push ebp,esp: 19EA9C-> 19EA98,0019EA98: AC72BA-> 19F2E4,

Good ?
00B1DFC8	8B45 E0	mov eax,dword ptr ss:[ebp-20]
00B1DFCB	8020 00	and byte ptr ds:[eax],0
00B1DFCE	EB 0D	jmp pirates!.B1DFDD
00B1DFDD	8BC6	mov eax,esi
00B1DFDF	5E	pop esi
00B1DFE0	C9	leave 
00B1DFE1	C3	ret 
00AC7293	C70424 89020000	mov dword ptr ss:[esp],289
00AC729A	813424 85020000	xor dword ptr ss:[esp],285
00AC72A1	32424	add esp,dword ptr ss:[esp]
00AC72A4	8D4D E0	lea ecx,dword ptr ss:[ebp-20]
00AC72A7	83EC 04	sub esp,4
00AC72AA	890C24	mov dword ptr ss:[esp],ecx
00AC72AD	6A 00	push 0
00AC72AF	68 03001F00	push 1F0003
00AC72B4	FF15 3443C200	call dword ptr ds:[<&OpenEventA>]
7591E930 <kernel32.OpenEventA>	FF25 F8199875	jmp dword ptr ds:[<OpenEventA>]
76299F70 <kernelbase.OpenEventA>	8BFF	mov edi,edi
76299F72	55	push ebp
76299F73	8BEC	mov ebp,esp
76299F75	51	push ecx
76299F76	51	push ecx
76299F77	56	push esi
76299F78	8B75 10	mov esi,dword ptr ss:[ebp+10]
76299F7B	85F6	test esi,esi
76299F7D	74 3A	je kernelbase.76299FB9
76299F7F	8BD6	mov edx,esi


234DA,00A527FE,74 10,je pirates!.A52810,,,  good jmps? changing it to not jmp does break it


00A527F8                                  | 58                                    | pop eax                                          |
00A527F9                                  | 68 5E360000                           | push 365E                                        |
00A527FE                                  | 74 10                                 | je pirates!.A52810                               |
00A52800                                  | 810424 4FF8A200                       | add dword ptr ss:[esp],pirates!.A2F84F           | [esp]:WriteFile+5C
00A52807                                  | 810424 C3F90100                       | add dword ptr ss:[esp],1F9C3                     | 1F9C3:"???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
00A5280E                                  | EB FA                                 | jmp pirates!.A5280A                              |
00A52810                                  | 83EC 18                               | sub esp,18                                       |
00A52813                                  | C74424 14 C0AFBA7E                    | mov dword ptr ss:[esp+14],7EBAAFC0               |
00A5281B                                  | C74424 10 5C000200                    | mov dword ptr ss:[esp+10],2005C                  | 2005C:"???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????!\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????"
00A52823                                  | 897C24 0C                             | mov dword ptr ss:[esp+C],edi                     | edi:DeleteProcThreadAttributeList
00A52827                                  | BF E027A500                           | mov edi,pirates!.A527E0                          |
00A5282C                                  | 896C24 08                             | mov dword ptr ss:[esp+8],ebp                     |
00A52830                                  | 897C24 14                             | mov dword ptr ss:[esp+14],edi                    |
00A52834                                  | 33FF                                  | xor edi,edi                                      |
00A52836                                  | 8B6C24 14                             | mov ebp,dword ptr ss:[esp+14]                    | [esp+14]:"CONOUT$"
00A5283A                                  | 8B6D 00                               | mov ebp,dword ptr ss:[ebp]                       |
00A5283D                                  | 33FD                                  | xor edi,ebp                                      |
00A5283F                                  | 834424 14 04                          | add dword ptr ss:[esp+14],4                      |
00A52844                                  | BF D7027B1B                           | mov edi,1B7B02D7                                 |
00A52849                                  | 90                                    | nop                                              |
00A5284A                                  | 90                                    | nop                                              |
00A5284B                                  | 81FF D7020000                         | cmp edi,2D7                                      |
00A52851                                  | 74 01                                 | je pirates!.A52854                               |
00A52853                                  | CC                                    | int3                                             |
00A52854                                  | 8B6C24 08                             | mov ebp,dword ptr ss:[esp+8]                     |
00A52858                                  | 8B7C24 0C                             | mov edi,dword ptr ss:[esp+C]                     | edi:DeleteProcThreadAttributeList
00A5285C                                  | 83C4 18                               | add esp,18                                       |
00A5285F                                  | 810424 DE44A400                       | add dword ptr ss:[esp],pirates!.A444DE           | [esp]:WriteFile+5C
00A52866                                  | 810424 C3AE0000                       | add dword ptr ss:[esp],AEC3                      |
00A5286D                                  | EB FA                                 | jmp pirates!.A52869                              |


00A52A98                                  | 8910                                  | mov dword ptr ds:[eax],edx                       |
00A52A9A                                  | 8B0D 44DCC000                         | mov ecx,dword ptr ds:[C0DC44]                    |
00A52AA0                                  | 81C9 00000400                         | or ecx,40000                                     |  01042200
00A52AA6                                  | 890D 44DCC000                         | mov dword ptr ds:[C0DC44],ecx                    |

After forcing the JMP above at 00A527FE you end up here:
00A53831                                  | 810424 3FA99F00                       | add dword ptr ss:[esp],pirates!.9FA93F           |
00A53838                                  | 810424 C38C0500                       | add dword ptr ss:[esp],58CC3                     |
00A5383F                                  | EB FA                                 | jmp pirates!.A5383B                              |
00A53841                                  | FF15 303CC200                         | call dword ptr ds:[<&GGDM32>]                    |
00A53847                                  | 6A 07                                 | push 7                                           |
00A53849                                  | E8 0A000000                           | call pirates!.A53858                             |
00A5384E                                  | 0B61 B4                               | or esp,dword ptr ds:[ecx-4C]                     |

00A54F7C                                  | 7D 10                                 | jge pirates!.A54F8E      on good we dont jmp                        |
00A54F7E                                  | 810424 DEE0A100                       | add dword ptr ss:[esp],pirates!.A1E0DE           |
00A54F85                                  | 810424 C3690300                       | add dword ptr ss:[esp],369C3                     |
00A54F8C                                  | EB FA                                 | jmp pirates!.A54F88                              |
00A54F8E                                  | 810424 1F259B00                       | add dword ptr ss:[esp],pirates!.9B251F           |
00A54F95                                  | 810424 C3260A00                       | add dword ptr ss:[esp],A26C3                     |
00A54F9C                                  | EB FA                                 | jmp pirates!.A54F98                              |

On bad we ended up here:
00A5352D                                  | 66:FF4C24 14                          | dec word ptr ss:[esp+14]                         |
^ Not good 

We do end up at:
009CB16F
and then at:
00B1DB00
then:
00A5583A <-- bad never got here

Here now:
00B1E215                                  | C3                                    | ret                                              |

00A55913                                  | 83EC 04                               | sub esp,4                                        |
00A5592F                                  | E8 08000000                           | call pirates!.A5593C                             |
^ does lots of pushes here in a weird way
00A5593C                                  | 810424 35000000                       | add dword ptr ss:[esp],35                        | [esp]:TpCallbackIndependent+478

00A55969                                  | C70424 CD000000                       | mov dword ptr ss:[esp],CD                        |
00A55B42                                  | 9C                                    | pushfd                                           |

00A55C5E                                  | BA 5601D1E2                           | mov edx,E2D10156                                 |
00A55C63                                  | 73 FC                                 | jae pirates!.A55C61                              |

00A55DBF                                  | C70424 9C010000                       | mov dword ptr ss:[esp],19C                       |

00B1E1EF                                  | 77 22                                 | ja pirates!.B1E213                               |

00A55DFB	810424 7E000000	add dword ptr ss:[esp],7E

00A55E71                                  | C70424 38000000                       | mov dword ptr ss:[esp],38                        | 38:'8'

00A56B0A                                  | 76 12                                 | jbe pirates!.A56B1E                              |

00A56D2A                                  | 83EC 04                               | sub esp,4                                        |

00A56D30                                  | 8B3495 A8BBB200                       | mov esi,dword ptr ds:[edx*4+B2BBA8]              |  041956D9


00A5723C | 15 5C45C200                    | adc eax,pirates!.C2455C                                            |
00A57241 | A1 60F8C100                    | mov eax,dword ptr ds:[C1F860]                                      |    <---- this value comes up a lot - after UpdateWindow - moving 15 into it etc
00A57246 | 8B0A 	                      | mov ecx,dword ptr ds:[edx]                                         |
00A57248 | 83EC 04                  	  | sub esp,4                                                          |
00A5724B | 893C24                  		  | mov dword ptr ss:[esp],edi                                         |
00A5724E | 8BF9              	          | mov edi,ecx                                                        |
00A57250 | 2B3C85 A8BBB200                | sub edi,dword ptr ds:[eax*4+B2BBA8]              |   <--- make cmp al,al ?
00A57257 | 5F                             | pop edi                                          |

00A572BD                                  | 75 11                                 | jne pirates!.A572D0                              |  <--- taken when bad, not when good?

00A572E2

00A57AF8                                  | 030C95 A8BBB200                       | add ecx,dword ptr ds:[edx*4+B2BBA8]              |
00A57AFF                                  | A1 5445C200                           | mov eax,dword ptr ds:[C24554]                    |

Got there after a time limit

CD Check 1
00AAAA00                                  | 75 12                                 | jne pirates!.AAAA14                              |  NOP
CD Check 2
009FFC9B                                  | 8B88 C0070000                         | mov ecx,dword ptr ds:[eax+7C0]                   | 08 00 ? maybe just 00 00
CD Check 3
00A527FE                                  | 74 10                                 | je pirates!.A52810                               |  Force
CD Check 4
00A572BD                                  | 75 11                                 | jne pirates!.A572D0    <=== don't take NOP
Geometry Check:
00A1EB94                                  | DD1D B853C200                         | fstp qword ptr ds:[C253B8]                       | NOP


1:
00AAA9E7                                  | A1 A8BBB200                           | mov eax,dword ptr ds:[B2BBA8]                    |  THEM   00B2BBA8  D9 56 19 04 00 00 00 00 00 00 00 00 00 00 00 00  ÙV..............  
00AAA9F4                                  | 2B05 50DCC100                         | sub eax,dword ptr ds:[C1DC50]                    |  US   00C1DC50  2F 4E 59 46 00 00 00 00 00 00 00 00 00 00 00 00  /NYF............  
00AAA9FA                                  | 58                                    | pop eax                                          |
00AAA9FB                                  | 68 FC030000                           | push 3FC                                         |
00AAAA00                                  | 75 12                                 | jne pirates!.AAAA14                              |

A1 ???????? 2B 05

00AAAA00 - 00AAA9F4 = C
2B05 ???????? 58 68 ???????? 75  <--- 3 of these - but can probably NOP ALL

3:
00A527EE                                  | 890424                                | mov dword ptr ss:[esp],eax                       |
00A527F1                                  | A1 54DCC100                           | mov eax,dword ptr ds:[C1DC54]                    |
00A527F6                                  | 2BC1                                  | sub eax,ecx                                      |
00A527F8                                  | 58                                    | pop eax                                          |
00A527F9                                  | 68 5E360000                           | push 365E                                        |
00A527FE                                  | 74 10                                 | je pirates!.A52810                               |
00A52800                                  | 810424 4FF8A200                       | add dword ptr ss:[esp],pirates!.A2F84F           |
A1 ???????? 2BC1 58 68 ???????? 74
^ 1 instance of it
00A527FE - 00A527F1 = D

4:
00A57250                                  | 2B3C85 A8BBB200                       | sub edi,dword ptr ds:[eax*4+B2BBA8]              |
2B3C85 ???????? 5F <--- only two - and it's edi -> this then leads onto the jne check - so make cmp al,al

Geometry:
00A1EB91                                  | 032424                                | add esp,dword ptr ss:[esp]                       |
00A1EB94                                  | DD1D B853C200                         | fstp qword ptr ds:[C253B8]                       |
00A1EB9A                                  | E9 1E000000                           | jmp pirates!.A1EBBD                              |
00A1EB94 - 00A1EB91 = 3

Crashing here:
009552D2                                  | 8B06                                  | mov eax,dword ptr ds:[esi]                       |

CRC ?
00B1DB33                                  | F3:A5                                 | rep movsd                                        |

Checksum?
0094DDCE                                  | CC                                    | int3                                             |
0094DDCF                                  | 8B5424 14                             | mov edx,dword ptr ss:[esp+14]                    |
0094DDD3                                  | 8B5C24 10                             | mov ebx,dword ptr ss:[esp+10]                    |
0094DDD7                                  | 83C4 20                               | add esp,20                                       |
0094DDDA                                  | 8B15 603DC200                         | mov edx,dword ptr ds:[C23D60]                    |
0094DDE0                                  | 8B02                                  | mov eax,dword ptr ds:[edx]                       |
0094DDE2                                  | 8B4D BC                               | mov ecx,dword ptr ss:[ebp-44]                    |
0094DDE5                                  | 8B15 5C3DC200                         | mov edx,dword ptr ds:[C23D5C]                    |
0094DDEB                                  | 03048A                                | add eax,dword ptr ds:[edx+ecx*4]                 |
0094DDEE                                  | 8B0D 603DC200                         | mov ecx,dword ptr ds:[C23D60]                    |
0094DDF4                                  | 8901                                  | mov dword ptr ds:[ecx],eax                       |
0094DDF6                                  | 83EC 04                               | sub esp,4                                        |
0094DDF9                                  | C70424 B0889200                       | mov dword ptr ss:[esp],pirates!.9288B0           |
0094DE00                                  | 810424 C3530200                       | add dword ptr ss:[esp],253C3                     |
0094DE07                                  | EB FA                                 | jmp pirates!.94DE03                              |
0094DE09                                  | 42                                    | inc edx                                          |
0094DE0A                                  | 24 8B                                 | and al,8B                                        |


When reversing patches this then fails:
00AE8A6C                                  | C74424 20 A9B81527                    | mov dword ptr ss:[esp+20],2715B8A9               |
00AE8A74                                  | C74424 1C B0070000                    | mov dword ptr ss:[esp+1C],7B0                    |
00AE8A7C                                  | 895C24 18                             | mov dword ptr ss:[esp+18],ebx                    |
00AE8A80                                  | BB 388AAE00                           | mov ebx,pirates!.AE8A38                          |
00AE8A85                                  | C14C24 20 00                          | ror dword ptr ss:[esp+20],0                      |
00AE8A8A                                  | 894C24 14                             | mov dword ptr ss:[esp+14],ecx                    |
00AE8A8E                                  | 8B0B                                  | mov ecx,dword ptr ds:[ebx]                       |
00AE8A90                                  | 014C24 20                             | add dword ptr ss:[esp+20],ecx                    |
00AE8A94                                  | 83C3 04                               | add ebx,4                                        |
00AE8A97                                  | 66:FF4C24 1C                          | dec word ptr ss:[esp+1C]                         |
00AE8A9C                                  | 75 F0                                 | jne pirates!.AE8A8E                              |
00AE8A9E                                  | 804C24 20 01                          | or byte ptr ss:[esp+20],1                        |
00AE8AA3                                  | 8B5C24 20                             | mov ebx,dword ptr ss:[esp+20]                    |
00AE8AA7                                  | 81FB 69170000                         | cmp ebx,1769                                     |
00AE8AAD                                  | 74 01                                 | je pirates!.AE8AB0                               |
00AE8AAF                                  | CC                                    | int3                                             |
00AE8AB0                                  | 8B5C24 24                             | mov ebx,dword ptr ss:[esp+24]                    |

------------------------------------------------------
Manhunt - 5.03.03

Could this be the optional it can't find ???
008B1D66                                  | 81E9 96000000                         | sub ecx,96                                       |
008B1D6C                                  | 390D 6C77A000                         | cmp dword ptr ds:[A0776C],ecx                    |
008B1D72                                  | 74 1F                                 | je manhunt.8B1D93                                |

Yep that's the one I need - it ain't that optional - but hard to find

-------------------------------------------------------
Grand Theft Auto - Vice City - 4.84.69

loading up gta-vc.exe by itself doesn't load version.dll - weird. Rename it and it does.

Completely different to Max Payne - not completely - but enough that can't find the key parts - although key parts are the same

cms_t might be the CD section (DeviceIoControl pops out at sfint.dll and then goes to cms_t). It is - and it's the Point of Entry so simple


00A18AC7                                  | 8B0D 6075A400                         | mov ecx,dword ptr ds:[A47560]                    |
00A18ACD                                  | 3B0D 0C2AAC00                         | cmp ecx,dword ptr ds:[AC2A0C]                    | 00AC2A0C:"/NYF"
00A18AD3                                  | 75 09                                 | jne gta-vc - copy.A18ADE                         |

00A2FC90                                  | A1 6075A400                           | mov eax,dword ptr ds:[A47560]                    |
00A2FC95                                  | 3B05 0C2AAC00                         | cmp eax,dword ptr ds:[AC2A0C]                    | 00AC2A0C:"/NYF"
00A2FC9B                                  | 0F85 02010000                         | jne gta-vc - copy.A2FDA3                         |

00A30476                                  | EB CC                                 | jmp gta-vc - copy.A30444                         |
00A30478                                  | A1 6075A400                           | mov eax,dword ptr ds:[A47560]                    |
00A3047D                                  | 3B05 0C2AAC00                         | cmp eax,dword ptr ds:[AC2A0C]                    | 00AC2A0C:"/NYF"
00A30483                                  | 75 75                                 | jne gta-vc - copy.A304FA                         |   <----- gets hit
00A30485                                  | 68 00080000                           | push 800                                         |


Check 1?
00A30478                                  | A1 6075A400                           | mov eax,dword ptr ds:[A47560]                    | eax:TpCallbackIndependent+140
00A3047D                                  | 3B05 0C2AAC00                         | cmp eax,dword ptr ds:[AC2A0C]                    | eax:TpCallbackIndependent+140, 00AC2A0C:"/NYF"
00A30483                                  | 75 75                                 | jne gta-vc - copy.A304FA                         |
00A30485                                  | 68 00080000                           | push 800                                         |
00A3048A                                  | 68 4056AC00                           | push gta-vc - copy.AC5640                        |
00A3048F                                  | 68 C038AC00                           | push gta-vc - copy.AC38C0                        |
00A30494                                  | E8 278C0000                           | call gta-vc - copy.A390C0                        |
00A30499                                  | 83C4 0C                               | add esp,C                                        |
00A3049C                                  | 833D 14BDA600 00                      | cmp dword ptr ds:[A6BD14],0                      |
00A304A3                                  | 74 43                                 | je gta-vc - copy.A304E8                          |
00A304A5                                  | 8B0D 0C2AAC00                         | mov ecx,dword ptr ds:[AC2A0C]                    | 00AC2A0C:"/NYF"
00A304AB                                  | 51                                    | push ecx                                         |
00A304AC                                  | 8B15 0C2AAC00                         | mov edx,dword ptr ds:[AC2A0C]                    | 00AC2A0C:"/NYF"
00A304B2                                  | 52                                    | push edx                                         |
00A304B3                                  | A1 6075A400                           | mov eax,dword ptr ds:[A47560]                    | eax:TpCallbackIndependent+140
00A304B8                                  | 50                                    | push eax                                         | eax:TpCallbackIndependent+140
00A304B9                                  | 8B0D 6075A400                         | mov ecx,dword ptr ds:[A47560]                    |
00A304BF                                  | 51                                    | push ecx                                         |
00A304C0                                  | 8B15 E0D4AB00                         | mov edx,dword ptr ds:[ABD4E0]                    |

A1 ???????? 3B05 ???????? 75 ?? 68
00A30483 - 00A30478 = 


Check 2 - could be found the normal way?

00A2B6C2                                  | 7D 29                                 | jge gta-vc - copy.A2B6ED                         |
00A2B6C4                                  | 8B15 AC41AC00                         | mov edx,dword ptr ds:[AC41AC]                    |
00A2B6CA                                  | A1 FCCFAB00                           | mov eax,dword ptr ds:[ABCFFC]                    | eax:TpCallbackIndependent+140
00A2B6CF                                  | 8B0A                                  | mov ecx,dword ptr ds:[edx]                       |
00A2B6D1                                  | 3B0C85 8075A400                       | cmp ecx,dword ptr ds:[eax*4+A47580]              |
00A2B6D8                                  | 75 02                                 | jne gta-vc - copy.A2B6DC                         |
00A2B6DA                                  | EB 11                                 | jmp gta-vc - copy.A2B6ED                         |

00A2B982                                  | A1 FCCFAB00                           | mov eax,dword ptr ds:[ABCFFC]                    | eax:TpCallbackIndependent+140
00A2B987                                  | 8B0A                                  | mov ecx,dword ptr ds:[edx]                       |
00A2B989                                  | 3B0C85 6075A400                       | cmp ecx,dword ptr ds:[eax*4+A47560]              |
00A2B990                                  | 75 02                                 | jne gta-vc - copy.A2B994                         |

Can't find the optional 

Geometry ?
00A28A31                                  | 68 802FAC00                           | push gta-vc - copy.AC2F80                        |
00A28A36                                  | E8 05A3FFFF                           | call gta-vc - copy.A22D40                        |
00A28A3B                                  | DD1D A8D6AB00                         | fstp qword ptr ds:[ABD6A8]                       | <----- is hit yep - that's it - nop it and you're good
00A28A41                                  | E8 8A80FFFF                           | call gta-vc - copy.A20AD0                        | 
00A28A46                                  | DC1D A8D6AB00                         | fcomp qword ptr ds:[ABD6A8]                      |
00A28A4C                                  | DFE0                                  | fnstsw ax                                        |


00A28B3B                                  | 68 802FAC00                           | push gta-vc - copy.AC2F80                        |   
00A28B40                                  | E8 FBA1FFFF                           | call gta-vc - copy.A22D40                        |
00A28B45                                  | DD1D A8D6AB00                         | fstp qword ptr ds:[ABD6A8]                       |
00A28B4B                                  | 833D 80C6AB00 00                      | cmp dword ptr ds:[ABC680],0                      |
00A28B52                                  | 74 14                                 | je gta-vc - copy.A28B68                          |
00A28B54                                  | 68 00010000                           | push 100                                         |

------------------------------------------------------------------
Grand Theft Auto - Vice City v1.1 - 4.84.75

CD Check 1 - maybe not ?!!?
00A86D84              | A1 A85AAA00                           | mov eax,dword ptr ds:[AA5AA8]                    |
00A86D89              | 3B05 8C68B200                         | cmp eax,dword ptr ds:[B2688C]                    |
00A86D8F              | 75 51                                 | jne gta-vc - orig 1.1.A86DE2                     |
00A86D91              | 68 C094B200                           | push gta-vc - orig 1.1.B294C0                    |
00A86D96              | E8 058DFFFF                           | call <gta-vc - orig 1.1.sub_A7FAA0>              |
00A86D9B              | 85C0                                  | test eax,eax                                     |
00A86D9D              | 74 43                                 | je gta-vc - orig 1.1.A86DE2                      |
00A86D9F              | 68 00080000                           | push 800                                         |
00A86DA4              | 68 C094B200                           | push gta-vc - orig 1.1.B294C0                    |
00A86DA9              | 68 4077B200                           | push gta-vc - orig 1.1.B27740                    |
00A86DAE              | E8 6D2D0100                           | call <gta-vc - orig 1.1.sub_A99B20>              |

74 ?? 68 00080000

A1????????3B05????????75??68

Maybe it's this one then ???
00A88F76              | 8915 8C68B200                         | mov dword ptr ds:[B2688C],edx                    | 00B2688C:"&FYF", edx:struct CDAPFN_PROPERTIES CDAPFN0506_CDAPFN0506_X_WaterLevelInitialise+48DB74
00A88F7C              | EB CC                                 | jmp gta-vc - orig 1.1.A88F4A                     |
00A88F7E              | A1 A85AAA00                           | mov eax,dword ptr ds:[AA5AA8]                    |
00A88F83              | 3B05 8C68B200                         | cmp eax,dword ptr ds:[B2688C]                    | 00B2688C:"&FYF"
00A88F89              | 0F85 83000000                         | jne gta-vc - orig 1.1.A89012                     |
00A88F8F              | 68 C094B200                           | push gta-vc - orig 1.1.B294C0                    |
00A88F94              | E8 076BFFFF                           | call <gta-vc - orig 1.1.sub_A7FAA0>              |
00A88F99              | 85C0                                  | test eax,eax                                     |
00A88F9B              | 74 75                                 | je gta-vc - orig 1.1.A89012                      |
00A88F9D              | 68 00080000                           | push 800                                         |
00A88FA2              | 68 C094B200                           | push gta-vc - orig 1.1.B294C0                    |
00A88FA7              | 68 4077B200                           | push gta-vc - orig 1.1.B27740                    |

A1????????3B05????????0F85????????68

00A811C8                             | E8 33D70000                      | call <gta-vc - orig 1.1.sub_A8E900>                           |
00A811CD                             | DD1D 2815B200                    | fstp qword ptr ds:[B21528]                                    |
00A811D3                             | E8 98B40000                      | call <gta-vc - orig 1.1.sub_A8C670>                           |
00A811D8                             | DC1D 2815B200                    | fcomp qword ptr ds:[B21528]                                   |

------------------------------------------------------------------------
GTA IV - 7???

??
00E990D4              | 83E0 1F                               | and eax,1F                                       |
00E990D7              | 83EC 04                               | sub esp,4                                        |
00E990DA              | 890424                                | mov dword ptr ss:[esp],eax                       |
00E990DD              | 8BC0                                  | mov eax,eax                                      |
00E990DF              | 83E8 1F                               | sub eax,1F                                       |
00E990E2              | 58                                    | pop eax                                          |
00E990E3              | 68 3D240000                           | push 243D                                        |
00E990E8              | 75 12                                 | jne gta_sa.E990FC                                |

00E9A0FF              | 83E0 1F                               | and eax,1F                                       |
00E9A102              | 83EC 04                               | sub esp,4                                        |
00E9A105              | 891424                                | mov dword ptr ss:[esp],edx                       |
00E9A108              | 8BD0                                  | mov edx,eax                                      |
00E9A10A              | 83EA 1F                               | sub edx,1F                                       |
00E9A10D              | 5A                                    | pop edx                                          |
00E9A10E              | 68 DE280000                           | push 28DE                                        |
00E9A113              | 75 10                                 | jne gta_sa.E9A125                                |

Does at least hit this one?
00E9A0FA              | E8 C1903A00                           | call gta_sa.12431C0                              |
00E9A0FF              | 83E0 1F                               | and eax,1F                                       |
00E9A102              | 83EC 04                               | sub esp,4                                        |
00E9A105              | 891424                                | mov dword ptr ss:[esp],edx                       |
00E9A108              | 8BD0                                  | mov edx,eax                                      |
00E9A10A              | 83EA 1F                               | sub edx,1F                                       |
00E9A10D              | 5A                                    | pop edx                                          |
00E9A10E              | 68 DE280000                           | push 28DE                                        |
00E9A113              | 75 10                                 | jne gta_sa.E9A125                                |
00E9A115              | 810424 36A7DB00                       | add dword ptr ss:[esp],gta_sa.DBA736             |

^ yep that's the one

E8 ???????? 83E0 1F


-----------------------------------------------------------
Football Manager 2008 - 07.34.0013

02B4FC47              | 8D6424 FC                             | lea esp,dword ptr ss:[esp-4]                     |
02B4FC4B              | 890424                                | mov dword ptr ss:[esp],eax                       |
02B4FC4E              | 8BC8                                  | mov ecx,eax                                      |
02B4FC50              | E8 FA8EBBFF                           | call fm - copy - edited.2708B4F                  |
02B4FC55              | B0 1F                                 | mov al,1F                                        |
02B4FC57              | 90                                    | nop                                              |
02B4FC58              | 3C 1F                                 | cmp al,1F                                        |
02B4FC5A              | 9C                                    | pushfd                                           |
02B4FC5B              | 9C                                    | pushfd                                           |
02B4FC5C              | 83EC 14                               | sub esp,14                                       |
02B4FC5F              | C74424 10 0F110000                    | mov dword ptr ss:[esp+10],110F                   |

^ that is being hit and should be working

In ARS - 
02B3F7E2              | 33DB                                  | xor ebx,ebx                                      |
02B3F7E4              | 83C3 01                               | add ebx,1                                        |
02B3F7E7              | 8498 C0070000                         | test byte ptr ds:[eax+7C0],bl                    |
02B3F7ED              | 895D FC                               | mov dword ptr ss:[ebp-4],ebx                     |
02B3F7F0              | B9 7767F9FF                           | mov ecx,FFF96777                                 | ecx:ZwAssociateWaitCompletionPacket+C

02B3F7E7              | 38C0                                  | cmp al,al                                        |
02B3F7E9              | 90                                    | nop                                              |
02B3F7EA              | 90                                    | nop                                              |
02B3F7EB              | 90                                    | nop                                              |
02B3F7EC              | 90                                    | nop                                              |


--------------------------------------------------------------
Diablo 2 - 3.17.00 - not sure I can be bothered :) - oh but I can but I must

SEH:
0040C0C0                             | 55                               | push ebp                                                      |
...
0040C488                             | 8A15 C85E4300                    | mov dl,byte ptr ds:[435EC8]                                   |
0040C48E                             | 80C2 01                          | add dl,1                                                      |
0040C491                             | 8815 C85E4300                    | mov byte ptr ds:[435EC8],dl                                   |
0040C497                             | A1 CC5E4300                      | mov eax,dword ptr ds:[435ECC]                                 |
0040C49C                             | 83C0 01                          | add eax,1                                                     |
0040C49F                             | A3 CC5E4300                      | mov dword ptr ds:[435ECC],eax                                 |
^ the special values debug values

0040FC40 <game.sub_40FC40>           | 55                               | push ebp                                                      |

00410307                             | 8A0D C85E4300                    | mov cl,byte ptr ds:[435EC8]              <---- 8                     |
0041030D                             | 8BC1                             | mov eax,ecx                                                   |
0041030F                             | 83E8 08                          | sub eax,8                                                     |
00410312                             | 99                               | cdq                                                           |
00410313                             | B9 1C000000                      | mov ecx,1C                                                    |
00410318                             | F7F9                             | idiv ecx                                                      |
.......
00410332                             | 8A0D C85E4300                    | mov cl,byte ptr ds:[435EC8]              <----- 8                     |
00410338                             | 83C1 0B                          | add ecx,B                                                     |
0041033B                             | 8B55 E4                          | mov edx,dword ptr ss:[ebp-1C]                                 | [ebp-1C]:TpWorkOnBehalfSetTicket+1EF
0041033E                             | 6BD2 1C                          | imul edx,edx,1C                                               |
00410341                             | 2BCA                             | sub ecx,edx                                                   |
00410343                             | 8B55 D4                          | mov edx,dword ptr ss:[ebp-2C]                                 |
00410346                             | 0394C8 E06D4300                  | add edx,dword ptr ds:[eax+ecx*8+436DE0]                       |
0041034D                             | 8955 D4                          | mov dword ptr ss:[ebp-2C],edx                                 |


0040C482                             | 890D 84E94100                    | mov dword ptr ds:[41E984],ecx                                 |
0040C488                             | 8A15 C85E4300                    | mov dl,byte ptr ds:[435EC8]                                   |
0040C48E                             | 80C2 01                          | add dl,1                              0040C48E  B2 08 90      | mov dl,8 nop
0040C491                             | 8815 C85E4300                    | mov byte ptr ds:[435EC8],dl                                   |
0040C497                             | A1 CC5E4300                      | mov eax,dword ptr ds:[435ECC]                                 |
0040C49C                             | 83C0 01                          | add eax,1                                                     |
0040C49F                             | A3 CC5E4300                      | mov dword ptr ds:[435ECC],eax                                 |
0040C4A4                             | 8A0D D05E4300                    | mov cl,byte ptr ds:[435ED0]                                   |
0040C4AA                             | 024D FC                          | add cl,byte ptr ss:[ebp-4]                                    |
0040C4AD                             | 880D D05E4300                    | mov byte ptr ds:[435ED0],cl                                   |

in 4.0
00415417                             | 8A0D F4F24400                    | mov cl,byte ptr ds:[44F2F4]                                   |
0041541D                             | 80C1 01                          | add cl,1                                  |  0041541D                             | B1 08 90                           | mov cl,8                                                      |
00415420                             | 880D F4F24400                    | mov byte ptr ds:[44F2F4],cl                                   |

8A15 ???????? 83c201

8A?? ???????? 80 ?? 01 88 <--- that finds it
0041541D - 00415417 = 6 + 1

Can't just make it 8 though - as it wants to be 30 before the WriteProcessMemory

trace: 0x{p:cip} {i:cip}

CD Check 1
Searched for:
EB CC 8B0D -> got one hit - looks like 
004154D3                             | EB CC                            | jmp game.4154A1                                               |
004154D5                             | 8B0D 90E94100                    | mov ecx,dword ptr ds:[41E990]                                 |
004154DB                             | 3B0D DC844300                    | cmp ecx,dword ptr ds:[4384DC]                                 |
004154E1                             | 75 11                            | jne game.4154F4                                               |
004154E3                             | 8B15 D45E4300                    | mov edx,dword ptr ds:[435ED4]                                 |
004154E9                             | 80CE 20                          | or dh,20                                                      |

CD Check 2:
Searched for A3 ???????? 833D ???????? 00 74
Gave me 4 hits
Address=0040DE4C Disassembly=mov dword ptr ds:[4383E0],eax 
Address=0040DEFD Disassembly=mov dword ptr ds:[438640],eax
Address=0040E3BB Disassembly=mov dword ptr ds:[438640],eax 
Address=00412E9F Disassembly=mov dword ptr ds:[<&ATI32>],eax
None of them hit???

00415722                             | 74 52                            | je game.415776                                                |  <--- is not taken when good
00415724                             | 8B0D 20634300                    | mov ecx,dword ptr ds:[436320]                                 |
0041572A                             | 3B0D 2C634300                    | cmp ecx,dword ptr ds:[43632C]                                 |
00415730                             | 74 44                            | je game.415776                                                |  <--- is taken when good and bad
??????

004157B3                             | 890D D45E4300                    | mov dword ptr ds:[435ED4],ecx                                 |
004157B9                             | 8B15 D45E4300                    | mov edx,dword ptr ds:[435ED4]                                 |
004157BF                             | 81E2 00000400                    | and edx,40000                                                 |
004157C5                             | 85D2                             | test edx,edx                                                  |
004157C7                             | 75 14                            | jne game.4157DD                                               | taken when good - not when bad
004157C9                             | FF15 18684300                    | call dword ptr ds:[<&C32>]                                    |
004157CF                             | 6A 07                            | push 7                                                        |
004157D1                             | E8 5A6DFFFF                      | call <game.sub_40C530>                                        |


CD Check 3:
Searched for 81EA ???????? 3915 ???????? 75 - hit two:

0040D552                             | 8B95 54FEFFFF                    | mov edx,dword ptr ss:[ebp-1AC]                                |
0040D558                             | 81EA 96000000                    | sub edx,96                                                    |
0040D55E                             | 3915 E0814300                    | cmp dword ptr ds:[4381E0],edx                                 |
0040D564                             | 75 0D                            | jne game.40D573           <--- continually hit too and taken!!                                      |
0040D566                             | A1 045E4300                      | mov eax,dword ptr ds:[435E04]                                 |
0040D56B                             | 83C0 01                          | add eax,1                                                     |

00415786                             | 8B11                             | mov edx,dword ptr ds:[ecx]                                    |
00415788                             | 81EA 96000000                    | sub edx,96                           <--- hit                         |
0041578E                             | 3915 38634300                    | cmp dword ptr ds:[436338],edx                                 |
00415794                             | 75 11                            | jne game.4157A7                     is not taken when good                          |
00415796                             | A1 D45E4300                      | mov eax,dword ptr ds:[435ED4]                                 |
0041579B                             | 0D 00000400                      | or eax,40000                                                  |
^ Comes first!!! before cd check 2? or maybe no cd check 2

CD Check 4:
3B148D ???????? 75 - one hit:
00415845                             | 83BD C0FBFFFF 08                 | cmp dword ptr ss:[ebp-440],8                                  |
0041584C                             | 7D 29                            | jge game.415877                                               |
0041584E                             | A1 3C874300                      | mov eax,dword ptr ds:[43873C]                                 |
00415853                             | 8B8D C0FBFFFF                    | mov ecx,dword ptr ss:[ebp-440]                                |
00415859                             | 8B10                             | mov edx,dword ptr ds:[eax]                                    |
0041585B                             | 3B148D B0E94100                  | cmp edx,dword ptr ds:[ecx*4+41E9B0]                           |
00415862                             | 75 02                            | jne game.415866                                               |
00415864                             | EB 11                            | jmp game.415877                                               |
00415866                             | 8B85 C0FBFFFF                    | mov eax,dword ptr ss:[ebp-440]                                |
0041586C                             | 83C0 01                          | add eax,1                                                     |
0041586F                             | 8985 C0FBFFFF                    | mov dword ptr ss:[ebp-440],eax                                |
00415875                             | EB CE                            | jmp game.415845                                               |

00415825                             | 75 14                            | jne game.41583B                                               |  <---- not taken when bad

CD Check 5??:
004159F6                             | 8B01                             | mov eax,dword ptr ds:[ecx]                                    | ecx:"/NYF"
004159F8                             | 3B0495 90E94100                  | cmp eax,dword ptr ds:[edx*4+41E990]                           |  0041E990  C4 6D 3B 7B 00 00 00 00 00 00 00 00 00 00 00 00  Äm;{............  
004159FF                             | 75 02                            | jne game.415A03             not taken                                  |

3B???? ???????? 75 02

CD Checks:
004154E1                             | 75 11                            | jne game.4154F4                                               |
00415794                             | 75 11                            | jne game.4157A7                     is not taken when good                          |
004159FF                             | 75 02                            | jne game.415A03             not taken                                  |

Remove Debug Check:
00410307                             | 8A0D C85E4300                    | mov cl,byte ptr ds:[435EC8]              <---- 8                     |
00410332                             | 8A0D C85E4300                    | mov cl,byte ptr ds:[435EC8]              <----- 8                     |

/// Mostly it is 8 when we put the cd checks in - but sometimes turns FF 
00410303                             | 7F 4D                            | jg game.410352                                                |
00410305                             | 33C9                             | xor ecx,ecx                                                   |
00410307                             | 8A0D C85E4300                    | mov cl,byte ptr ds:[435EC8]                                   |
0041030D                             | 8BC1                             | mov eax,ecx                                                   |
0041030F                             | 83E8 08                          | sub eax,8                                                     |
00410312                             | 99                               | cdq                                                           |
00410313                             | B9 1C000000                      | mov ecx,1C                                                    |
00410318                             | F7F9                             | idiv ecx                                                      |
0041031A                             | 8B55 FC                          | mov edx,dword ptr ss:[ebp-4]                                  |
0041031D                             | 0314C5 E0844300                  | add edx,dword ptr ds:[eax*8+4384E0]                           |
00410324                             | 8955 FC                          | mov dword ptr ss:[ebp-4],edx                                  |
00410327                             | 8B45 E4                          | mov eax,dword ptr ss:[ebp-1C]                                 |
0041032A                             | 69C0 F8010000                    | imul eax,eax,1F8                                              |
00410330                             | 33C9                             | xor ecx,ecx                                                   |
00410332                             | 8A0D C85E4300                    | mov cl,byte ptr ds:[435EC8]                                   |
00410338                             | 83C1 0B                          | add ecx,B                                                     |
0041033B                             | 8B55 E4                          | mov edx,dword ptr ss:[ebp-1C]                                 |
0041033E                             | 6BD2 1C                          | imul edx,edx,1C                                               |
00410341                             | 2BCA                             | sub ecx,edx                                                   |
00410343                             | 8B55 D4                          | mov edx,dword ptr ss:[ebp-2C]                                 |
00410346                             | 0394C8 E06D4300                  | add edx,dword ptr ds:[eax+ecx*8+436DE0]                       |
0041034D                             | 8955 D4                          | mov dword ptr ss:[ebp-2C],edx                                 |
00410350                             | EB A2                            | jmp game.4102F4                                               |
00410352                             | 837D E0 00                       | cmp dword ptr ss:[ebp-20],0                                   |

Sorting out the fstp geometry check - fixed it:

00410404                             | DD45 A4                          | fld qword ptr ss:[ebp-5C]                                     |
00410407                             | DC0D 40594300                    | fmul qword ptr ds:[435940]                                    |
0041040D                             | DC5D AC                          | fcomp qword ptr ss:[ebp-54]                                   |
00410410                             | DFE0                             | fnstsw ax                                                     |
00410412                             | F6C4 01                          | test ah,1                                                     |
00410415                             | 90                               | nop                                                           |
00410416                             | 90                               | nop                                                           |
00410417                             | 90                               | nop                                                           |
00410418                             | 90                               | nop                                                           |
00410419                             | 90                               | nop                                                           |
0041041A                             | 90                               | nop                                                           |
0041041B                             | DB45 D4                          | fild dword ptr ss:[ebp-2C]                                    |
0041041E                             | DD5D 9C                          | fstp qword ptr ss:[ebp-64]                                    |
00410421                             | DB05 34984300                    | fild dword ptr ds:[439834]                                    |
00410427                             | DD5D 94                          | fstp qword ptr ss:[ebp-6C]                                    |
0041042A                             | DD45 94                          | fld qword ptr ss:[ebp-6C]                                     |
0041042D                             | DC0D 40594300                    | fmul qword ptr ds:[435940]                                    |
00410433                             | DC5D 9C                          | fcomp qword ptr ss:[ebp-64]                                   |
00410436                             | DFE0                             | fnstsw ax                                                     |
00410438                             | F6C4 01                          | test ah,1                                                     |
0041043B                             | E9 76040000                      | jmp game.4108B6                                               |
00410440                             | 90                               | nop                                                           |
00410441                             | 833D A05E4300 00                 | cmp dword ptr ds:[435EA0],0                                   |
00410448                             | 0F84 8F000000                    | je game.4104DD                                                |
0041044E                             | C745 E8 05030000                 | mov dword ptr ss:[ebp-18],305                                 |

DC0D ???????? DC5D?? DFE0 F6C4 01

----------------------

.cms_t
00414F11                    | 6A 03                             | push 3                                           |
00414F13                    | 68 00000080                       | push 80000000                                    |
00414F18                    | 8D8D 88FBFFFF                     | lea ecx,dword ptr ss:[ebp-478]                   |
00414F1E                    | 51                                | push ecx                                         |
00414F1F                    | FF15 54874300                     | call dword ptr ds:[<&CreateFileA>]               |
00414F25                    | A3 845E4300                       | mov dword ptr ds:[435E84],eax                    |
00414F2A                    | 833D 845E4300 FF                  | cmp dword ptr ds:[435E84],FFFFFFFF               |
00414F31                    | 75 05                             | jne game.414F38                                  |
00414F33                    | E9 8FFEFFFF                       | jmp game.414DC7                                  |
00414F38                    | 8B15 845E4300                     | mov edx,dword ptr ds:[435E84]                    |
00414F3E                    | 52                                | push edx                                         |
00414F3F                    | 68 30864300                       | push game.438630                                 |
00414F44                    | A1 40634300                       | mov eax,dword ptr ds:[436340]                    |
00414F49                    | 50                                | push eax                                         |
00414F4A                    | FF15 80974300                     | call dword ptr ds:[<&GDS32>]                     |   <---- first DeviceIoControl pops out here
00414F50                    | 8B0D 30864300                     | mov ecx,dword ptr ds:[438630]                    |
00414F56                    | 81E1 00080000                     | and ecx,800                                      |
00414F5C                    | 85C9                              | test ecx,ecx                                     |
00414F5E                    | 0F85 A8050000                     | jne game.41550C                                  |
00414F64                    | 8B15 845E4300                     | mov edx,dword ptr ds:[435E84]                    |
00414F6A                    | 52                                | push edx                                         |
00414F6B                    | 68 20824300                       | push game.438220                                 |
00414F70                    | A1 40634300                       | mov eax,dword ptr ds:[436340]                    |
00414F75                    | 50                                | push eax                                         |
00414F76                    | FF15 80624300                     | call dword ptr ds:[<&INQ32>]                     |

all fmul I could find:

This calls the below:
0040CD84                    | 0F8D 311A0000                     | jge game.40E7BB                                  |
....
0040E7C1                    | 52                                | push edx                                         |
0040E7C2                    | E8 79140000                       | call game.40FC40                                 |
0040E7C7                    | 85C0                              | test eax,eax                                     |
0040E7C9                    | 74 0E                             | je game.40E7D9                                   |  <--- is taken

0040FF55                    | DB45 D4                           | fild dword ptr ss:[ebp-2C]                       |   <--- gets hit
0040FF58                    | DD5D CC                           | fstp qword ptr ss:[ebp-34]                       |
0040FF5B                    | DB05 34984300                     | fild dword ptr ds:[439834]                       |
0040FF61                    | DD5D C4                           | fstp qword ptr ss:[ebp-3C]                       |
0040FF64                    | DD45 C4                           | fld qword ptr ss:[ebp-3C]                        |
0040FF67                    | DC0D 48594300                     | fmul qword ptr ds:[435948]                       |
0040FF6D                    | DC5D CC                           | fcomp qword ptr ss:[ebp-34]                      |
0040FF70                    | DFE0                              | fnstsw ax                                        |
0040FF72                    | F6C4 01                           | test ah,1                                        |
0040FF75                    | 0F85 24010000                     | jne game.41009F                                  |

00410300 <game.sub_410300>  | 3B45 08                           | cmp eax,dword ptr ss:[ebp+8]                     |

00410388                    | DB45 D4                           | fild dword ptr ss:[ebp-2C]                       |
0041038B                    | DD5D BC                           | fstp qword ptr ss:[ebp-44]                       |
0041038E                    | DB05 34984300                     | fild dword ptr ds:[439834]                       |
00410394                    | DD5D B4                           | fstp qword ptr ss:[ebp-4C]                       |
00410397                    | DD45 B4                           | fld qword ptr ss:[ebp-4C]                        |
0041039A                    | DC0D 40594300                     | fmul qword ptr ds:[435940]                       |
004103A0                    | DC5D BC                           | fcomp qword ptr ss:[ebp-44]                      |
004103A3                    | DFE0                              | fnstsw ax                                        |
004103A5                    | F6C4 01                           | test ah,1                                        |
004103A8                    | 74 02                             | je game.4103AC                                   |
004103AA                    | EB 0F                             | jmp game.4103BB                                  |
004103AC                    | 837D 08 09                        | cmp dword ptr ss:[ebp+8],9                       | 09:'\t'

004103F5                    | DB45 D4                           | fild dword ptr ss:[ebp-2C]                       |
004103F8                    | DD5D AC                           | fstp qword ptr ss:[ebp-54]                       |
004103FB                    | DB05 34984300                     | fild dword ptr ds:[439834]                       |
00410401                    | DD5D A4                           | fstp qword ptr ss:[ebp-5C]                       |
00410404                    | DD45 A4                           | fld qword ptr ss:[ebp-5C]                        |
00410407                    | DC0D 40594300                     | fmul qword ptr ds:[435940]                       |
0041040D                    | DC5D AC                           | fcomp qword ptr ss:[ebp-54]                      |
00410410                    | DFE0                              | fnstsw ax                                        |
00410412                    | F6C4 01                           | test ah,1                                        |
00410415                    | 0F84 BC050000                     | je game.4109D7                                   |

0041041B                    | DB45 D4                           | fild dword ptr ss:[ebp-2C]                       |
0041041E                    | DD5D 9C                           | fstp qword ptr ss:[ebp-64]                       |
00410421                    | DB05 34984300                     | fild dword ptr ds:[439834]                       |
00410427                    | DD5D 94                           | fstp qword ptr ss:[ebp-6C]                       |
0041042A                    | DD45 94                           | fld qword ptr ss:[ebp-6C]                        |
0041042D                    | DC0D 40594300                     | fmul qword ptr ds:[435940]                       |
00410433                    | DC5D 9C                           | fcomp qword ptr ss:[ebp-64]                      |
00410436                    | DFE0                              | fnstsw ax                                        |
00410438                    | F6C4 01                           | test ah,1                                        |
0041043B                    | 0F84 75040000                     | je game.4108B6                                   |

SEH handler:s
0040C0C0                    | 55                                | push ebp                                         |
0040C0C1                    | 8BEC                              | mov ebp,esp                                      |
0040C0C3                    | 83EC 08                           | sub esp,8                                        |
0040C0C6                    | 53                                | push ebx                                         |
0040C0C7                    | 56                                | push esi                                         | esi:EntryPoint
0040C0C8                    | 57                                | push edi                                         | edi:EntryPoint
0040C0C9                    | 8B45 08                           | mov eax,dword ptr ss:[ebp+8]                     |
0040C0CC                    | 8138 940000C0                     | cmp dword ptr ds:[eax],C0000094                  |
0040C0D2                    | 75 38                             | jne game.40C10C                                  |
0040C0D4                    | 8B4D 10                           | mov ecx,dword ptr ss:[ebp+10]                    | [ebp+10]:&"ALLUSERSPROFILE=C:\\ProgramData"
0040C0D7                    | C781 AC000000 06000000            | mov dword ptr ds:[ecx+AC],6                      |
0040C0E1                    | 8B15 64984300                     | mov edx,dword ptr ds:[439864]                    |
0040C0E7                    | 0315 50824300                     | add edx,dword ptr ds:[438250]                    |
0040C0ED                    | 66:0FB602                         | movzx ax,byte ptr ds:[edx]                       |
0040C0F1                    | 8B0D 40864300                     | mov ecx,dword ptr ds:[438640]                    |
0040C0F7                    | 66:8B11                           | mov dx,word ptr ds:[ecx]                         |
0040C0FA                    | 66:03D0                           | add dx,ax                                        |
0040C0FD                    | A1 40864300                       | mov eax,dword ptr ds:[438640]                    |
0040C102                    | 66:8910                           | mov word ptr ds:[eax],dx                         |
0040C105                    | 33C0                              | xor eax,eax                                      |
0040C107                    | E9 DB030000                       | jmp game.40C4E7                                  |
0040C10C                    | 8B4D 08                           | mov ecx,dword ptr ss:[ebp+8]                     |
0040C10F                    | 8139 03000080                     | cmp dword ptr ds:[ecx],80000003                  |
0040C115                    | 75 2F                             | jne game.40C146                                  |
0040C117                    | 8B55 10                           | mov edx,dword ptr ss:[ebp+10]                    | [ebp+10]:&"ALLUSERSPROFILE=C:\\ProgramData"
0040C11A                    | A1 80E94100                       | mov eax,dword ptr ds:[41E980]                    |
0040C11F                    | 3382 B8000000                     | xor eax,dword ptr ds:[edx+B8]                    |
0040C125                    | A3 80E94100                       | mov dword ptr ds:[41E980],eax                    |


--------------------------
IOCTL_STORAGE_MEDIA_REMOVAL ==
nassive jmp from:
0040CD0C                             | 8995 B8FEFFFF                    | mov dword ptr ss:[ebp-148],edx                                |
0040CD12                             | 83BD B8FEFFFF 01                 | cmp dword ptr ss:[ebp-148],1                                  |
0040CD19                             | 0F8D AE1C0000                    | jge game.40E9CD                                               |
0040CD1F                             | C705 34984300 00000000           | mov dword ptr ds:[439834],0                                   |
0040CD29                             | C785 FCFEFFFF 00000000           | mov dword ptr ss:[ebp-104],0                                  |

0040E9B4                             | F7F9                             | idiv ecx                                                      |
0040E9B6                             | 8B1495 40684300                  | mov edx,dword ptr ds:[edx*4+436840]                           |
0040E9BD                             | 8995 5CFEFFFF                    | mov dword ptr ss:[ebp-1A4],edx                                |
0040E9C3                             | E9 8AE3FFFF                      | jmp game.40CD52                                               |
0040E9C8                             | E9 36E3FFFF                      | jmp game.40CD03                                               |
0040E9CD                             | C705 00824300 00000000           | mov dword ptr ds:[438200],0                                   |
0040E9D7                             | 8B45 18                          | mov eax,dword ptr ss:[ebp+18]                                 |
0040E9DA                             | 50                               | push eax                                                      |
0040E9DB                             | 8B0D 00824300                    | mov ecx,dword ptr ds:[438200]                                 |
0040E9E1                             | 51                               | push ecx                                                      |
0040E9E2                             | 8B15 40634300                    | mov edx,dword ptr ds:[436340]                                 |
0040E9E8                             | 52                               | push edx                                                      |
0040E9E9                             | FF15 A0674300                    | call dword ptr ds:[<&LD32>]                                   |  <---- IOCTL_STORAGE_MEDIA_REMOVAL
0040E9EF                             | 6A 09                            | push 9                                                        |
0040E9F1                             | 68 80E94100                      | push game.41E980                                              |
0040E9F6                             | 8B45 10                          | mov eax,dword ptr ss:[ebp+10]                                 |
0040E9F9 <game.&sub_7721E850>        | 50                               | push eax                                                      |
0040E9FA                             | E8 21770000                      | call game.416120                                              |
0040E9FF                             | 83C4 0C                          | add esp,C                                                     |
0040EA02                             | FF15 18684300                    | call dword ptr ds:[<&C32>]                                    |
0040EA08                             | B8 01000000                      | mov eax,1                                                     |
0040EA0D                             | 5F                               | pop edi                                                       |
0040EA0E                             | 5E                               | pop esi                                                       |
0040EA0F                             | 5B                               | pop ebx                                                       |

---------------------------------------
Working out SUB CHANNEL

0040D008                             | 68 E0814300                      | push game.4381E0                                              |
0040D00D                             | 8B0D 40634300                    | mov ecx,dword ptr ds:[436340]                                 |
0040D013                             | 51                               | push ecx                                                      |
0040D014                             | FF15 D4854300                    | call dword ptr ds:[<&LOH32>]                                  |  <--- subchannel call
0040D01A                             | A3 60634300                      | mov dword ptr ds:[436360],eax                                 |
0040D01F                             | 833D 585E4300 00                 | cmp dword ptr ds:[435E58],0                                   |
0040D026                             | 75 0A                            | jne game.40D032                                               |
0040D028                             | 68 E0814300                      | push game.4381E0                                              |

loop counter:
0040CECD                             | 837D FC 14                       | cmp dword ptr ss:[ebp-4],14                                   | [ebp-04]:L"CONOUT$"
0040CED1                             | 0F8D 9B010000                    | jge game.40D072                                               |


Making the first fild fstp of the cd function from jne to jmp seems to help
0040FF4F                             | 0F8F 4A010000                    | jg game.41009F                                                |
0040FF55                             | DB45 D4                          | fild dword ptr ss:[ebp-2C]                                    |
0040FF58                             | DD5D CC                          | fstp qword ptr ss:[ebp-34]                                    |
0040FF5B                             | DB05 34984300                    | fild dword ptr ds:[439834]                                    |
0040FF61                             | DD5D C4                          | fstp qword ptr ss:[ebp-3C]                                    |
0040FF64                             | DD45 C4                          | fld qword ptr ss:[ebp-3C]                                     |
0040FF67                             | DC0D 48594300                    | fmul qword ptr ds:[435948]                                    |
0040FF6D                             | DC5D CC                          | fcomp qword ptr ss:[ebp-34]                                   |
0040FF70                             | DFE0                             | fnstsw ax                                                     |
0040FF72                             | F6C4 01                          | test ah,1                                                     |
0040FF75                             | 0F85 24010000                    | jne game.41009F                                               |   <--- make jmp

------------------------------------------------------------------
Diablo 2 - Lord of Destruction - 4.47.00

.cms_t

A1????????3B05 gives:

00415EBC                             | A1 88F74400                       | mov eax,dword ptr ds:[44F788]                    |
00415EC1                             | 3B05 8CF64400                     | cmp eax,dword ptr ds:[44F68C]                    |
00415EC7                             | 75 0F                             | jne game.415ED8                                  |

0041D151                             | A1 00194500                       | mov eax,dword ptr ds:[451900]                    |
0041D156                             | 3B05 902C4500                     | cmp eax,dword ptr ds:[452C90]                    |
0041D15C                             | 0F8D BD000000                     | jge game.41D21F                                  |

searching for EB CC gave a hit:

CD Check 1:
0041F7AC                             | EB CC                             | jmp game.41F77A                                  |
0041F7AE                             | 8B0D A8994200                     | mov ecx,dword ptr ds:[4299A8]                    | 004299A8:"L8MQ"   004299A8  4C 38 4D 51 00 00 00 00 00 00 00 00 00 00 00 00  L8MQ............  
0041F7B4                             | 3B0D 0C194500                     | cmp ecx,dword ptr ds:[45190C]                    | 0045190C:"/NYF"   0045190C  2F 4E 59 46 00 00 00 00 00 00 00 00 00 00 00 00  /NYF............  
0041F7BA                             | 75 11                             | jne game.41F7CD                but is taken when bad?    exits if changed     not taken when good         |
0041F7BC                             | 8B15 00F34400                     | mov edx,dword ptr ds:[44F300]                    |
0041F7C2                             | 80CE 20                           | or dh,20                                         |
goes to:
0041F80D                             | 85D2                              | test edx,edx                                     |
0041F80F                             | 75 14                             | jne game.41F825                                  | taken when good
0041F811                             | FF15 38FC4400                     | call dword ptr ds:[<&C32>]                       |
0041F817                             | 6A 02                             | push 2                                           |
...
0041F82A                             | 25 00200000                       | and eax,2000                                     |
0041F82F                             | 85C0                              | test eax,eax                                     |
0041F831                             | 75 14                             | jne game.41F847                                  |  taken when good
0041F833                             | FF15 38FC4400                     | call dword ptr ds:[<&C32>]                       |
0041F839                             | 6A 05                             | push 5                                           |

0041F84E                             | 74 38                             | je game.41F888                                   |  not taken when bad

...
0041F9E4                             | C705 F0F14400 00000000            | mov dword ptr ds:[44F1F0],0                      |
0041F9EE                             | 833D CCF24400 00                  | cmp dword ptr ds:[44F2CC],0                      |
0041F9F5                             | 74 24                             | je game.41FA1B                                   | not taken

CD Check 2:
0041FA37                             | A3 F0F14400                       | mov dword ptr ds:[44F1F0],eax                    |
0041FA3C                             | 833D F0F14400 00                  | cmp dword ptr ds:[44F1F0],0                      |
0041FA43                             | 74 70                             | je game.41FAB5                                   |  is taken when good - not taken when bad

Expanded:
0041F9D5                             | 75 0D                            | jne game.41F9E4                                               |
0041F9D7                             | 833D CCF24400 00                 | cmp dword ptr ds:[44F2CC],0                                   |
0041F9DE                             | 0F84 D1000000                    | je game.41FAB5                                                |
0041F9E4                             | C705 F0F14400 00000000           | mov dword ptr ds:[44F1F0],0                                   |
0041F9EE                             | 833D CCF24400 00                 | cmp dword ptr ds:[44F2CC],0                                   |
0041F9F5                             | 74 24                            | je game.41FA1B                                                |
0041F9F7                             | 8B0D B0F24400                    | mov ecx,dword ptr ds:[44F2B0]                                 |
0041F9FD                             | 51                               | push ecx                                                      |
0041F9FE                             | 68 ECF14400                      | push game.44F1EC                                              |
0041FA03                             | 68 E8F14400                      | push game.44F1E8                                              |
0041FA08                             | 8B15 60F74400                    | mov edx,dword ptr ds:[44F760]                                 |
0041FA0E                             | 52                               | push edx                                                      |
0041FA0F                             | E8 3C83FFFF                      | call game.417D50                                              |
0041FA14                             | A3 F0F14400                      | mov dword ptr ds:[44F1F0],eax                                 |
0041FA19                             | EB 21                            | jmp game.41FA3C                                               |
0041FA1B                             | A1 B0F24400                      | mov eax,dword ptr ds:[44F2B0]                                 |
0041FA20                             | 50                               | push eax                                                      |
0041FA21                             | 68 ECF14400                      | push game.44F1EC                                              |
0041FA26                             | 68 E8F14400                      | push game.44F1E8                                              |
0041FA2B                             | 8B0D 60F74400                    | mov ecx,dword ptr ds:[44F760]                                 |
0041FA31                             | 51                               | push ecx                                                      |
0041FA32                             | E8 E980FFFF                      | call game.417B20                                              | 51 E8 ????????A3
0041FA37                             | A3 F0F14400                      | mov dword ptr ds:[44F1F0],eax                                 |
0041FA3C                             | 833D F0F14400 00                 | cmp dword ptr ds:[44F1F0],0                                   |
0041FA43                             | 74 70                            | je game.41FAB5                                                |    <----- FORCE
0041FA45                             | 813D E8F14400 00005F00           | cmp dword ptr ds:[44F1E8],5F0000                              |
0041FA4F                             | 72 18                            | jb game.41FA69                                                |
0041FA51                             | 813D ECF14400 00004A00           | cmp dword ptr ds:[44F1EC],4A0000                              |
0041FA5B                             | 72 0C                            | jb game.41FA69                                                |
0041FA5D                             | C705 F4F14400 01000000           | mov dword ptr ds:[44F1F4],1                                   |
0041FA67                             | EB 0A                            | jmp game.41FA73                                               |
0041FA69                             | C705 F4F14400 00000000           | mov dword ptr ds:[44F1F4],0                                   |
0041FA73                             | 833D F4F14400 00                 | cmp dword ptr ds:[44F1F4],0                                   |
0041FA7A                             | 74 39                            | je game.41FAB5                                                |
0041FA7C                             | 8B15 E8F14400                    | mov edx,dword ptr ds:[44F1E8]                                 |
0041FA82                             | C1EA 10                          | shr edx,10                                                    |
0041FA85                             | A1 94F64400                      | mov eax,dword ptr ds:[44F694]                                 |
0041FA8A                             | 66:8B08                          | mov cx,word ptr ds:[eax]                                      |
0041FA8D                             | 66:33CA                          | xor cx,dx                                                     |
0041FA90                             | 8B15 94F64400                    | mov edx,dword ptr ds:[44F694]                                 |
0041FA96                             | 66:890A                          | mov word ptr ds:[edx],cx                                      |
0041FA99                             | A1 ECF14400                      | mov eax,dword ptr ds:[44F1EC]                                 |

A3 ???????? 833D ???????? 00 74

0041FB0E                             | FF15 54F74400                    | call dword ptr ds:[<&ADI32>]                     |  <--- freeze
0041FB14                             | 8985 9CFBFFFF                    | mov dword ptr ss:[ebp-464],eax                   |
0041FB1A                             | 833D 84F24400 00                 | cmp dword ptr ds:[44F284],0                      |
0041FB21                             | 74 2A                            | je game.41FB4D                                   | is taken

0041FB54                             | 75 5B                            | jne game.41FBB1                                  | not taken


0041FA69                             | C705 F4F14400 00000000            | mov dword ptr ds:[44F1F4],0                      | doesn't get here when good
0041FA73                             | 833D F4F14400 00                  | cmp dword ptr ds:[44F1F4],0                      |
0041FA7A                             | 74 39                             | je game.41FAB5                                   |  is taken when bad

0041FB21                             | 74 2A                             | je game.41FB4D                                   | is taken
..
0041FB54                             | 75 5B                             | jne game.41FBB1                                  | not taken
0041FB56                             | 83BD 9CFBFFFF 00                  | cmp dword ptr ss:[ebp-464],0                     |
0041FB5D                             | 74 52                             | je game.41FBB1                                   | not taken
0041FB5F                             | 8B0D 40F74400                     | mov ecx,dword ptr ds:[44F740]                    | ecx:sub_44F6B5+EB
0041FB65                             | 3B0D 4CF74400                     | cmp ecx,dword ptr ds:[44F74C]                    | ecx:sub_44F6B5+EB
0041FB6B                             | 74 44                             | je game.41FBB1                                   | taken
...
CD Check 3
0041FBC3                             | 81EA 96000000                    | sub edx,96                           |          <----- classic sub edx, 96
0041FBC9                             | 3915 58F74400                    | cmp dword ptr ds:[44F758],edx        |
0041FBCF                             | 75 11                             | jne game.41FBE2                                  | not taken when good  (is taken when bad) -

81EA ???????? 3915 ???????? 75

0041FC59                             | 83BD BCFBFFFF 08                 | cmp dword ptr ss:[ebp-444],8         |  <---- checking for an 8 - checking for 0s? (good has 8)
0041FC60                             | 75 14                            | jne game.41FC76                      |  not taken - fine   can have a break point here and a breakpoint on first geometry without dying

CD Check 4
0041FE4E                             | A1 6C164500                      | mov eax,dword ptr ds:[45166C]        |
0041FE53                             | 8B8D BCFBFFFF                    | mov ecx,dword ptr ss:[ebp-444]       | ecx:ijlErrorStr+DC68
0041FE59                             | 8B10                             | mov edx,dword ptr ds:[eax]           |
0041FE5B                             | 3B148D A8994200                  | cmp edx,dword ptr ds:[ecx*4+4299A8]  |
0041FE62                             | 75 02                            | jne game.41FE66                      | --- not taken when good - taken when bad
0041FE64                             | EB 11                            | jmp game.41FE77                      |
0041FE66                             | 8B85 BCFBFFFF                    | mov eax,dword ptr ss:[ebp-444]       |

3B148D ???????? 75

CD Checks:
0041F7BA                             | 75 11                             | jne game.41F7CD                but is taken when bad?    exits if changed     not taken when good         |
0041FA43                             | 74 70                             | je game.41FAB5                                   |  is taken when good - not taken when bad
0041FBCF                             | 75 11                             | jne game.41FBE2                                  | not taken when good  (is taken when bad) -
0041FE62                             | 75 02                            | jne game.41FE66                      | --- not taken when good - taken when bad
^ with the CD in can change all of these and not hit issues

--------------------------------------------------------------------------------

There's no DD1D
loads of DD5D for 004190BF                             | DD5D C8                           | fstp qword ptr ss:[ebp-38]                       |

Hits this one first:
004194E2                             | DD5D CC                           | fstp qword ptr ss:[ebp-34]                       |

Don't even need to do geometry ?!?!? Just works it seems

1st Geometry ???
004194E2                             | DD5D CC                           | fstp qword ptr ss:[ebp-34]                       |
004194E5                             | DD45 CC                           | fld qword ptr ss:[ebp-34]                        |
004194E8                             | DC1D F0EC4400                     | fcomp qword ptr ds:[44ECF0]                      |
004194EE                             | DFE0                              | fnstsw ax                                        |
004194F0                             | F6C4 01                           | test ah,1                                        |   <---- ah should be 0
004194F3                             | 75 5D                             | jne game.419552                                  |   <--- not taken    <---- force this to be not taken NOP - NOPing will work
^ maybe should be 1 ??? really? dont think

2nd Geometry ???
0041950A                             | DB45 C0                           | fild dword ptr ss:[ebp-40]                       |
0041950D                             | DD5D B8                           | fstp qword ptr ss:[ebp-48]                       |
00419510                             | DD05 E8EC4400                     | fld qword ptr ds:[44ECE8]                        |
00419516                             | DC4D B8                           | fmul qword ptr ss:[ebp-48]                       |
00419519                             | DC0D E0EC4400                     | fmul qword ptr ds:[44ECE0]                       |
0041951F                             | DC5D C4                           | fcomp qword ptr ss:[ebp-3C]                      |
00419522                             | DFE0                              | fnstsw ax                                        |
00419524                             | F6C4 01                           | test ah,1                                        |  ah == 1
00419527                             | 74 29                             | je game.419552                                   |  is not taken     <---- force this to NOP

3rd Geometry ???
0041977F                             | DD5D B0                          | fstp qword ptr ss:[ebp-50]                       |
00419782                             | DB05 982C4500                    | fild dword ptr ds:[452C98]                       |
00419788                             | DD5D A8                          | fstp qword ptr ss:[ebp-58]                       |
0041978B                             | DD45 A8                          | fld qword ptr ss:[ebp-58]                        |
0041978E                             | DC0D D8EC4400                    | fmul qword ptr ds:[44ECD8]                       |
00419794                             | DC5D B0                          | fcomp qword ptr ss:[ebp-50]                      |
00419797                             | DFE0                             | fnstsw ax                                        |
00419799                             | F6C4 01                          | test ah,1                                        |  ah == 01
0041979C                             | 0F85 24010000                    | jne game.4198C6                                  |  taken can be JMP   <--- cannot be NOP
^ maybe should be 0? really? dont think

4th Geometry
00419BB3                             | DD5D A0                          | fstp qword ptr ss:[ebp-60]                       |
00419BB6                             | DB05 982C4500                    | fild dword ptr ds:[452C98]                       |
00419BBC                             | DD5D 98                          | fstp qword ptr ss:[ebp-68]                       |
00419BBF                             | DD45 98                          | fld qword ptr ss:[ebp-68]                        |
00419BC2                             | DC0D E0EC4400                    | fmul qword ptr ds:[44ECE0]                       |
00419BC8                             | DC5D A0                          | fcomp qword ptr ss:[ebp-60]                      |
00419BCB                             | DFE0                             | fnstsw ax                                        |
00419BCD                             | F6C4 01                          | test ah,1                                        |  ah === 0
00419BD0                             | 74 02                            | je game.419BD4                                   |  is taken   can be JMP or NOP
00419BD2                             | EB 0F                            | jmp game.419BE3                                  |
00419BD4                             | 837D 08 09                       | cmp dword ptr ss:[ebp+8],9                       | 09:'\t'
00419BD8                             | 7C 09                            | jl game.419BE3                                   |

5th Geometry
00419C1D                             | DB45 D4                          | fild dword ptr ss:[ebp-2C]                       |
00419C20                             | DD5D 90                          | fstp qword ptr ss:[ebp-70]                       |
00419C23                             | DB05 982C4500                    | fild dword ptr ds:[452C98]                       |
00419C29                             | DD5D 88                          | fstp qword ptr ss:[ebp-78]                       |
00419C2C                             | DD45 88                          | fld qword ptr ss:[ebp-78]                        |
00419C2F                             | DC0D E0EC4400                    | fmul qword ptr ds:[44ECE0]                       |
00419C35                             | DC5D 90                          | fcomp qword ptr ss:[ebp-70]                      |
00419C38                             | DFE0                             | fnstsw ax                                        |
00419C3A                             | F6C4 01                          | test ah,1                                        |  ah = 0 ???
00419C3D                             | 0F84 44070000                    | je game.41A387                                   | is taken    can be JMP or NOP

part of function:
004194BC <game.sub_4194BC>           | 3B4D 08                           | cmp ecx,dword ptr ss:[ebp+8]                     |

Broke here 
004180F1                             | 74 01                             | je game.4180F4                                   |
004180F3                             | CC                                | int3                                             |                 <----- IT was the TRAP FLAG needing to be set !! putting a breakpoint here somehow fixes it ?!?! and it can no longer detect breakpoints
004180F4                             | 8B4D E0                           | mov ecx,dword ptr ss:[ebp-20]                    |
it's the only 74 01 CC - can NOP the int 3 and no bad impact

Called from here:
004178C9                             | E8 021B0000                       | call game.4193D0                                 |
004178CE                             | 85C0                              | test eax,eax                                     |
004178D0                             | 74 0E                             | je game.4178E0       is taken when good!                            |
004178D2                             | 83BD FCFEFFFF 03                  | cmp dword ptr ss:[ebp-104],3                     |
004178D9                             | 7C 05                             | jl game.4178E0                                   |
004178DB                             | E9 EF010000                       | jmp game.417ACF                                  |
004178E0                             | C705 E4F14400 01000000            | mov dword ptr ds:[44F1E4],1                      |



SEH:
004150C0                             | 55                                | push ebp                                         |
....
004151CB                             | 8139 04000080                     | cmp dword ptr ds:[ecx],80000004                  |
004151D1                             | 0F85 9A020000                     | jne game.415471                                  |
004151D7                             | 8B55 10                           | mov edx,dword ptr ss:[ebp+10]                    |
004151DA                             | 8B42 14                           | mov eax,dword ptr ds:[edx+14]                    |   <---- DR6
004151DD                             | 83E0 0F                           | and eax,F                                        |
004151E0                             | 85C0                              | test eax,eax                                     |
004151E2                             | 74 3C                             | je game.415220                                   | 

Another SEH:
00418720 <game.sub_418720>           | 55                               | push ebp                                                      |

It kills me:
00420CCF                             | 75 10                            | jne game.420CE1                                  |
00420CD1                             | FF7424 08                        | push dword ptr ss:[esp+8]                        |
00420CD5                             | 893D 88F34400                    | mov dword ptr ds:[44F388],edi                    |
00420CDB                             | FF15 04544500                    | call dword ptr ds:[<ExitProcess>]                |
00420CE1                             | 5F                               | pop edi                                          |
00420CE2                             | C3                               | ret                                              |

trace into:
0x{p:cip} {i:cip}


---------------------------------------------

jmp over this nonsense with:
004196E5                             | EB 48                            | jmp game.41972F                      |

004196EE                             | 68 48164500                      | push game.451648                     |
004196F3                             | E8 586D0000                      | call game.420450                     |
004196F8                             | 83C4 0C                          | add esp,C                            |
004196FB                             | 85C0                             | test eax,eax                         |
004196FD                             | 75 24                            | jne game.419723                      |
004196FF                             | 6A 0D                            | push D                               |
00419701                             | 68 40B64400                      | push game.44B640                     |
00419706                             | 68 50164500                      | push game.451650                     |
0041970B                             | E8 406D0000                      | call game.420450                     |
00419710                             | 83C4 0C                          | add esp,C                            |
00419713                             | 85C0                             | test eax,eax                         |
00419715                             | 75 0C                            | jne game.419723                      |
00419717                             | C705 FCF14400 00000000           | mov dword ptr ds:[44F1FC],0          |
00419721                             | EB 0A                            | jmp game.41972D                      |
00419723                             | C705 FCF14400 00000000           | mov dword ptr ds:[44F1FC],0          |
0041972D                             | EB 0A                            | jmp game.419739                      |
0041972F                             | C705 FCF14400 00000000           | mov dword ptr ds:[44F1FC],0          |
00419739                             | 8B0D FCF14400                    | mov ecx,dword ptr ds:[44F1FC]        |


Big ol jump of tests:
0041EEF7                             | 8B0D 901A4500                    | mov ecx,dword ptr ds:[451A90]        | ecx:NtQueryObject+C
0041EEFD                             | 81E1 00080000                    | and ecx,800                          | ecx:NtQueryObject+C
0041EF03                             | 85C9                             | test ecx,ecx                         | ecx:NtQueryObject+C
0041EF05                             | 0F85 DA080000                    | jne game.41F7E5                      |
0041EF0B                             | C785 00FDFFFF 00000000           | mov dword ptr ss:[ebp-300],0         |
0041EF15                             | 8B15 B0F24400                    | mov edx,dword ptr ds:[44F2B0]        |


-------------
0041509F                             | FF15 80F64400                    | call dword ptr ds:[<&ReadProcessMemory>]                      |
Called from:
00418263                             | E8 18CEFFFF                      | call <game.sub_415080>                                        |
00418268                             | C745 F0 00000000                 | mov dword ptr ss:[ebp-10],0                                   |
0041826F                             | EB 09                            | jmp game.41827A                                               |


004200D1                             | 8B15 B8F24400                    | mov edx,dword ptr ds:[44F2B8]                                 |
004200D7                             | 52                               | push edx                                                      |
004200D8                             | E8 A34FFFFF                      | call <game.sub_415080>                                        |
004200DD                             | 8D85 74FBFFFF                    | lea eax,dword ptr ss:[ebp-48C]                                |
004200E3                             | 50                               | push eax                                                      |

00420179                             | 833D 20174500 01                 | cmp dword ptr ds:[451720],1                                   |
00420180                             | 75 48                            | jne game.4201CA                                               | <---- interesting jmp ? taken bad - not taken should be good - but can crash
related:
004192E0                             | 68 C0164500                      | push game.4516C0                                              |
004192E5                             | 68 002C4500                      | push game.452C00                                              |
004192EA                             | E8 61710000                      | call game.420450                                              |
004192EF                             | 83C4 0C                          | add esp,C                                                     |
004192F2                             | 85C0                             | test eax,eax                                                  |
004192F4                             | 74 0C                            | je game.419302                                                |
004192F6                             | C705 20174500 00000000           | mov dword ptr ds:[451720],0                                   |
00419300                             | EB 0A                            | jmp game.41930C                                               |
00419302                             | C705 20174500 01000000           | mov dword ptr ds:[451720],1                                   |
0041930C                             | EB 2E                            | jmp game.41933C                                               |
0041930E                             | 6A 40                            | push 40                                                       |
00419310                             | 68 C0164500                      | push game.4516C0                                              |
00419315                             | 68 002C4500                      | push game.452C00                                              |
0041931A                             | E8 31710000                      | call game.420450                                              |
0041931F                             | 83C4 0C                          | add esp,C                                                     |
00419322                             | 85C0                             | test eax,eax                                                  |
00419324                             | 74 0C                            | je game.419332                                                |
00419326                             | C705 20174500 00000000           | mov dword ptr ds:[451720],0                                   |
00419330                             | EB 0A                            | jmp game.41933C                                               |
00419332                             | C705 20174500 01000000           | mov dword ptr ds:[451720],1                                   |
0041933C                             | 5D                               | pop ebp                                                       |

00420450                             | 8B4424 0C                        | mov eax,dword ptr ss:[esp+C]                                  | <--- seems like a check function to me

00420450                             | B8 00000000                      | mov eax,0                                                     | eax:NVDEV_Thunk+55338D
00420455                             | C3                               | ret                                                           |
^ can change without a problem - maybe all check functions should be changed?

00420450                             | 31C0                             | xor eax,eax                                                   |
00420452                             | C3                               | ret                                                           |
00420453                             | 90                               | nop                                                           |

68 ???????? 68 ???????? E8 ???????? 83C4 0C 85C0

00420A10 <game.sub_420A10>           | 55                               | push ebp                                                      | <---- another check ???  can xor eax,eax ret and be fine
00421D9A <game.sub_421D9A>           | 8B4424 04                        | mov eax,dword ptr ss:[esp+4]                                  |
0042203E <game.sub_42203E>           | 55                               | push ebp                                                      |
00426F04 <game.sub_426F04>           | 55                               | push ebp                                                      |

-------------------------------
Memory breakpoints:
0041540C                             | 8955 F8                          | mov dword ptr ss:[ebp-8],edx                                  |
0041540F                             | 8B45 F8                          | mov eax,dword ptr ss:[ebp-8]                                  |
00415412                             | 8A00                             | mov al,byte ptr ds:[eax]                                      |
00415414                             | 8845 FC                          | mov byte ptr ss:[ebp-4],al                                    |
00415417                             | 8A0D F4F24400                    | mov cl,byte ptr ds:[44F2F4]                                   |
0041541D                             | 80C1 01                          | add cl,1                                                      |


5th Geometry
00419C1D                             | DB45 D4                          | fild dword ptr ss:[ebp-2C]                       |

Maybe starting to do lots of checks?
0041559B                             | 0F87 9D010000                    | ja game.41573E                                                |
004155A1                             | 8B45 F8                          | mov eax,dword ptr ss:[ebp-8]                                  |
004155A4                             | 33D2                             | xor edx,edx                                                   |
004155A6                             | 8A90 B45A4100                    | mov dl,byte ptr ds:[eax+415AB4]                               |
004155AC                             | FF2495 785A4100                  | jmp dword ptr ds:[edx*4+415A78]                               |
004155B3                             | 8B4D 08                          | mov ecx,dword ptr ss:[ebp+8]                                  |
004155B6                             | C1E1 07                          | shl ecx,7                                                     |
004155B9                             | 81C1 789A4200                    | add ecx,game.429A78                                           |
004155BF                             | 51                               | push ecx                                                      |
004155C0                             | 68 C0F74400                      | push game.44F7C0                                              |
004155C5                             | E8 16B00000                      | call game.4205E0                                              |
004155CA                             | 83C4 08                          | add esp,8                                                     |
004155CD                             | E9 B3010000                      | jmp game.415785                                               |
004155D2                             | 8B55 08                          | mov edx,dword ptr ss:[ebp+8]                                  |
004155D5                             | C1E2 07                          | shl edx,7                                                     |
004155D8                             | 81C2 789A4200                    | add edx,game.429A78                                           |
004155DE                             | 52                               | push edx                                                      |
004155DF                             | 68 C0F74400                      | push game.44F7C0                                              |
004155E4                             | E8 F7AF0000                      | call game.4205E0                                              |



00420008                             | EB 03                            | jmp game.42000D                                               |
0042000A                             | 58                               | pop eax                                                       |  <---- jmp to OEP  00402330
0042000B                             | FFE0                             | jmp eax                                                       |
0042000D                             | A3 08174500                      | mov dword ptr ds:[451708],eax                                 | 00451708:"0\"@"
00420012                             | E8 6981FFFF                      | call game.418180                                              |


----------------
So maybe getting these two checks turned off was enough? Nope
00420450
00420550 
00415000

It writes the OEP block here:
0041865D <game.sub_41865D>           | 8B45 F4                          | mov eax,dword ptr ss:[ebp-C]                                  |
00418660                             | 25 FFFF0000                      | and eax,FFFF                                                  |
00418665                             | 8B4D EC                          | mov ecx,dword ptr ss:[ebp-14]                                 |
00418668                             | 2BC8                             | sub ecx,eax                                                   |
0041866A                             | 8B55 F4                          | mov edx,dword ptr ss:[ebp-C]                                  |
0041866D                             | 81E2 FFFF0000                    | and edx,FFFF                                                  |
00418673                             | 8B45 EC                          | mov eax,dword ptr ss:[ebp-14]                                 |
00418676                             | 2BC2                             | sub eax,edx                                                   |
00418678                             | 8B55 E4                          | mov edx,dword ptr ss:[ebp-1C]                                 |
0041867B                             | 81E2 FFFF0000                    | and edx,FFFF                                                  |
00418681                             | 2BC2                             | sub eax,edx                                                   |
00418683                             | 8B55 FC                          | mov edx,dword ptr ss:[ebp-4]                                  |
00418686                             | 8A0C0A                           | mov cl,byte ptr ds:[edx+ecx]                                  |
00418689                             | 8888 C0164500                    | mov byte ptr ds:[eax+4516C0],cl                               |
0041868F                             | 8B55 EC                          | mov edx,dword ptr ss:[ebp-14]                                 |
00418692                             | 83C2 01                          | add edx,1                                                     |
00418695                             | 8955 EC                          | mov dword ptr ss:[ebp-14],edx                                 |
00418698                             | E9 7BFDFFFF                      | jmp game.418418                                               |
0041869D                             | 837D F0 00                       | cmp dword ptr ss:[ebp-10],0                                   |
004186A1                             | 75 0A                            | jne game.4186AD                                               |
004186A3                             | C705 E4F14400 01000000           | mov dword ptr ds:[44F1E4],1                                   |
004186AD                             | 837D F0 08                       | cmp dword ptr ss:[ebp-10],8                                   |
004186B1                             | 75 08                            | jne game.4186BB                                               |
004186B3                             | B8 03000000                      | mov eax,3                                                     |
004186B8                             | C600 18                          | mov byte ptr ds:[eax],18                                      |
004186BB                             | E9 B1FBFFFF                      | jmp game.418271                                               |
004186C0                             | 8D45 E8                          | lea eax,dword ptr ss:[ebp-18]                                 |
004186C3                             | 50                               | push eax                                                      |
004186C4                             | 33C9                             | xor ecx,ecx                                                   |
004186C6                             | 66:8B0D C21A4500                 | mov cx,word ptr ds:[451AC2]                                   |
004186CD                             | 51                               | push ecx                                                      |
004186CE                             | 8B55 FC                          | mov edx,dword ptr ss:[ebp-4]                                  |
004186D1                             | 52                               | push edx                                                      |
004186D2                             | A1 08174500                      | mov eax,dword ptr ds:[451708]                                 | 00451708:"0\"@"
004186D7                             | 50                               | push eax                                                      |
004186D8                             | 8B0D B8F24400                    | mov ecx,dword ptr ds:[44F2B8]                                 |
004186DE                             | 51                               | push ecx                                                      |
004186DF                             | FF15 44FC4400                    | call dword ptr ds:[<&WriteProcessMemory>]                     |
004186E5                             | 8B55 FC                          | mov edx,dword ptr ss:[ebp-4]                                  |
004186E8                             | 52                               | push edx                                                      |
004186E9                             | E8 EA7B0000                      | call <game.sub_4202D8>                                        |


Top of it looks like:
00418180                             | 55                               | push ebp                                                      |


it checked here:
004196E5                             | 74 48                            | je game.41972F                                                |
004196E7                             | 6A 07                            | push 7                                                        |
004196E9                             | 68 38B64400                      | push game.44B638                                              |
004196EE                             | 68 48164500                      | push game.451648                                              |
004196F3                             | E8 586D0000                      | call <game.sub_420450>                                        |
004196F8                             | 83C4 0C                          | add esp,C                                                     |
004196FB                             | 85C0                             | test eax,eax                                                  |
004196FD                             | 75 24                            | jne game.419723                                               |
004196FF                             | 6A 0D                            | push D                                                        |
00419701                             | 68 40B64400                      | push game.44B640                                              |
00419706                             | 68 50164500                      | push game.451650                                              |
0041970B                             | E8 406D0000                      | call <game.sub_420450>                                        |
00419710                             | 83C4 0C                          | add esp,C                                                     |
00419713                             | 85C0                             | test eax,eax                                                  |
00419715                             | 75 0C                            | jne game.419723                                               |
00419717                             | C705 FCF14400 01000000           | mov dword ptr ds:[44F1FC],1                                   |

----------
Second WriteProcessMemory writes the Geometry section - 0044F308  00 5B 41 00 00 00 00 00 00 00 00 00 00 00 00 00  .[A.............  
then it frees the memory - it writes to 415B00 


004178C8                             | 52                               | push edx                                                      |
004178C9                             | E8 021B0000                      | call <game.sub_4193D0>                                        |  <--- geo func
004178CE                             | 85C0                             | test eax,eax                                                  |
004178D0                             | 74 0E                            | je game.4178E0                                                |
004178D2                             | 83BD FCFEFFFF 03                 | cmp dword ptr ss:[ebp-104],3                                  |


The whole CD Func:
0041FF3E                             | 51                               | push ecx                                                      |
0041FF3F                             | E8 CC5BFFFF                      | call <game.sub_415B10>                                        |
0041FF44                             | A3 9C2C4500                      | mov dword ptr ds:[452C9C],eax                                 |    1?

---------------------
004204FC  C3 8B EC 83 EC 20 8B 45 08 56 89 45 E8 89 45 E0  Ã.ì.ì .E.V.Eè.Eà  
004204FC <game.sub_4204FC>           | C3                               | ret                                                           |

------
1. 004194E2                             | DD5D CC                          | fstp qword ptr ss:[ebp-34]                                    |
2. 004194FB                             | DD5D C4                          | fstp qword ptr ss:[ebp-3C]                                    |
3. 0041950D                             | DD5D B8                          | fstp qword ptr ss:[ebp-48]                                    |
4. 0041977F                             | DD5D B0                          | fstp qword ptr ss:[ebp-50]                                    |
5. 00419788                             | DD5D A8                          | fstp qword ptr ss:[ebp-58]                                    |
6. 00419BB3                             | DD5D A0                          | fstp qword ptr ss:[ebp-60]                                    |
7. 00419BBC                             | DD5D 98                          | fstp qword ptr ss:[ebp-68]                                    |
8. 00419C20                             | DD5D 90                          | fstp qword ptr ss:[ebp-70]                                    |
10.00419C29                             | DD5D 88                          | fstp qword ptr ss:[ebp-78]                                    |
11.00419C46                             | DD5D 80                          | fstp qword ptr ss:[ebp-80]                                    |



00417B1A                             | C2 1400                          | ret 14                                                        |

415B10

--------------------------------------
0041AC64                             | 66:9C                            | pushf                                                         |
0041AC66                             | 8075 FF 01                       | xor byte ptr ss:[ebp-1],1                                     |
0041AC6A                             | 66:9D                            | popf                                                          |
^ putting trap on?


-----------------------------------------------
0041B14F                             | 8B15 F8F24400                    | mov edx,dword ptr ds:[44F2F8]                                 |  <--- 22 to begin with - this is a tight loop
0041B155                             | 8995 78FBFFFF                    | mov dword ptr ss:[ebp-488],edx                                |
0041B15B                             | E9 50FFFFFF                      | jmp game.41B0B0                                               |
0041B160                             | A1 EC184500                      | mov eax,dword ptr ds:[4518EC]                                 |
0041B165                             | 8B0D F8F24400                    | mov ecx,dword ptr ds:[44F2F8]                                 |   <---- 48DC first time is only time!- this is the counter from the exception handler
0041B16B                             | 8908                             | mov dword ptr ds:[eax],ecx                                    |
0041B16D                             | 8D95 74FBFFFF                    | lea edx,dword ptr ss:[ebp-48C]                                |
0041B173                             | 52                               | push edx                                                      |
0041B174                             | 8B85 9CFEFFFF                    | mov eax,dword ptr ss:[ebp-164]                                | [ebp-164]:L"Pulaar (Gine)"
0041B17A                             | 50                               | push eax                                                      |
0041B17B                             | 8B8D F4FCFFFF                    | mov ecx,dword ptr ss:[ebp-30C]                                |
0041B181                             | 51                               | push ecx                                                      |
0041B182                             | 8B15 08F34400                    | mov edx,dword ptr ds:[44F308]                                 |
0041B188                             | 52                               | push edx                                                      |
0041B189                             | A1 B8F24400                      | mov eax,dword ptr ds:[44F2B8]                                 |
0041B18E                             | 50                               | push eax                                                      |
0041B18F                             | FF15 44FC4400                    | call dword ptr ds:[<&WriteProcessMemory>]                     |

00419B2F                             | 8A15 F4F24400                    | mov dl,byte ptr ds:[44F2F4]                                   |   <--- 8   can just force these to 8  - gets around the debug detection :)) 00419B2F   B2 08                            | mov dl,8                                                      |
00419B35                             | 8BC2                             | mov eax,edx                                                   |
00419B37                             | 83E8 08                          | sub eax,8                                                     |
00419B3A                             | 99                               | cdq                                                           |
00419B3B                             | B9 1C000000                      | mov ecx,1C                                                    |
00419B40                             | F7F9                             | idiv ecx                                                      |
00419B42                             | 8B55 FC                          | mov edx,dword ptr ss:[ebp-4]                                  |
00419B45                             | 0314C5 20194500                  | add edx,dword ptr ds:[eax*8+451920]                           |

00419B58                             | 33C9                             | xor ecx,ecx                                                   |
00419B5A                             | 8A0D F4F24400                    | mov cl,byte ptr ds:[44F2F4]                                   |   <---- 8  can just force these to 8  - gets around the debug detection :)) 00419B5A   B1 08                            | mov cl,8                                                      |
00419B60                             | 83C1 0B                          | add ecx,B                                                     |
00419B63                             | 8B55 E4                          | mov edx,dword ptr ss:[ebp-1C]                                 |
00419B66                             | 6BD2 1C                          | imul edx,edx,1C                                               |
00419B69                             | 2BCA                             | sub ecx,edx                                                   |
00419B6B                             | 8B55 D4                          | mov edx,dword ptr ss:[ebp-2C]                                 |
00419B6E                             | 0394C8 00024500                  | add edx,dword ptr ds:[eax+ecx*8+450200]                       |
00419B75                             | 8955 D4                          | mov dword ptr ss:[ebp-2C],edx                                 |
00419B78                             | EB A2                            | jmp game.419B1C                                               |
00419B7A                             | 837D E0 00                       | cmp dword ptr ss:[ebp-20],0                                   |
00419B7E                             | 75 2A                            | jne game.419BAA                                               |

^ just before the fstp

0041B48E                             | E8 ED9FFFFF                      | call <game.sub_415480>                                        |
0041B493                             | A2 F4F24400                      | mov byte ptr ds:[44F2F4],al                                   |   <---- never gets called after the read anyway

--------------------------------------------------------------------------------------------------------------------------------
Gunman Chronicles - 4.16

SEH:
00508417                             | 8A0D E8E05300                    | mov cl,byte ptr ds:[53E0E8]                                   |
0050841D                             | 80C1 01                          | add cl,1                                                      |
00508420                             | 880D E8E05300                    | mov byte ptr ds:[53E0E8],cl                                   |

0050CE5E                             | 8A0D E8E05300                    | mov cl,byte ptr ds:[53E0E8]                                   |
0050CE64                             | 8BC1                             | mov eax,ecx                                                   |
0050CE66                             | 83E8 08                          | sub eax,8                                                     |
0050CE69                             | 99                               | cdq                                                           |
0050CE6A                             | B9 1C000000                      | mov ecx,1C                                                    |
0050CE6F                             | F7F9                             | idiv ecx                                                      |
0050CE71                             | 8B55 FC                          | mov edx,dword ptr ss:[ebp-4]                                  |
0050CE74                             | 0314C5 20075400                  | add edx,dword ptr ds:[eax*8+540720]                           |
0050CE7B                             | 8955 FC                          | mov dword ptr ss:[ebp-4],edx                                  |
0050CE7E                             | 8B45 E4                          | mov eax,dword ptr ss:[ebp-1C]                                 | [ebp-1C]:TpWorkOnBehalfSetTicket+1EF
0050CE81                             | 69C0 F8010000                    | imul eax,eax,1F8                                              |
0050CE87                             | 33C9                             | xor ecx,ecx                                                   |
0050CE89                             | 8A0D E8E05300                    | mov cl,byte ptr ds:[53E0E8]                                   |
0050CE8F                             | 83C1 0B                          | add ecx,B                                                     |
0050CE92                             | 8B55 E4                          | mov edx,dword ptr ss:[ebp-1C]                                 | [ebp-1C]:TpWorkOnBehalfSetTicket+1EF
0050CE95                             | 6BD2 1C                          | imul edx,edx,1C                                               |
0050CE98                             | 2BCA                             | sub ecx,edx                                                   |
0050CE9A                             | 8B55 D4                          | mov edx,dword ptr ss:[ebp-2C]                                 |
0050CE9D                             | 0394C8 00F05300                  | add edx,dword ptr ds:[eax+ecx*8+53F000]                       | eax+ecx*8+53F000:const vgui::App::`vftable'+8F894
0050CEA4                             | 8955 D4                          | mov dword ptr ss:[ebp-2C],edx                                 |
0050CEA7                             | EB A2                            | jmp gunman.50CE4B                                             |

Get's the PVD:
00512992                             | 83C0 10                          | add eax,10                                                    |
00512995                             | 50                               | push eax                                                      |
00512996                             | 8B0D 60E55300                    | mov ecx,dword ptr ds:[53E560]                                 |
0051299C                             | 51                               | push ecx                                                      |
0051299D                             | FF15 68045400                    | call dword ptr ds:[<&RLOS32>]        <----- done here
005129A3                             | A3 B0E45300                      | mov dword ptr ds:[53E4B0],eax                                 |
005129A8                             | 833D B0E45300 00                 | cmp dword ptr ds:[53E4B0],0                                   |
005129AF                             | 75 1C                            | jne gunman.5129CD                                             |
005129B1                             | 8B15 A4E05300                    | mov edx,dword ptr ds:[53E0A4]                                 |
005129B7                             | 52                               | push edx                                                      |
005129B8                             | FF15 A0E45300                    | call dword ptr ds:[<&CloseHandle>]                            |
005129BE                             | C705 A4E05300 00000000           | mov dword ptr ds:[53E0A4],0                                   |
005129C8                             | E9 2CF9FFFF                      | jmp gunman.5122F9                                             |
005129CD                             | A1 F4E05300                      | mov eax,dword ptr ds:[53E0F4]                                 |

00512A4F                             | 83C0 01                          | add eax,1                                                     |
00512A52                             | 8985 C0FBFFFF                    | mov dword ptr ss:[ebp-440],eax                                |
00512A58                             | 81BD C0FBFFFF 00020000           | cmp dword ptr ss:[ebp-440],200                                |
00512A62                             | 7D 1B                            | jge gunman.512A7F                                             |
00512A64                             | 8B8D C0FBFFFF                    | mov ecx,dword ptr ss:[ebp-440]                                |
00512A6A                             | 8B15 10075400                    | mov edx,dword ptr ds:[540710]                                 |
00512A70                             | 03148D E0095400                  | add edx,dword ptr ds:[ecx*4+5409E0]                           |
00512A77                             | 8915 10075400                    | mov dword ptr ds:[540710],edx                                 |
00512A7D                             | EB CA                            | jmp gunman.512A49                                             |
00512A7F                             | A1 A8C95100                      | mov eax,dword ptr ds:[51C9A8]                                 |
00512A84                             | 3B05 10075400                    | cmp eax,dword ptr ds:[540710]                                 | 00540710:"&FYF"
00512A8A                             | 75 11                            | jne gunman.512A9D                CD Check 1 ?!                             | 
?

Looks familiar:
00512CAC                             | 833D 04E05300 00                 | cmp dword ptr ds:[53E004],0                                   |
00512CB3                             | 74 72                            | je gunman.512D27                                     <---- force        |
00512CB5                             | 813D FCDF5300 00005F00           | cmp dword ptr ds:[53DFFC],5F0000                              |
00512CBF                             | 72 18                            | jb gunman.512CD9                                              |
00512CC1                             | 813D 00E05300 00004A00           | cmp dword ptr ds:[53E000],gunman.4A0000                       |
00512CCB                             | 72 0C                            | jb gunman.512CD9                                              |
00512CCD                             | C705 08E05300 01000000           | mov dword ptr ds:[53E008],1                                   |

74 ?? 813D ???????? 00005F00

00512E3E                             | 81E9 96000000                    | sub ecx,96                                                    |
00512E44                             | 390D 58E55300                    | cmp dword ptr ds:[53E558],ecx                                 |
00512E4A                             | 75 14                            | jne gunman.512E60                                             |
00512E4C                             | 8B15 F4E05300                    | mov edx,dword ptr ds:[53E0F4]                                 |


0050CAAF                             | DB45 D4                          | fild dword ptr ss:[ebp-2C]                                    | [ebp-2C]:const vgui::App::`vftable'+2E35C
0050CAB2                             | DD5D B0                          | fstp qword ptr ss:[ebp-50]                                    |
0050CAB5                             | DB05 981A5400                    | fild dword ptr ds:[541A98]                                    |
0050CABB                             | DD5D A8                          | fstp qword ptr ss:[ebp-58]                                    |
0050CABE                             | DD45 A8                          | fld qword ptr ss:[ebp-58]                                     |
0050CAC1                             | DC0D E8DA5300                    | fmul qword ptr ds:[53DAE8]                                    |
0050CAC7                             | DC5D B0                          | fcomp qword ptr ss:[ebp-50]                                   |
0050CACA                             | DFE0                             | fnstsw ax                                                     |
0050CACC                             | F6C4 01                          | test ah,1                                                     |
0050CACF                             | E9 22010000                      | jmp gunman.50CBF6          <---- force the first of this wacky things      |  0050CACF    | 0F85 21010000     | jne gunman.50CBF6                                             |
0050CAD4                             | 90                               | nop                                                           |

DB45 ?? DD 5D ?? DB 05 ???????? DD5D ?? DD45 ?? DC0D ???????? DC5D ?? DFE0 F6C401 0F85

0050CACF - 0050CAAF = 20

------------------------------------------------------------------------------------------------------------------------
Homeworld Cataclysm - 4.08.00 - needs VersionInjector

00B047DE                             | 8B15 98D9B000                    | mov edx,dword ptr ds:[B0D998]                                 |
00B047E4                             | 3B15 50F6B200                    | cmp edx,dword ptr ds:[B2F650]                                 | 00B2F650:"&FYF"
00B047EA                             | 90                               | nop                                                           |
00B047EB                             | 90                               | nop                                                           |


00B04B93                             | 2D 96000000                      | sub eax,96                 <--- needed a change to support eax                                    |
00B04B98                             | 3905 98D4B200                    | cmp dword ptr ds:[B2D498],eax                                 |
00B04B9E                             | 75 14                            | jne cataclysm.B04BB4                                          |
00B04BA0                             | 8B0D 50D0B200                    | mov ecx,dword ptr ds:[B2D050]                                 |
00B04BA6                             | 81C9 00000400                    | or ecx,40000                                                  |
00B04BAC                             | 890D 50D0B200                    | mov dword ptr ds:[B2D050],ecx                                 |
00B04BB2                             | EB 12                            | jmp cataclysm.B04BC6                                          |

---------------------------------------------------------------------------------------------------------------------------
Kohan Ahrimans Gift - v1.37 - 4.84.63

SEH:
0069B5B0                             | 8A00                             | mov al,byte ptr ds:[eax]                                      |
0069B5B2                             | 8845 FC                          | mov byte ptr ss:[ebp-4],al                                    |
0069B5B5                             | 8A15 C8577400                    | mov dl,byte ptr ds:[7457C8]                                   |
0069B5BB                             | 80C2 01                          | add dl,1                                                      |
0069B5BE                             | 8815 C8577400                    | mov byte ptr ds:[7457C8],dl                                   |
0069B5C4                             | A1 CC577400                      | mov eax,dword ptr ds:[7457CC]                                 |
0069B5C9                             | 83C0 01                          | add eax,1                                                     |
0069B5CC                             | A3 CC577400                      | mov dword ptr ds:[7457CC],eax                                 |

006A5DB9                             | 8A0D C8577400                    | mov cl,byte ptr ds:[7457C8]                                   |
006A5DBF                             | 8BC1                             | mov eax,ecx                                                   |
006A5DC1                             | 83E8 08                          | sub eax,8                                                     |
006A5DC4                             | 99                               | cdq                                                           |
006A5DC5                             | B9 1C000000                      | mov ecx,1C                                                    |
006A5DCA                             | F7F9                             | idiv ecx                                                      |
006A5DCC                             | 8B55 FC                          | mov edx,dword ptr ss:[ebp-4]                                  |
006A5DCF                             | 031485 A0BA7400                  | add edx,dword ptr ds:[eax*4+74BAA0]                           | eax*4+74BAA0:struct CDAPFN_PROPERTIES CDAPFN0506_TGF_ValidateString+153060
006A5DD6                             | 8955 FC                          | mov dword ptr ss:[ebp-4],edx                                  |
006A5DD9                             | 8B45 E8                          | mov eax,dword ptr ss:[ebp-18]                                 |
006A5DDC                             | 69C0 FC000000                    | imul eax,eax,FC                                               |
006A5DE2                             | 33C9                             | xor ecx,ecx                                                   |
006A5DE4                             | 8A0D C8577400                    | mov cl,byte ptr ds:[7457C8]                                   |
006A5DEA                             | 83C1 0B                          | add ecx,B                                                     |
006A5DED                             | 8B55 E8                          | mov edx,dword ptr ss:[ebp-18]                                 |


006B40CF                             | A3 48587400                      | mov dword ptr ds:[745848],eax                                 |
006B40D4                             | 833D 48587400 00                 | cmp dword ptr ds:[745848],0                                   |
006B40DB                             | 0F84 90010000                    | je _ag_137.6B4271                                             |                                             |
006B40E1                             | 813D 40587400 00005F00           | cmp dword ptr ds:[745840],_ag_137.5F0000                      |
006B40EB                             | 72 18                            | jb _ag_137.6B4105                                             |
006B40ED                             | 813D 44587400 00004A00           | cmp dword ptr ds:[745844],_ag_137.4A0000                      |
006B40F7                             | 72 0C                            | jb _ag_137.6B4105                                             |

---------------------------------------------------------------------------------------------------------------------------
Jurassic Park - Operation Genesis - 4.84.64

All good - needs volumename to be sent as JPOG

But timing checks when the logs are off:

00D5DD1C                             | 8B55 90                          | mov edx,dword ptr ss:[ebp-70]                                 |
00D5DD1F                             | 83C2 01                          | add edx,1                                                     |
00D5DD22                             | 8955 90                          | mov dword ptr ss:[ebp-70],edx                                 |
00D5DD25                             | FF15 7C6BE000                    | call dword ptr ds:[<&timeGetTime>]                            |
00D5DD2B                             | A3 2C0EE000                      | mov dword ptr ds:[E00E2C],eax                                 |
00D5DD30                             | A1 BC15E000                      | mov eax,dword ptr ds:[E015BC]                                 |
00D5DD35                             | 05 C0D40100                      | add eax,1D4C0                                                 | 1D4C0:"???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
00D5DD3A                             | 3905 2C0EE000                    | cmp dword ptr ds:[E00E2C],eax                                 |
00D5DD40                             | 0F82 B4000000                    | jb simjp.D5DDFA                                               |

timesetevent uses this func:
00D5E800                             | 55                               | push ebp                                                      |
00D5E801                             | 8BEC                             | mov ebp,esp                                                   |
00D5E803                             | 83EC 10                          | sub esp,10                                                    |
00D5E806                             | 833D ACB5D800 00                 | cmp dword ptr ds:[D8B5AC],0                                   |
00D5E80D                             | 74 25                            | je simjp.D5E834                                               |
00D5E80F                             | DB05 4806E000                    | fild dword ptr ds:[E00648]                                    |
00D5E815                             | DD5D F8                          | fstp qword ptr ss:[ebp-8]                                     |
00D5E818                             | DB05 ACB5D800                    | fild dword ptr ds:[D8B5AC]                                    |
00D5E81E                             | DD5D F0                          | fstp qword ptr ss:[ebp-10]                                    |
00D5E821                             | DD05 4835DF00                    | fld qword ptr ds:[DF3548]                                     |
00D5E827                             | DC4D F0                          | fmul qword ptr ss:[ebp-10]                                    |
00D5E82A                             | DC5D F8                          | fcomp qword ptr ss:[ebp-8]                                    |
00D5E82D                             | DFE0                             | fnstsw ax                                                     |
00D5E82F                             | F6C4 01                          | test ah,1                                                     |
00D5E832                             | 74 07                            | je simjp.D5E83B                                               |
00D5E834                             | 6A FF                            | push FFFFFFFF                                                 |
00D5E836                             | E8 93E70100                      | call <simjp.sub_D7CFCE>                                       |
00D5E83B                             | 66:A1 88EADA00                   | mov ax,word ptr ds:[DAEA88]                                   |
00D5E841                             | 66:2D 0100                       | sub ax,1                                                      |
00D5E845                             | 66:A3 88EADA00                   | mov word ptr ds:[DAEA88],ax                                   |
00D5E84B                             | 8BE5                             | mov esp,ebp                                                   |
00D5E84D                             | 5D                               | pop ebp                                                       |
00D5E84E                             | C2 1400                          | ret 14                                                        |



00D5A946                             | 6A 00                            | push 0                                                        |
00D5A948                             | 8B15 E45CE000                    | mov edx,dword ptr ds:[E05CE4]                                 |
00D5A94E                             | 52                               | push edx                                                      |
00D5A94F                             | 68 00E8D500                      | push simjp.D5E800                                             |
00D5A954                             | 6A 00                            | push 0                                                        |
00D5A956                             | A1 E45CE000                      | mov eax,dword ptr ds:[E05CE4]                                 | eax:TpCallbackIndependent+140
00D5A95B                             | 50                               | push eax                                                      | eax:TpCallbackIndependent+140
00D5A95C                             | FF15 5015E000                    | call dword ptr ds:[<&timeSetEvent>]                           |

00D5EB40                             | 55                               | push ebp                                                      |
00D5EB41                             | 8BEC                             | mov ebp,esp                                                   |
00D5EB43                             | 83EC 08                          | sub esp,8                                                     |
00D5EB46                             | 837D 08 00                       | cmp dword ptr ss:[ebp+8],0                                    |
00D5EB4A                             | 75 02                            | jne simjp.D5EB4E                                              |
00D5EB4C                             | EB 75                            | jmp simjp.D5EBC3                                              |
00D5EB4E                             | 833D 9406E000 00                 | cmp dword ptr ds:[E00694],0                                   |
00D5EB55                             | 75 44                            | jne simjp.D5EB9B                                              |
00D5EB57                             | 6A 10                            | push 10                                                       |
00D5EB59                             | 6A 00                            | push 0                                                        |
00D5EB5B                             | A1 8C96E000                      | mov eax,dword ptr ds:[E0968C]                                 | eax:TpCallbackIndependent+140
00D5EB60                             | 50                               | push eax                                                      | eax:TpCallbackIndependent+140
00D5EB61                             | 6A 00                            | push 0                                                        |
00D5EB63                             | 8B4D 08                          | mov ecx,dword ptr ss:[ebp+8]                                  |
00D5EB66                             | 51                               | push ecx                                                      |
00D5EB67                             | FF15 5015E000                    | call dword ptr ds:[<&timeSetEvent>]                           |
00D5EB6D                             | 85C0                             | test eax,eax                                                  | eax:TpCallbackIndependent+140
00D5EB6F                             | 74 28                            | je simjp.D5EB99                                               |
00D5EB71                             | 833D 0407E000 00                 | cmp dword ptr ds:[E00704],0                                   |
00D5EB78                             | 74 11                            | je simjp.D5EB8B                                               |
00D5EB7A                             | 6A 32                            | push 32                                                       |
00D5EB7C                             | 8B15 8C96E000                    | mov edx,dword ptr ds:[E0968C]                                 |
00D5EB82                             | 52                               | push edx                                                      |
00D5EB83                             | FF15 2084E000                    | call dword ptr ds:[<&WaitForSingleObject>]                    |
00D5EB89                             | EB 0E                            | jmp simjp.D5EB99                                              |
00D5EB8B                             | 6A 0A                            | push A                                                        |
00D5EB8D                             | A1 8C96E000                      | mov eax,dword ptr ds:[E0968C]                                 | eax:TpCallbackIndependent+140
00D5EB92                             | 50                               | push eax                                                      | eax:TpCallbackIndependent+140
00D5EB93                             | FF15 2084E000                    | call dword ptr ds:[<&WaitForSingleObject>]                    |
00D5EB99                             | EB 28                            | jmp simjp.D5EBC3                                              |
00D5EB9B                             | FF15 7C6BE000                    | call dword ptr ds:[<&timeGetTime>]                            |
00D5EBA1                             | 8945 F8                          | mov dword ptr ss:[ebp-8],eax                                  | eax:TpCallbackIndependent+140
00D5EBA4                             | FF15 7C6BE000                    | call dword ptr ds:[<&timeGetTime>]                            |
00D5EBAA                             | 8945 FC                          | mov dword ptr ss:[ebp-4],eax                                  | eax:TpCallbackIndependent+140
00D5EBAD                             | 8B4D FC                          | mov ecx,dword ptr ss:[ebp-4]                                  |
00D5EBB0                             | 2B4D F8                          | sub ecx,dword ptr ss:[ebp-8]                                  |
00D5EBB3                             | 3B4D 08                          | cmp ecx,dword ptr ss:[ebp+8]                                  |
00D5EBB6                             | 73 0B                            | jae simjp.D5EBC3                                              |
00D5EBB8                             | FF15 7C6BE000                    | call dword ptr ds:[<&timeGetTime>]                            |
00D5EBBE                             | 8945 FC                          | mov dword ptr ss:[ebp-4],eax                                  | eax:TpCallbackIndependent+140
00D5EBC1                             | EB EA                            | jmp simjp.D5EBAD                                              |
00D5EBC3                             | 8BE5                             | mov esp,ebp                                                   |
00D5EBC5                             | 5D                               | pop ebp                                                       |
00D5EBC6                             | C2 0400                          | ret 4                                                         |

timesetevent never called and timegettime doesn't seem to matter

00D64910 <simjp.sub_D64910>          | 55                               | push ebp                                                      |
00D64911                             | 8BEC                             | mov ebp,esp                                                   |
00D64913                             | 8B45 08                          | mov eax,dword ptr ss:[ebp+8]                                  |
00D64916                             | 50                               | push eax                                                      |
00D64917                             | FF15 8096E000                    | call dword ptr ds:[<&QueryPerformanceCounter>]                |
00D6491D                             | 5D                               | pop ebp                                                       |
00D6491E                             | C2 0400                          | ret 4                                                         |
00D64921                             | CC                               | int3                                                          |

-------------------------------------------------------------------------------------------------------------------------------------------------------
Chronicles of Riddick Escape from Butcher Bay - 5.03.09

004100E1                                               | FFD0                             | call eax                                                      |
004100E3                                               | 50                               | push eax                                                      |
004100E4                                               | 6A 00                            | push 0                                                        |
004100E6                                               | E8 15490F00                      | call sbzengine.504A00                                         |   <--- msgbox to tell us our computer can't handle it 
004100EB                                               | F9                               | stc                                                           |
004100EC                                               | 8D4D CC                          | lea ecx,dword ptr ss:[ebp-34]                                 |
004100EF                                               | 895D FC                          | mov dword ptr ss:[ebp-4],ebx                                  |
004100F2                                               | E8 693F0300                      | call sbzengine.444060                                         |


038061D5                                               | 3D 00080000                      | cmp eax,800                                                                      |
038061DA                                               | 8986 E02F0000                    | mov dword ptr ds:[esi+2FE0],eax                                                  |
038061E0                                               | 7E 06                            | jle rndrgl.38061E8                                                               |  <--- could this be the texture check
038061E0 - 038061D5 = B

---------------------------------------------------------------------------------------------------------------------------------------------
Spellforce - The Order of Dawn v1.11 - 5.00.03

It's like Pirates! 

005B21EB | 032424                   | add esp,dword ptr ss:[esp]                                         |
005B21EE | 68 400B7000              | push ar.700B40                                                     | 700B40:"d:\\"
005B21F3 | FF15 80667000            | call dword ptr ds:[<&GetDriveTypeA>]                               |
005B21F9 | 83EC 04                  | sub esp,4                                                          |
005B21FC | 893424                   | mov dword ptr ss:[esp],esi                                         |
005B21FF | 8BF0                     | mov esi,eax                                                        |
005B2201 | 83EE 05                  | sub esi,5                                                          |

005B3247 | 6A 00                    | push 0                                                             |
005B3249 | 68 40697000              | push ar.706940                                                     |
005B324E | 6A 00                    | push 0                                                             |
005B3250 | 6A 00                    | push 0                                                             |
005B3252 | 6A 00                    | push 0                                                             |
005B3254 | 6A 00                    | push 0                                                             |
005B3256 | 68 00482D00              | push 2D4800                                                        |
005B325B | A1 A4DB6E00              | mov eax,dword ptr ds:[6EDBA4]                                      |
005B3260 | 83EC 04                  | sub esp,4                                                          |
005B3263 | 890424                   | mov dword ptr ss:[esp],eax                                         |
005B3266 | FF15 A4667000            | call dword ptr ds:[<&DeviceIoControl>]                             |


First Pirates CD Check Looked like:
00AAA9A5 | 74 01                    | je pirates!.AAA9A8                                                 |
00AAA9A7 | CC                       | int3                                                               |
00AAA9A8 | 8B5C24 10                | mov ebx,dword ptr ss:[esp+10]                                      |
00AAA9AC | 03FA                     | add edi,edx                                                        |
00AAA9AE | 8B5424 14                | mov edx,dword ptr ss:[esp+14]                                      | [esp+14]:EntryPoint
00AAA9B2 | 83C4 20                  | add esp,20                                                         |
00AAA9B5 | 873C24                   | xchg dword ptr ss:[esp],edi                                        |
00AAA9B8 | C74424 04 C2040063       | mov dword ptr ss:[esp+4],630004C2                                  |
00AAA9C0 | EB FA                    | jmp pirates!.AAA9BC                                                |
00AAA9C2 | 58                       | pop eax                                                            |
00AAA9C3 | C70424 F4010000          | mov dword ptr ss:[esp],1F4                                         |
00AAA9CA | 813424 F8010000          | xor dword ptr ss:[esp],1F8                                         |
00AAA9D1 | 032424                   | add esp,dword ptr ss:[esp]                                         |
00AAA9D4 | 83EC 04                  | sub esp,4                                                          |
00AAA9D7 | C70424 DFA89F00          | mov dword ptr ss:[esp],pirates!.9FA8DF                             |
00AAA9DE | 810424 C3020B00          | add dword ptr ss:[esp],B02C3                                       |
00AAA9E5 | EB FA                    | jmp pirates!.AAA9E1                                                |
00AAA9E7 | A1 A8BBB200              | mov eax,dword ptr ds:[B2BBA8]                                      |  A1 ???????? 83EC 04 890424
00AAA9EC | 83EC 04                  | sub esp,4                                                          |
00AAA9EF | 890424                   | mov dword ptr ss:[esp],eax                                         |
00AAA9F2 | 8BC0                     | mov eax,eax                                                        | 83EC 04 890424 8BC0 
00AAA9F4 | 2B05 50DCC100            | sub eax,dword ptr ds:[C1DC50]                                      | 2B05 ???????? 58
00AAA9FA | 58                       | pop eax                                                            |
00AAA9FB | 68 FC030000              | push 3FC                                                           |
00AAAA00 | 90                       | nop     JNE  75 12							<----- NOP'ing here                                                           |
00AAAA01 | 90                       | nop                                                                |
00AAAA02 | 810424 B8919F00          | add dword ptr ss:[esp],pirates!.9F91B8                             |   68 ???????? 75 ?? 810424
00AAAA09 | 810424 C3140B00          | add dword ptr ss:[esp],B14C3                                       |
00AAAA10 | EB FA                    | jmp pirates!.AAAA0C                                                | EB FA C50D
00AAAA12 | C50D 83EC20C7            | lds ecx,fword ptr ds:[C720EC83]                                    |
00AAAA18 | 44                       | inc esp                                                            |
00AAAA19 | 24 1C                    | and al,1C                                                          |
00AAAA1B | 7C 08                    | jl pirates!.AAAA25                                                 |

seeing as B2BBA8 is important this is weird is in a location below what is the cms_t section
00A7FCE5 | EB FA                    | jmp pirates!.A7FCE1                                                |
00A7FCE7 | E2 8B                    | loop pirates!.A7FC74                                               |
00A7FCE9 | 15 A8BBB200              | adc eax,pirates!.B2BBA8                                            |

Pirates: interesting:
00ADF85F | 3D CDAB3412              | cmp eax,1234ABCD                                                   |
00ADF864 | 75 09                    | jne pirates!.ADF86F                                                |


005E746A | 8B55 FC                  | mov edx,dword ptr ss:[ebp-4]                                       |
005E746D | 8B82 BC070000            | mov eax,dword ptr ds:[edx+7BC]                                     |
005E7473 | 3345 F8                  | xor eax,dword ptr ss:[ebp-8]                                       |
005E7476 | 8B4D FC                  | mov ecx,dword ptr ss:[ebp-4]                                       |
005E7479 | 3381 E4070000            | xor eax,dword ptr ds:[ecx+7E4]                                     |
005E747F | 3D CDAB3412              | cmp eax,1234ABCD                                                   |   <---- exists in spellforce too
005E7484 | 75 09                    | jne ar.5E748F                                                      |
005E7486 | 8B55 F0                  | mov edx,dword ptr ss:[ebp-10]                                      | [ebp-10]:TpWorkOnBehalfSetTicket+2DE


00B2BAE8  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ  
00B2BAF8  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ  
00B2BB08  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ  
00B2BB18  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ  
00B2BB28  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ  
00B2BB38  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ  
00B2BB48  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ  
00B2BB58  FF FF FF FF FF FF FF FF 55 4B 44 5F 37 30 31 31  ÿÿÿÿÿÿÿÿUKD_7011  
00B2BB68  30 30 2E 30 30 31 00 00 00 00 00 00 00 00 00 00  00.001..........  
00B2BB78  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................  
00B2BB88  0E D1 28 71 19 48 33 3A 3E 00 00 00 22 14 00 00  .Ñ(q.H3:>..."...  
00B2BB98  B7 72 31 54 36 5D 73 C0 9F 00 00 00 00 00 00 00  ·r1T6]sÀ........  
00B2BBA8  D9 56 19 04 00 00 00 00 00 00 00 00 00 00 00 00  ÙV..............     <----- here  - block starts at B2B0000 
00B2BBB8  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................  
00B2BBC8  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................  
00B2BBD8  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................  
00B2BBE8  0E 00 00 00 BC 4F 10 05 7A D4 C4 ED A5 00 00 00  ....¼O..zÔÄí¥...  
00B2BBF8  39 1B 13 15 11 16 52 21 00 00 00 00 00 00 00 00  9.....R!........  
00B2BC08  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................  
00B2BC18  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................  


00627AF0  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ  
00627B00  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ  
00627B10  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ  
00627B20  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ  
00627B30  55 4B 44 5F 35 34 38 35 32 30 2D 30 30 31 2E 30  UKD_548520-001.0  
00627B40  30 31 00 00 00 00 00 00 00 00 00 00 00 00 00 00  01..............  
00627B50  00 00 00 00 00 00 00 00 79 17 C2 60 F2 4F A0 E2  ........y.Â`òO â  
00627B60  2D 00 00 00 93 13 00 00 4F 6D D3 0C 11 26 EC 35  -.......OmÓ..&ì5  
00627B70  7E 00 00 00 00 00 00 00 46 3B BB 0E 00 00 00 00  ~.......F;».....      <---- could 46 3B BB 0E be our key? hardware memory access
^ in spell force
627000 is the start B78

Spellforce CD Check 1 - definitely
005B735A | 8B15 787B6200            | mov edx,dword ptr ds:[627B78]                                      | 8B?? ???????? 83EC 04 89??24 8B?? 2B?? ????????
005B7360 | 83EC 04                  | sub esp,4                                                          |
005B7363 | 893C24                   | mov dword ptr ss:[esp],edi                         89??248B??2B                |
005B7366 | 8BFA                     | mov edi,edx                                                        |
005B7368 | 2B3D 706A7000            | sub edi,dword ptr ds:[706A70]                                      | 00706A70:"&FYF"
005B736E | 5F                       | pop edi                                                            |
005B736F | 9C                       | pushfd                                            |
005B7370 | 83EC 20                  | sub esp,20                                        |
...
005B73CF | 83C4 1C                  | add esp,1C                                                         |
005B73D2 | 9D                       | popfd                                                              |
005B73D3 | 75 10                    | jne ar.5B73E5                                                      |
005B73D5 | 810424 DB5B5700          | add dword ptr ss:[esp],<ar.sub_575BDB>                             | [esp]:EndDialog+439
005B73DC | 810424 C3E50300          | add dword ptr ss:[esp],3E5C3                                       | [esp]:EndDialog+439
005B73E3 | EB FA                    | jmp ar.5B73DF                                                      |
005B73E5 | 83EC 24                  | sub esp,24                                                         |
005B73E8 | C74424 20 0A0D0000       | mov dword ptr ss:[esp+20],D0A                                      |
005B73F0 | C74424 1C 3E000100       | mov dword ptr ss:[esp+1C],1003E                                    |
005B73F8 | 894424 18                | mov dword ptr ss:[esp+18],eax                                      |

Pirates:
00AAA9E7 | A1 A8BBB200              | mov eax,dword ptr ds:[B2BBA8]                                      |  A1 ???????? 83EC 04 890424 8BC0 2B05 ???????? 58 uses EAX
00AAA9EC | 83EC 04                  | sub esp,4                                                          |
00AAA9EF | 890424                   | mov dword ptr ss:[esp],eax                                         |
00AAA9F2 | 8BC0                     | mov eax,eax                                                        | 83EC 04 890424 8BC0 
00AAA9F4 | 2B05 50DCC100            | sub eax,dword ptr ds:[C1DC50]                                      | 2B05 ???????? 58
00AAA9FA | 58                       | pop eax                                                            |

Spellforce The Breath Of Winter - Possible CD Check 1:
0045A13C | 8B0D A85B6400            | mov ecx,dword ptr ds:[645BA8]                     |
0045A142 | 83EC 04                  | sub esp,4                                         |
0045A145 | 893424                   | mov dword ptr ss:[esp],esi                        | [esp]:TpCallbackIndependent+478
0045A148 | 8BF1                     | mov esi,ecx                                       |
0045A14A | 2B35 50CF7300            | sub esi,dword ptr ds:[73CF50]                     | 0073CF50:"&FYF"
0045A150 | 5E                       | pop esi                                           |
0045A151 | 68 DC260000              | push 26DC                                         |
0045A156 | 75 11                    | jne ar3.45A169                                    |


Pirates's CD Check 2 +7C0:
009FFC98         | 8B45 F4                               | mov eax,dword ptr ss:[ebp-C]                     | eax:TpCallbackIndependent+140, [ebp-0C]:wcstombs+70
009FFC9B         | 8B88 C0070000                         | mov ecx,dword ptr ds:[eax+7C0]                   | eax+7C0:TpCallbackIndependent+900
009FFCA1         | 83E1 01                               | and ecx,1                                        |
009FFCA4         | 83EC 04                               | sub esp,4                                        |
009FFCA7         | 892C24                                | mov dword ptr ss:[esp],ebp                       | [esp]:TpCallbackIndependent+478


Spellforce CD Check 2:
00511E25 | FA                       | cli                                                                |
00511E26 | 7E 8B                    | jle ar.511DB3                                                      |
00511E28 | 45                       | inc ebp                                                            |
00511E29 | F8                       | clc                                                                |
00511E2A | 8B88 C0070000            | mov ecx,dword ptr ds:[eax+7C0]                                     |   Found by searching for: C0070000
00511E30 | 83E1 01                  | and ecx,1                                                          |
00511E33 | 83EC 04                  | sub esp,4                                                          |
00511E36 | 893424                   | mov dword ptr ss:[esp],esi                                         |
00511E39 | 8BF1                     | mov esi,ecx                                                        |
00511E3B | 23F1                     | and esi,ecx                                                        |
^ Hopefully taken care of by the PVD we send back (i.e. 0000 rather than 0809 etc)

Pirates CD Check 3:
00A527EE                                  | 890424                                | mov dword ptr ss:[esp],eax                       |
00A527F1                                  | A1 54DCC100                           | mov eax,dword ptr ds:[C1DC54]                    |
00A527F6                                  | 2BC1                                  | sub eax,ecx                                      |
00A527F8                                  | 58                                    | pop eax                                          |
00A527F9                                  | 68 5E360000                           | push 365E                                        |
00A527FE                                  | 74 10                                 | je pirates!.A52810                               |
00A52800                                  | 810424 4FF8A200                       | add dword ptr ss:[esp],pirates!.A2F84F           |
A1 ???????? 2BC1 58 68 ???????? 74
^ 1 instance of it
00A527FE - 00A527EE = 10

^Looks like it was looking for 4 bytes after our own 4 bytes signature - a HW breakpoint brought us to:

CD Check 3:
00560411 | 810424 C3840700          | add dword ptr ss:[esp],784C3                                       |
00560418 | EB FA                    | jmp ar.560414                                                      |
0056041A | 24 25                    | and al,25                                                          |
0056041C | 8B15 98437000            | mov edx,dword ptr ds:[704398]                                      |
00560422 | 8915 746A7000            | mov dword ptr ds:[706A74],edx                                      |
00560428 | E8 0A000000              | call ar.560437                                                     |
0056042D | 9F                       | lahf                                                               |
0056042E | 5B                       | pop ebx                                                            |
0056042F | AF                       | scasd                                                              |
and then to:
00560BB9 | 83EC 04                  | sub esp,4                                                          | Pirates used EAX and therefore A1
00560BBC | 891424                   | mov dword ptr ss:[esp],edx                                         | 89??248B??????????2B????68????????74 <--- only 2 found  (non-eax)
00560BBF | 8B15 746A7000            | mov edx,dword ptr ds:[706A74]                                      | 89??24A1????????2B????68????????74 <----- to test on Pirates (eax)
00560BC5 | 2BD1                     | sub edx,ecx                                                        |
00560BC7 | 5A                       | pop edx                                                            |
00560BC8 | 68 0B150000              | push 150B                                                          |
00560BCD | 74 11                    | je ar.560BE0                                                       |
00560BCF | 810424 74404B00          | add dword ptr ss:[esp],ar.4B4074                                   |
00560BD6 | 810424 C3B60A00          | add dword ptr ss:[esp],AB6C3                                       |
00560BDD | EB FA                    | jmp ar.560BD9                                                      |
Spellforce CD Check 3?


CD Check 4:
00565390 | 8B3495 787B6200          | mov esi,dword ptr ds:[edx*4+627B78]                                |
00565397 | 83EE 00                  | sub esi,0                                                          |
0056539A | 5E                       | pop esi                                                            |
0056539B | 68 67040000              | push 467                                                           |
005653A0 | 75 10                    | jne ar.5653B2                                                      |
^ Interesting at least - found by searching for 8B3495
Maybe not it - however in Pirates! you get a lot of using this memory address:
00AAA4F4         | C705 60F8C100 15000000                | mov dword ptr ds:[C1F860],15                     |   <---- hits this one a retry
C705 ???????? 15000000   <---- searching for this gets lots of hits but only one memory address - this address is near the CD Check 4 #
In Pirates that memory address is:
004599DE | C705 40237000 15000000               | mov dword ptr ds:[702340],15                                       |
411 references to that address though

Actually - the register*4+address - address should be the equivalent of B2BBA8 
ours is 627B78 - so above could be correct. But searching for that address fully gives:

005657BC | 2B0C85 787B6200                      | sub ecx,dword ptr ds:[eax*4+627B78]                                |
005657C3 | 59                                   | pop ecx                                                            |
005657C4 | 68 A7380000                          | push 38A7                                                          |
005657C9 | 75 12                                | jne ar.5657DD                                                      |

005658F2 | 2B1C85 787B6200                      | sub ebx,dword ptr ds:[eax*4+627B78]                                |
005658F9 | 5B                                   | pop ebx                                                            |
005658FA | 68 3F1B0000                          | push 1B3F                                                          |

00565FED | 8B15 40237000                        | mov edx,dword ptr ds:[702340]                                      |
00565FF3 | 030C95 787B6200                      | add ecx,dword ptr ds:[edx*4+627B78]                                |
00565FFA | A1 74687000                          | mov eax,dword ptr ds:[706874]                                      |
00565FFF | 8908                                 | mov dword ptr ds:[eax],ecx                                         |
00566001 | 83EC 04                              | sub esp,4                                                          |

0056605C | 030C95 787B6200                      | add ecx,dword ptr ds:[edx*4+627B78]                                |
00566063 | A1 74687000                          | mov eax,dword ptr ds:[706874]                                      |
00566068 | 8908                                 | mov dword ptr ds:[eax],ecx                                         |
0056606A | 83EC 04                              | sub esp,4                                                          |

005900C5 | 828B 15787B62 00                     | or byte ptr ds:[ebx+627B7815],0                                    |
005900CC | 83EC 04                              | sub esp,4                                                          |
005900CF | 893C24                               | mov dword ptr ss:[esp],edi                                         | [esp]:TpCallbackIndependent+478

0059494D | A1 787B6200                          | mov eax,dword ptr ds:[627B78]    <--- not called first at least                                  |
00594952 | 83EC 04                              | sub esp,4                                                          |
00594955 | 891C24                               | mov dword ptr ss:[esp],ebx                                         | [esp]:TpCallbackIndependent+478
00594958 | 8BD8                                 | mov ebx,eax                                                        |
0059495A | 2B1D 706A7000                        | sub ebx,dword ptr ds:[706A70]                                      |
00594960 | 5B                                   | pop ebx                                                            |
00594961 | 9C                                   | pushfd                                                             |
^ Same as CD Check 1?

Looks familiar
00594BF1 | 83EC 04                              | sub esp,4                                                          |
00594BF4 | 890C24                               | mov dword ptr ss:[esp],ecx                                         | [esp]:TpCallbackIndependent+478
00594BF7 | 8B15 706A7000                        | mov edx,dword ptr ds:[706A70]                                      |
00594BFD | 83EC 04                              | sub esp,4                                                          |
00594C00 | 891424                               | mov dword ptr ss:[esp],edx                                         | [esp]:TpCallbackIndependent+478
00594C03 | A1 787B6200                          | mov eax,dword ptr ds:[627B78]                                      |
00594C08 | 83EC 04                              | sub esp,4                                                          |
00594C0B | 890424                               | mov dword ptr ss:[esp],eax                                         | [esp]:TpCallbackIndependent+478
00594C0E | 8B0D 787B6200                        | mov ecx,dword ptr ds:[627B78]                                      |
00594C14 | 83EC 04                              | sub esp,4                                                          |
00594C17 | 890C24                               | mov dword ptr ss:[esp],ecx                                         | [esp]:TpCallbackIndependent+478
00594C1A | 8B15 D00F7000                        | mov edx,dword ptr ds:[700FD0]                                      |
00594C20 | 83EC 04                              | sub esp,4                                                          |
00594C23 | 891424                               | mov dword ptr ss:[esp],edx                                         | [esp]:TpCallbackIndependent+478
00594C26 | A1 B8167000                          | mov eax,dword ptr ds:[7016B8]                                      |
00594C2B | 83EC 04                              | sub esp,4                                                          |
00594C2E | 890424                               | mov dword ptr ss:[esp],eax                                         | [esp]:TpCallbackIndependent+478
00594C31 | 8B0D 40237000                        | mov ecx,dword ptr ds:[702340]                                      |
00594C37 | 83EC 04                              | sub esp,4                                                          |
00594C3A | 890C24                               | mov dword ptr ss:[esp],ecx                                         | [esp]:TpCallbackIndependent+478
00594C3D | 68 68816E00                          | push ar.6E8168                                                     | 6E8168:"7001CB7B9AC47F97C366B5BAA2E5330B7AC62771EF50220B19CC181B94CEC49A83DE{%d}25E322CB0C50FD7D{%d}ABC7E18173CA0DC7{%d}3125734CE87B01C1741F121E3073214A3F905810B194FAEA3B0078723DAD2DFF{%lu}900866012CED3BBD{%08x}963C7619B036D649E989785690AA3D7F1452D62E99B8A30F5FA9E4794B68479A{%lu}900866012CED3BBD{%08x}5185EEF873391C9B014D20FAFBE913D0EB4C80ADE9F1F3B1A1D837D692A74D0F"
00594C42 | 68 20F56F00                          | push ar.6FF520                                                     |
00594C47 | E8 07000000                          | call ar.594C53                                                     |
00594C4C | 66:B0 8B                             | mov al,8B                                                          |
00594C4F | 61                                   | popad                                                              |
00594C50 | 0027                                 | add byte ptr ds:[edi],ah                                           |
00594C52 | 2181 04247F00                        | and dword ptr ds:[ecx+7F2404],eax                                  |
00594C58 | 0000                                 | add byte ptr ds:[eax],al                                           |
00594C5A | FF3424                               | push dword ptr ss:[esp]                                            | [esp]:TpCallbackIndependent+478
00594C5D | 812C24 7E000000                      | sub dword ptr ss:[esp],7E                                          | [esp]:TpCallbackIndependent+478
00594C64 | FF3424                               | push dword ptr ss:[esp]                                            | [esp]:TpCallbackIndependent+478
00594C67 | 872C24                               | xchg dword ptr ss:[esp],ebp                                        | [esp]:TpCallbackIndependent+478
00594C6A | 8B6D 00                              | mov ebp,dword ptr ss:[ebp]                                         |
00594C6D | 83EC 18                              | sub esp,18                                                         |
00594C70 | C74424 14 E9E321BA                   | mov dword ptr ss:[esp+14],BA21E3E9                                 |
00594C78 | C74424 10 42000200                   | mov dword ptr ss:[esp+10],20042                                    | 20042:"?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????!\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????"
00594C80 | 894424 0C                            | mov dword ptr ss:[esp+C],eax                                       |
00594C84 | B8 204C5900                          | mov eax,ar.594C20                                                  |
00594C89 | 894C24 08                            | mov dword ptr ss:[esp+8],ecx                                       |
00594C8D | 894424 14                            | mov dword ptr ss:[esp+14],eax                                      |
00594C91 | 33C0                                 | xor eax,eax                                                        |
00594C93 | 8B4C24 14                            | mov ecx,dword ptr ss:[esp+14]                                      |
00594C97 | 8B09                                 | mov ecx,dword ptr ds:[ecx]                                         |
00594C99 | 33C1                                 | xor eax,ecx                                                        |
00594C9B | 834424 14 04                         | add dword ptr ss:[esp+14],4                                        |
00594CA0 | B8 D0210000                          | mov eax,21D0                                                       |
00594CA5 | 90                                   | nop                                                                |
00594CA6 | 90                                   | nop                                                                |
00594CA7 | 3D D0210000                          | cmp eax,21D0                                                       |
00594CAC | 74 01                                | je ar.594CAF                                                       |
00594CAE | CC                                   | int3                                                               |
00594CAF | 8B4C24 08                            | mov ecx,dword ptr ss:[esp+8]                                       |

005AEB2D | 8B0D 787B6200                        | mov ecx,dword ptr ds:[627B78]                                      |
005AEB33 | 83EC 04                              | sub esp,4                                                          |
005AEB36 | 891424                               | mov dword ptr ss:[esp],edx                                         | [esp]:TpCallbackIndependent+478
005AEB39 | 8BD1                                 | mov edx,ecx                                                        |
005AEB3B | 2B15 706A7000                        | sub edx,dword ptr ds:[706A70]                                      |
005AEB41 | 5A                                   | pop edx                                                            |
005AEB42 | 68 463C0000                          | push 3C46                                                          |
005AEB47 | 75 11                                | jne ar.5AEB5A                                                      |

005B735A | 8B15 787B6200                        | mov edx,dword ptr ds:[627B78]                                      |   00627B78  46 3B BB 0E 00 00 00 00 00 00 00 00 00 00 00 00  F;».............  
005B7360 | 83EC 04                              | sub esp,4                                                          |
005B7363 | 893C24                               | mov dword ptr ss:[esp],edi                                         | [esp]:TpCallbackIndependent+478
005B7366 | 8BFA                                 | mov edi,edx                                                        |
005B7368 | 2B3D 706A7000                        | sub edi,dword ptr ds:[706A70]                                      |   00706A70  26 46 59 46 00 00 00 00 00 00 00 00 00 00 00 00  &FYF............  
005B736E | 5F                                   | pop edi                                                            |  
005B736F | 9C                                   | pushfd                                                             |

------------------
First place 627B78 is used is here:
005B735A | 8B15 787B6200                        | mov edx,dword ptr ds:[627B78]                                      |   00627B78  46 3B BB 0E 00 00 00 00 00 00 00 00 00 00 00 00  F;».............  
005B7360 | 83EC 04                              | sub esp,4                                                          |
005B7363 | 893C24                               | mov dword ptr ss:[esp],edi                                         |
005B7366 | 8BFA                                 | mov edi,edx                                                        |
005B7368 | 2B3D 706A7000                        | sub edi,dword ptr ds:[706A70]                                      | 00706A70:"&FYF"   00706A70  26 46 59 46 00 00 00 00 00 00 00 00 00 00 00 00  &FYF............  

Later has:
00706A70  26 46 59 46 F0 7E 14 00 00 00 00 00 00 00 00 00  &FYFð~..........  
added here:
0056041C | 8B15 98437000                        | mov edx,dword ptr ds:[704398]                                      |
00560422 | 8915 746A7000                        | mov dword ptr ds:[706A74],edx                                      |
00560428 | E8 0A000000                          | call ar.560437                                                     |

Then goes here:
00560BBC | 891424                               | mov dword ptr ss:[esp],edx                                         |
00560BBF | 8B15 746A7000                        | mov edx,dword ptr ds:[706A74]                                      |
00560BC5 | 2BD1                                 | sub edx,ecx                                                        |
00560BC7 | 5A                                   | pop edx                                                            |
00560BC8 | 68 0B150000                          | push 150B                                                          |
00560BCD | 74 11                                | je ar.560BE0       <--- force?     yes                                           |

Next time after is here:
0056110E | 8B15 746A7000                        | mov edx,dword ptr ds:[706A74]                                      |
00561114 | 83EC 04                              | sub esp,4                                                          |
00561117 | 891424                               | mov dword ptr ss:[esp],edx                                         |
0056111A | BA 9508D1E2                          | mov edx,E2D10895                                                   |
0056111F | 73 FC                                | jae ar.56111D                                                      |

Then hits:
CD Check4:
---------
005652DE | 891424                               | mov dword ptr ss:[esp],edx                                         |
005652E1 | 8B1495 787B6200                      | mov edx,dword ptr ds:[edx*4+627B78]                                |
005652E8 | 83EA 00                              | sub edx,0                                                          |
005652EB | 5A                                   | pop edx                                                            |
005652EC | 68 21100000                          | push 1021                                                          |
005652F1 | 75 12                                | jne ar.565305                          <--- nop?                            |

Pirates CD Check 4
00A57248 | 83EC 04                  	  | sub esp,4                                                          |
00A5724B | 893C24                  		  | mov dword ptr ss:[esp],edi                                         |
00A5724E | 8BF9              	          | mov edi,ecx                                                        |
00A57250 | 2B3C85 A8BBB200                | sub edi,dword ptr ds:[eax*4+B2BBA8]              |   <--- make cmp al,al
00A57257 | 5F                             | pop edi                                          |

CD Check 4 - Alternative?
-----
005657A7 | 8B15 78687000            | mov edx,dword ptr ds:[706878]                     |
005657AD | A1 40237000              | mov eax,dword ptr ds:[702340]                     |
005657B2 | 8B0A                     | mov ecx,dword ptr ds:[edx]                        |
005657B4 | 83EC 04                  | sub esp,4                                         |
005657B7 | 890C24                   | mov dword ptr ss:[esp],ecx                        |
005657BA | 8BC9                     | mov ecx,ecx                                       |
005657BC | 2B0C85 787B6200          | sub ecx,dword ptr ds:[eax*4+627B78]               |
005657C3 | 59                       | pop ecx                                           |
005657C4 | 68 A7380000              | push 38A7                                         |
005657C9 | 75 12                    | jne <ar.sub_5657DD>                               |
^ probably better to match to
83EC 04 89??24 8B?? 2B??85
005657BC - 005657B4 = 8

Then hits:
00566056 | 8B15 40237000                        | mov edx,dword ptr ds:[702340]                                      |
0056605C | 030C95 787B6200                      | add ecx,dword ptr ds:[edx*4+627B78]                                |
00566063 | A1 74687000                          | mov eax,dword ptr ds:[706874]                                      |
00566068 | 8908                                 | mov dword ptr ds:[eax],ecx                                         |
0056606A | 83EC 04                              | sub esp,4                                                          |

fstp hits from 032424DD1D
0052D451 | 032424                               | add esp,dword ptr ss:[esp]                                         |
0052D454 | DD1D D8E86F00                        | fstp qword ptr ds:[6FE8D8]              <---- hits this                           |
0052D45A | E9 16000000                          | jmp ar.52D475                                                      |

0052E230 | 032424                               | add esp,dword ptr ss:[esp]                                         |
0052E233 | DD1D D8E86F00                        | fstp qword ptr ds:[6FE8D8]                                         |
0052E239 | 68 69070000                          | push 769                                                           |

Please start the original game executable comes up :)


So:
(Check2 not required)
CD Check1:
005B73D3 | 75 10                    | jne ar.5B73E5    <---- NOP
CD Check3:
00560BCD | 74 11                    | je ar.560BE0    <---- FORCE
CD Check4:
005652F1 | 75 12                    | jne ar.565305    <---- NOP
Geometry:
0052D454 | DD1D D8E86F00            | fstp qword ptr ds:[6FE8D8]   <----- NOP

Spellforce - stick a tab at the end of the commandline to make it run straight away without reloading itself?

Separately - Fairlight crack looks a lot like - attacks Spellforce.exe rather than ar.exe (Securom):
05001000 | 0D 0A47694D              | or eax,4D69470A                                                    |
05001005 | 50                       | push eax                                                           |
05001006 | 53                       | push ebx                                                           |
05001007 | 52                       | push edx                                                           |
05001008 | 75 53                    | jne wsock32.500105D                                                |
0500100A | 2121                     | and dword ptr ds:[ecx],esp                                         | ecx:CreateHeatGripServiceClient+3220
0500100C | 0D 0A0D0A45              | or eax,450A0D0A                                                    |
05001011 | 56                       | push esi                                                           |
05001012 | 5F                       | pop edi                                                            | edi:LdrHotPatchNotify+2610
05001013 | 36363636:0055 8B         | add byte ptr ss:[ebp-75],dl                                        |
0500101A | EC                       | in al,dx                                                           |
0500101B | 837D 0C 01               | cmp dword ptr ss:[ebp+C],1                                         |
0500101F | 0F85 A4000000            | jne wsock32.50010C9                                                |
05001025 | 56                       | push esi                                                           |
05001026 | 57                       | push edi                                                           | edi:LdrHotPatchNotify+2610
05001027 | 53                       | push ebx                                                           |
05001028 | BE 08400005              | mov esi,<wsock32.&accept>                                          |
0500102D | 68 2C010000              | push 12C                                                           |
05001032 | 56                       | push esi                                                           |
05001033 | E8 12070000              | call <JMP.&GetSystemDirectoryA>                                    |
05001038 | C70430 5C77736F          | mov dword ptr ds:[eax+esi],6F73775C                                |
0500103F | C74430 04 636B3332       | mov dword ptr ds:[eax+esi+4],32336B63                              | [eax+esi*1+04]:LdrHotPatchNotify+2610
05001047 | C74430 08 2E646C6C       | mov dword ptr ds:[eax+esi+8],6C6C642E                              |
0500104F | 56                       | push esi                                                           |
05001050 | E8 FB060000              | call <JMP.&LoadLibraryA>                                           |
05001055 | 83F8 00                  | cmp eax,0                                                          |
05001058 | 75 0A                    | jne wsock32.5001064                                                |
0500105A | 68 DEC0ADDE              | push DEADC0DE                                                      |
0500105F | E8 CE060000              | call <JMP.&ExitProcess>                                            |
05001064 | A3 00400005              | mov dword ptr ds:[5004000],eax      <---- saves actual msock address                               |
05001069 | BF 56130005              | mov edi,wsock32.5001356      <---- "accept"                                      | edi:LdrHotPatchNotify+2610, 5001356:"accept"
0500106E | BE 08400005              | mov esi,<wsock32.&accept>    <                                      |
05001073 | 803F 00                  | cmp byte ptr ds:[edi],0                                            | edi:LdrHotPatchNotify+2610
05001076 | 74 1C                    | je wsock32.5001094           <---- doesn't jmp                                       |
05001078 | 57                       | push edi                     <---- accept                                      | edi:LdrHotPatchNotify+2610
05001079 | FF35 00400005            | push dword ptr ds:[5004000]  <---- from real msock                                      |
0500107F | E8 C0060000              | call <JMP.&GetProcAddress>   <                                      |
05001084 | 8906                     | mov dword ptr ds:[esi],eax   <---- 05004008 is where we originally had the full path- so resuing                                      |
05001086 | 83C6 04                  | add esi,4                                                          |
05001089 | 57                       | push edi               <--- accept                                               | edi:LdrHotPatchNotify+2610
0500108A | E8 C7060000              | call <JMP.&lstrlenA>                                               |
0500108F | 40                       | inc eax                 eax == 7                                           |
05001090 | 03F8                     | add edi,eax                                                        | edi:LdrHotPatchNotify+2610
05001092 | EB DF                    | jmp wsock32.5001073     <--- loops getting all the function names?                                          |
05001094 | 6A 00                    | push 0                                                             |
05001096 | E8 A3060000              | call <JMP.&GetModuleHandleA>    <---- get 00400000                                   |
0500109B | 8BF0                     | mov esi,eax                                                        |
0500109D | 8935 04400005            | mov dword ptr ds:[5004004],esi                                     |
050010A3 | C686 5FCD0000 E9         | mov byte ptr ds:[esi+CD5F],E9                                      |
050010AA | BB 10110005              | mov ebx,wsock32.5001110                                            |
050010AF | 81EB 64CD4000            | sub ebx,spellforce.40CD64                                          |
050010B5 | 899E 60CD0000            | mov dword ptr ds:[esi+CD60],ebx                                    |
050010BB | 5B                       | pop ebx                                                            |
050010BC | 5F                       | pop edi                                                            | edi:LdrHotPatchNotify+2610
050010BD | 5E                       | pop esi                                                            |
050010BE | B8 01000000              | mov eax,1                                                          |
050010C3 | C9                       | leave                                                              |
050010C4 | C2 0C00                  | ret C                                                              |
050010C7 | EB 3E                    | jmp wsock32.5001107                                                |
050010C9 | 837D 0C 00               | cmp dword ptr ss:[ebp+C],0                                         |
050010CD | 75 18                    | jne wsock32.50010E7                                                |
050010CF | 53                       | push ebx                                                           |
050010D0 | FF35 00400005            | push dword ptr ds:[5004000]                                        |
050010D6 | E8 5D060000              | call <JMP.&FreeLibrary>                                            |
050010DB | 5B                       | pop ebx                                                            |
050010DC | B8 01000000              | mov eax,1                                                          |
050010E1 | C9                       | leave                                                              |
050010E2 | C2 0C00                  | ret C                                                              |
050010E5 | EB 20                    | jmp wsock32.5001107                                                |
050010E7 | 837D 0C 02               | cmp dword ptr ss:[ebp+C],2                                         |
050010EB | 75 0B                    | jne wsock32.50010F8                                                |
050010ED | B8 01000000              | mov eax,1                                                          |
050010F2 | C9                       | leave                                                              |
050010F3 | C2 0C00                  | ret C                                                              |
050010F6 | EB 0F                    | jmp wsock32.5001107                                                |
050010F8 | 837D 0C 03               | cmp dword ptr ss:[ebp+C],3                                         |
050010FC | 75 09                    | jne wsock32.5001107                                                |
050010FE | B8 01000000              | mov eax,1                                                          |
05001103 | C9                       | leave                                                              |
05001104 | C2 0C00                  | ret C                                                              |
05001107 | B8 01000000              | mov eax,1                                                          |
0500110C | C9                       | leave                                                              |
0500110D | C2 0C00                  | ret C                                                              |
05001110 | 301431                   | xor byte ptr ds:[ecx+esi],dl                                       |
05001113 | 49                       | dec ecx                                                            | ecx:CreateHeatGripServiceClient+3220
05001114 | 79 02                    | jns wsock32.5001118                                                |
05001116 | EB 06                    | jmp wsock32.500111E                                                |
05001118 | 68 52CD4000              | push spellforce.40CD52                                             |
0500111D | C3                       | ret                                                                |
0500111E | A1 04400005              | mov eax,dword ptr ds:[5004004]                                     |
05001123 | C680 72D20000 EB         | mov byte ptr ds:[eax+D272],EB                                      |
0500112A | C680 62D30000 EB         | mov byte ptr ds:[eax+D362],EB                                      |
05001131 | C680 0FD40000 EB         | mov byte ptr ds:[eax+D40F],EB                                      |
05001138 | C780 B0E30000 33C040C3   | mov dword ptr ds:[eax+E3B0],C340C033                               |
05001142 | C680 2CD60000 EB         | mov byte ptr ds:[eax+D62C],EB                                      |
05001149 | C680 B4CD0000 EB         | mov byte ptr ds:[eax+CDB4],EB                                      |
05001150 | C780 60140000 33C040C2   | mov dword ptr ds:[eax+1460],C240C033                               |
0500115A | 66:C780 64140000 0400    | mov word ptr ds:[eax+1464],4                                       |
05001163 | C680 04D30000 E9         | mov byte ptr ds:[eax+D304],E9                                      |
0500116A | C780 05D30000 AA000000   | mov dword ptr ds:[eax+D305],AA                                     |
05001174 | 66:C780 21CF0000 90E9    | mov word ptr ds:[eax+CF21],E990                                    |
0500117D | 68 10100005              | push wsock32.5001010                                               | 5001010:"EV_6666"
05001182 | 6A 01                    | push 1                                                             |
05001184 | 6A 01                    | push 1                                                             |
05001186 | 6A 00                    | push 0                                                             |
05001188 | E8 9F050000              | call <JMP.&CreateEventA>                                           |
0500118D | 68 65CD4000              | push spellforce.40CD65                                             |
05001192 | C3                       | ret                                                                |

Part in the code msock is changing ????
0040CD3C | 81E9 65CD4000            | sub ecx,spellforce.40CD65                                          |
0040CD42 | 49                       | dec ecx                                                            |
0040CD43 | B8 78563412              | mov eax,12345678                                                   |
0040CD48 | BB 89674523              | mov ebx,23456789                                                   |
0040CD4D | BA 90785634              | mov edx,34567890                                                   |
0040CD52 | 90                       | nop                                                                |
0040CD53 | 30040E                   | xor byte ptr ds:[esi+ecx],al                                       |
0040CD56 | 90                       | nop                                                                |
0040CD57 | 301C0E                   | xor byte ptr ds:[esi+ecx],bl                                       |
0040CD5A | 90                       | nop                                                                |
0040CD5B | 300C0E                   | xor byte ptr ds:[esi+ecx],cl                                       |
0040CD5E | 90                       | nop                                                                |
0040CD5F | 30140E                   | xor byte ptr ds:[esi+ecx],dl         <----- this one is being changed to a JMP

0040CD62 | 49                       | dec ecx                                                            |
0040CD63 | 79 ED                    | jns spellforce.40CD52                                              |
0040CD65 | 5A                       | pop edx                                                            |
0040CD66 | 27                       | daa                                                                |
0040CD67 | 70 FD                    | jo spellforce.40CD66                                               |
0040CD69 | 6E                       | outsb                                                              |
0040CD6A | F3:84C9                  | test cl,cl                                                         |
0040CD6D | B2 8F                    | mov dl,8F                                                          |
0040CD6F | 58                       | pop eax                                                            |
0040CD70 | 55                       | push ebp                                                           |
0040CD71 | C6                       | ???                                                                |
0040CD72 | 5B                       | pop ebx                                                            |

JMPs to this function:
05001110 | 301431                   | xor byte ptr ds:[ecx+esi],dl                                       |
05001113 | 49                       | dec ecx                                                            |
05001114 | 79 02                    | jns wsock32.5001118                                                |
05001116 | EB 06                    | jmp wsock32.500111E                                                |
05001118 | 68 52CD4000              | push spellforce.40CD52                                             |
0500111D | C3                       | ret                                                                |
0500111E | A1 04400005              | mov eax,dword ptr ds:[5004004]                                     |
05001123 | C680 72D20000 EB         | mov byte ptr ds:[eax+D272],EB                                      |  400000 + D272 = 40D272
0500112A | C680 62D30000 EB         | mov byte ptr ds:[eax+D362],EB                                      |
05001131 | C680 0FD40000 EB         | mov byte ptr ds:[eax+D40F],EB                                      |
05001138 | C780 B0E30000 33C040C3   | mov dword ptr ds:[eax+E3B0],C340C033                               |
05001142 | C680 2CD60000 EB         | mov byte ptr ds:[eax+D62C],EB                                      |
05001149 | C680 B4CD0000 EB         | mov byte ptr ds:[eax+CDB4],EB                                      |
05001150 | C780 60140000 33C040C2   | mov dword ptr ds:[eax+1460],C240C033                               |
0500115A | 66:C780 64140000 0400    | mov word ptr ds:[eax+1464],4                                       |
05001163 | C680 04D30000 E9         | mov byte ptr ds:[eax+D304],E9                                      |
0500116A | C780 05D30000 AA000000   | mov dword ptr ds:[eax+D305],AA                                     |
05001174 | 66:C780 21CF0000 90E9    | mov word ptr ds:[eax+CF21],E990                                    |
0500117D | 68 10100005              | push <wsock32.sub_5001010>                                         | 5001010:"EV_6666"
05001182 | 6A 01                    | push 1                                                             |
05001184 | 6A 01                    | push 1                                                             |
05001186 | 6A 00                    | push 0                                                             |
05001188 | E8 9F050000              | call <JMP.&CreateEventA>                                           |
0500118D | 68 65CD4000              | push spellforce.40CD65                                             |
05001192 | C3                       | ret                                                                |

Changes it's making:
0040D272 | 74 2A                    | je spellforce.40D29E                              |
0040D362 | 74 2A                    | je spellforce.40D38E                              |
0040D40F | 74 26                    | je spellforce.40D437                              |
0040E3B0 | 68 6026CE00              | push spellforce.CE2660                            |   <---- changing where it stores the threadID? (last param to CreateThread)
0040D62C | 74 0F                    | je spellforce.40D63D                              |  // more checking of the OpenEvent
0040CDB4 | 74 02                    | je spellforce.40CDB8                              |  // Could be a check of keys? uninstall at least:  00C7D028  SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\SpellForce\LocalStrings  .Script\ConUserInit.lua..Script\ConSystemInit.lua....  
00401460 | 6A FF                    | push FFFFFFFF                                     |
00401462 | 68 F893B300              | push spellforce.B393F8                            |
0040D304 | 8D4D D0                  | lea ecx,dword ptr ss:[ebp-30]                     | next to createevent
0040CF21 | 0F85 36010000            | jne spellforce.40D05D                             | next to a regclosekey and over a GetLogicalDriveStrings

CD KEY Blacklist?
00401486 | C74424 18 CCB4C700       | mov dword ptr ss:[esp+18],spellforce.C7B4CC       | C7B4CC:"08AFX-CGGML-W260D-5RRPO-CVNFD"
0040148E | C74424 1C ACB4C700       | mov dword ptr ss:[esp+1C],spellforce.C7B4AC       | C7B4AC:"0MBZT-0A9PE-7P7AH-MM6KG-MYMSE"
00401496 | C74424 20 8CB4C700       | mov dword ptr ss:[esp+20],spellforce.C7B48C       | [esp+20]:RtlCaptureStackBackTrace+41, C7B48C:"2LWN6-7GKU7-FQZAI-B5Z1C-88PZ9"
0040149E | C74424 24 6CB4C700       | mov dword ptr ss:[esp+24],spellforce.C7B46C       | C7B46C:"3E94L-RWWP2-OUMPX-ORW88-FH3E6"
004014A6 | C74424 28 4CB4C700       | mov dword ptr ss:[esp+28],spellforce.C7B44C       | C7B44C:"3MNQM-DLFDZ-3BPIP-9PTCO-2CVKM"
004014AE | C74424 2C 2CB4C700       | mov dword ptr ss:[esp+2C],spellforce.C7B42C       | C7B42C:"3NCHS-ABKA5-KH28K-D9G0W-I5RMF"
004014B6 | C74424 30 0CB4C700       | mov dword ptr ss:[esp+30],spellforce.C7B40C       | C7B40C:"4ZKR3-1TDZ1-OXVD5-90AEX-4I7SB"
004014BE | C74424 34 ECB3C700       | mov dword ptr ss:[esp+34],spellforce.C7B3EC       | C7B3EC:"55XC3-AH1ED-147JV-R4D8V-DDQYM"
004014C6 | C74424 38 CCB3C700       | mov dword ptr ss:[esp+38],spellforce.C7B3CC       | C7B3CC:"58URC-Y9ZXW-VLH20-79QTJ-FS45L"
004014CE | C74424 3C ACB3C700       | mov dword ptr ss:[esp+3C],spellforce.C7B3AC       | C7B3AC:"5NKKY-TQH73-XLWN9-VBQWG-SUVU3"
004014D6 | C74424 40 8CB3C700       | mov dword ptr ss:[esp+40],spellforce.C7B38C       | C7B38C:"5NOCI-RK7NN-QKU4I-942LZ-HUI6W"
004014DE | C74424 44 6CB3C700       | mov dword ptr ss:[esp+44],spellforce.C7B36C       | C7B36C:"5L77N-GZFJI-2RUZK-5ZM3B-ISPMQ"
004014E6 | C74424 48 4CB3C700       | mov dword ptr ss:[esp+48],spellforce.C7B34C       | C7B34C:"61KDC-6LB3Z-CFKIO-MPLZU-WMY1K"
004014EE | C74424 4C 2CB3C700       | mov dword ptr ss:[esp+4C],spellforce.C7B32C       | C7B32C:"6IP9Z-BANZ4-PXR20-92470-BRVFF"
004014F6 | C74424 50 0CB3C700       | mov dword ptr ss:[esp+50],spellforce.C7B30C       | [esp+50]:SE_GetProcAddressForCaller+2B3, C7B30C:"70CKH-UXETJ-MCNHL-HAK71-5OUGX"
004014FE | C74424 54 ECB2C700       | mov dword ptr ss:[esp+54],spellforce.C7B2EC       | [esp+54]:DWM8And16Bit_RestoreDisplayMode_CallOut+15720, C7B2EC:"75HX7-V4U9B-L1TFR-UX61D-HU117"
00401506 | C74424 58 CCB2C700       | mov dword ptr ss:[esp+58],spellforce.C7B2CC       | C7B2CC:"7DVB5-NNR5X-DATWG-3VX4I-Q74JR"
0040150E | C74424 5C ACB2C700       | mov dword ptr ss:[esp+5C],spellforce.C7B2AC       | C7B2AC:"ARCHA-NGELB-ELGIU-MPORT-IAUK0"
00401516 | C74424 60 8CB2C700       | mov dword ptr ss:[esp+60],spellforce.C7B28C       | [esp+60]:SE_GetProcAddressForCaller, C7B28C:"BYEBY-EANDS-AYHID-AVEIN-JAIL5"
^ if this function returns 1 - the key is accepted

Computer\HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\SpellForce\CDKEY

Called here:
00401318 | E8 43010000              | call <spellforce.sub_401460>                      |
in this func:
004012A0 | 6A FF                    | push FFFFFFFF                                     |

also called here:
00401427 | E8 34000000              | call <spellforce.sub_401460>                      |

This func:
00413300 | 6A FF                    | push FFFFFFFF                                     |


---------------------------------------------------------
ar.exe looks for an event called  EV_6666 - trying to decode while it still wont run unless run from Spellforce
004A3BD1 | 50                       | push eax                                          |
004A3BD2 | 6A 64                    | push 64                                           |
004A3BD4 | 897D F0                  | mov dword ptr ss:[ebp-10],edi                     |
004A3BD7 | FF15 10604000            | call dword ptr ds:[<&GetLogicalDriveStringsA>]    |
004A3BDD | 68 20104000              | push ar.401020                                    |
004A3BE2 | C3                       | ret                                               |
004A3BE3 | 61                       | popad                                             |
004A3BE4 | 83C4 0C                  | add esp,C                                         |
004A3BE7 | 68 64704000              | push ar.407064                                    | 407064:"EV_6666"
004A3BEC | 6A 01                    | push 1                                            |
004A3BEE | 68 03001F00              | push 1F0003                                       | 1F0003:"??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
004A3BF3 | FF15 18604000            | call dword ptr ds:[<&OpenEventA>]                 |
004A3BF9 | 68 4A104000              | push ar.40104A                                    |
004A3BFE | C3                       | ret                                               |
004A3BFF | 61                       | popad                                             |
004A3C00 | 68 40200000              | push 2040                                         |
004A3C05 | 68 5C704000              | push ar.40705C                                    | 40705C:"AR.exe"
004A3C0A | 68 30704000              | push ar.407030                                    | 407030:"Please start the original game executable."
004A3C0F | 57                       | push edi                                          |
004A3C10 | FF15 D0604000            | call dword ptr ds:[<&MessageBoxA>]                |
004A3C16 | 68 64104000              | push ar.401064                                    |
004A3C1B | C3                       | ret                                               |
004A3C1C | 61                       | popad                                             |

004A3C30 | 6A 28                    | push 28                                           |
004A3C32 | 8D95 64FFFFFF            | lea edx,dword ptr ss:[ebp-9C]                     |
004A3C38 | 51                       | push ecx                                          |
004A3C39 | 52                       | push edx                                          | edx:"E:\\"
004A3C3A | FF15 24604000            | call dword ptr ds:[<&GetVolumeInformationA>]      |
004A3C40 | 68 A9104000              | push ar.4010A9                                    |
004A3C45 | C3                       | ret                                               |
004A3C46 | 61                       | popad                                             |
004A3C47 | 8D4C24 10                | lea ecx,dword ptr ss:[esp+10]                     |
004A3C4B | 51                       | push ecx                                          |
004A3C4C | 68 D4704000              | push ar.4070D4                                    | 4070D4:"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\SpellForce\\LocalStrings"
004A3C51 | 68 02000080              | push 80000002                                     |
004A3C56 | FF15 04604000            | call dword ptr ds:[<&RegOpenKeyA>]                |

string compare?
004010AC | 53                       | push ebx                                          | ebx:"SF_CD1"
004010AD | 50                       | push eax                                          | eax:"SF_CD1"
004010AE | E8 AD010000              | call ar.401260                                    |
...
004010EF | FF15 FC0B6300            | call dword ptr ds:[630BFC]                        |   <--- actually calling GetDriveTypeA returns 5
...
0040160E | 8945 A0                  | mov dword ptr ss:[ebp-60],eax                     |  <---- exits after this - but equals A07 whether good or bad
...
0040133F | 393D 189A4000            | cmp dword ptr ds:[409A18],edi                     |  edi == 1 and 409a18 is 0 when good and bad
...
00401362 | 893D 149A4000            | mov dword ptr ds:[409A14],edi                     |  <--- edi == 1 when good same when bad
0040136E | 75 3C                    | jne ar.4013AC                                     |  not taken on  good and bad
00401377 | 74 22                    | je ar.40139B                                      |  is taken on  good and bad
...
00403372 | E8 4D220000              | call ar.4055C4                                    |

004013E5 | FFD0                     | call eax                                          |  <--- goes to 00403372 when good and bad

so we should both (good and bad) end up at (yep):
004013D9 | 3B7424 0C                | cmp esi,dword ptr ss:[esp+C]                      |

with good it ends up going to call eax - on bad it didn't - eax is 00403372 again

do we both end up at:
004013C0 | 75 10                    | jne ar.4013D2                                     |  ??? (not taken with and then exits!)

We exit process here
004A3CFB | 66:9C                    | pushf                                             |
004A3CFD | 334424 02                | xor eax,dword ptr ss:[esp+2]                      |
004A3D01 | 314424 02                | xor dword ptr ss:[esp+2],eax                      |
004A3D05 | 334424 02                | xor eax,dword ptr ss:[esp+2]                      |
004A3D09 | 66:9D                    | popf                                              |
004A3D0B | 58                       | pop eax                                           |
004A3D0C | FF15 28604000            | call dword ptr ds:[<&ExitProcess>]                |
^ That's what both do !?!!?! Then it's spellforce that runs the game not AR ?!

just weird


------------------------
So looking at the PVD


0061B196 | F7D9                     | neg ecx                                           |
0061B198 | 03CB                     | add ecx,ebx                                       |
0061B19A | 8BFE                     | mov edi,esi                                       | esi:"KD_548520-001.001"
0061B19C | 8B75 0C                  | mov esi,dword ptr ss:[ebp+C]                      | [ebp+0C]:"UKD_548520-001.001"
0061B19F | F3:A6                    | repe cmpsb                                        |
0061B1A1 | 8A46 FF                  | mov al,byte ptr ds:[esi-1]                        | esi-01:"UKD_548520-001.001"
0061B1A4 | 33C9                     | xor ecx,ecx                                       |
0061B1A6 | 3A47 FF                  | cmp al,byte ptr ds:[edi-1]                        |
0061B1A9 | 77 04                    | ja ar.61B1AF                                      |
0061B1AB | 74 04                    | je ar.61B1B1                                      |
0061B1AD | 49                       | dec ecx                                           |
0061B1AE | 49                       | dec ecx                                           |

this is doing a compare - UKD_ code is from the section after cms_t equivalent


005B64E0 | C70424 75020000          | mov dword ptr ss:[esp],275                        |
005B64E7 | 813424 79020000          | xor dword ptr ss:[esp],279                        |
005B64EE | 032424                   | add esp,dword ptr ss:[esp]                        |
005B64F1 | 83EC 04                  | sub esp,4                                         |
005B64F4 | 891424                   | mov dword ptr ss:[esp],edx                        |
005B64F7 | 8BD0                     | mov edx,eax                                       |
005B64F9 | 23D0                     | and edx,eax                                       |
005B64FB | 5A                       | pop edx                                           |
005B64FC | 68 CF150000              | push 15CF                                         |
005B6501 | 75 11                    | jne ar.5B6514                                     |  is taken when bad

Might then do a ReadFile to compare too
005329D7 | FF15 50667000            | call dword ptr ds:[<&ReadFile>]                   |


00703B98  00 00 00 00 00 00 00 00 00 42 45 41 30 31 01 00  .........BEA01..    00703BC8 - 00703BA1 = 0x27
00703BA8  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................  
00703BB8  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................  
00703BC8  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................  
0x28 of the start of the PVD you can put the ID
UKD_548520-001.001 can be found after all the 0xFF in the section after cms_t

--------------------------------------------------------------------------------------------------------
Spell Force - The Breath Of Winter - 5.03.04

CD Check1 (patched):
005C43AE | A1 A85B6400              | mov eax,dword ptr ds:[645BA8]                     |
005C43B3 | 83EC 04                  | sub esp,4                                         |
005C43B6 | 893424                   | mov dword ptr ss:[esp],esi                        |
005C43B9 | 8BF0                     | mov esi,eax                                       | esi:&"B@"
005C43BB | 38C0                     | cmp al,al                                         |

CD Check 3 (patched):
0056D1EE | 891424                   | mov dword ptr ss:[esp],edx                        |
0056D1F1 | 8B15 54CF7300            | mov edx,dword ptr ds:[73CF54]                     |
0056D1F7 | 2BD1                     | sub edx,ecx                                       |
0056D1F9 | 5A                       | pop edx                                           |
0056D1FA | 68 45190000              | push 1945                                         |
0056D1FF | EB 10                    | jmp ar3.56D211                                    |


^ Crashes after this due to too many patch 1 !

Causing a problem ???
0056B589 | 8B15 78CD7300            | mov edx,dword ptr ds:[73CD78]                     |
0056B58F | 83EC 04                  | sub esp,4                                         |
0056B592 | 893424                   | mov dword ptr ss:[esp],esi                        |
0056B595 | 8BF2                     | mov esi,edx                                       |
0056B597 | 38C0                     | cmp al,al                                         |
0056B599 | 90                       | nop                                               |
0056B59A | 90                       | nop                                               |
0056B59B | 90                       | nop                                               |
0056B59C | 90                       | nop                                               |
0056B59D | 90                       | nop                                               |
0056B59E | 68 B0260000              | push 26B0                                         |
0056B5A3 | 74 12                    | je ar3.56B5B7                                     |
^ no that's fine - it's some other non-eax patchj though
